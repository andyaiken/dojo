{"version":3,"sources":["resources/images/down-arrow-black.svg","resources/images/down-arrow.svg","resources/images/close-black.svg","resources/images/warning.svg","resources/images/ellipsis.svg","resources/images/minus.svg","resources/images/plus.svg","resources/images/checked.svg","resources/images/unchecked.svg","resources/images/settings.svg","utils/utils.ts","utils/factory.ts","components/cards/info-card.tsx","components/cards/information/combat-manager-card.tsx","components/controls/button-row.tsx","components/controls/confirm-button.tsx","components/controls/dropdown.tsx","components/controls/expander.tsx","components/controls/radial.tsx","components/controls/spin.tsx","components/panels/ability-score-panel.tsx","components/panels/conditions-panel.tsx","models/monster-group.ts","components/panels/traits-panel.tsx","components/cards/monster-card.tsx","components/cards/pc-card.tsx","components/panels/hit-point-gauge.tsx","components/panels/map-panel.tsx","components/list-items/combat-list-item.tsx","components/panels/card-group.tsx","components/screens/combat-manager-screen.tsx","components/cards/information/dm-screen-card.tsx","components/dm-modules/actions-module.tsx","components/dm-modules/conditions-module.tsx","utils/text-generation.ts","components/controls/checkbox.tsx","components/controls/selector.tsx","components/dm-modules/language-module.tsx","components/dm-modules/skills-module.tsx","components/list-items/dm-module-list-item.tsx","components/screens/dm-screen.tsx","components/panels/difficulty-chart-panel.tsx","components/cards/encounter-card.tsx","components/cards/error-card.tsx","components/cards/filter-card.tsx","components/cards/information/encounter-builder-card.tsx","components/cards/wave-card.tsx","components/list-items/encounter-list-item.tsx","components/screens/encounter-builder-screen.tsx","components/screens/home-screen.tsx","components/cards/information/map-folios-card.tsx","components/cards/map-card.tsx","components/cards/map-folio-card.tsx","components/list-items/map-folio-list-item.tsx","components/screens/map-folios-screen.tsx","components/cards/information/monster-library-card.tsx","components/cards/monster-group-card.tsx","components/list-items/monster-group-list-item.tsx","components/screens/monster-library-screen.tsx","components/cards/information/parties-card.tsx","components/cards/party-card.tsx","components/list-items/party-list-item.tsx","components/screens/parties-screen.tsx","components/modals/about-modal.tsx","components/modals/combat-start-modal.tsx","models/condition.ts","components/controls/radio-group.tsx","components/modals/condition-modal.tsx","components/modals/demographics-modal.tsx","models/map-folio.ts","components/cards/map-tile-card.tsx","components/modals/map-editor-modal.tsx","components/modals/monster-editor-modal.tsx","components/panels/navbar.tsx","components/panels/titlebar.tsx","components/dojo.tsx","index.js"],"names":["module","exports","__webpack_require__","p","Utils","monster","library","group","this","monsterIdToGroup","id","grp","find","g","monsters","includes","filter","text","result","toLowerCase","split","forEach","token","indexOf","s4","Math","floor","random","toString","substring","collection","sort","a","b","aName","name","bName","value","count","aValue","bValue","score","mod","modifierValue","str","size","cr","parseInt","push","ac","hpMin","hpMax","attack","dmgMin","dmgMax","save","level","difficulty","type","delta","condition","combat","duration","saveDuration","saveType","toUpperCase","saves","saveDC","combatantDuration","point","c","combatants","cmb","combatantID","displayName","roundsDuration","rounds","encounter","monsterNames","slots","slot","names","monsterName","n","Factory","guid","pcs","active","player","race","classes","languages","passiveInsight","passiveInvestigation","passivePerception","initiative","url","category","tag","alignment","challenge","abilityScores","dex","con","int","wis","cha","hpTemp","hitDice","damage","resist","vulnerable","immune","savingThrows","speed","skills","senses","equipment","traits","conditionImmunities","usage","uses","waves","monsterGroupName","maps","items","x","y","width","height","terrain","partyID","encounterID","waveID","folioID","mapID","encounterInitMode","map","round","notifications","issues","timestamp","data","combatant","InfoCard","heading","props","getHeading","content","getContent","react_default","createElement","className","e","console","error","React","Component","defaultProps","CombatManagerCard","info_card_InfoCard","ButtonRow","style","disabled","buttons","length","button","key","onClick","callback","ex","ConfirmButton","_this","Object","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","state","pressed","setState","toggle","_this2","src","warning","alt","details","perform","Dropdown","open","stopPropagation","optionID","select","options","selectedText","selectedID","option","o","placeholder","title","ellipsis","dropdown_DropdownOption","selected","toggleOpen","DropdownOption","_this3","click","Expander","expanded","arrow","Radial","dir","dir2","arguments","undefined","direction","showOut","showIn","showDiag","display","transform","padding","Spin","nudgeValue","preventDefault","source","minusBtns","plusBtns","factors","factor","onTouchEnd","touchEnd","reverse","minus","plus","infoWidth","label","AbilityScorePanel","showAbilityScores","edit","spin_Spin","toggleAbilityScores","modifier","ConditionsPanel","conditions","conditions_panel_ConditionPanel","nudgeConditionValue","editCondition","removeCondition","conditionID","addCondition","ConditionPanel","conditionDurationText","description","conditionText","expander_Expander","SIZE_TYPES","CATEGORY_TYPES","TRAIT_TYPES","showdown","Showdown","Converter","TraitsPanel","trait","prevTrait","nextTrait","traits_panel_TraitPanel","mode","changeValue","action","removeTrait","copyTrait","swapTraits","t1","t2","traitsByType","types","traitType","t","list","createTraitPanel","addTrait","createSection","TraitPanel","maxUses","used","startsWith","found","match","markdown","dangerouslySetInnerHTML","__html","makeHtml","onChange","event","target","confirm_button_ConfirmButton","MonsterCard","showDetails","cloneName","damageOrHealing","max","hp","min","changeHP","temp","val","sizeAndType","align","wave","_this4","some","s","die","hitDieType","conMod","conModStr","_this5","editMonster","setCloneName","cloneMonster","groupOptions","dropdown_Dropdown","moveToGroup","removeMonster","removeEncounterSlot","canAdd","monsterIsInWave","addEncounterSlot","radial_Radial","mapMove","mapRemove","mapAdd","pending","defeated","removeCombatant","current","endTurn","makeDefeated","makeCurrent","makeActive","stats","slotSection","getHP","ability_score_panel_AbilityScorePanel","traits_panel_TraitsPanel","nudgeDamage","button_row_ButtonRow","heal","setDamage","field","conditions_panel_ConditionsPanel","imageStyle","toggleDetails","PCCard","removePC","desc","commonStatBlock","href","rel","HitPointGauge","hpCurrent","hpBloodied","hpWidth","hpTempBar","hpTempWidth","MapPanel","border","dimensions","i","minX","maxX","minY","maxY","mapDimensions","sideLength","getSideLength","left","top","getMapDimensions","grid","gridStyle","getStyle","map_panel_GridSquare","setSelectedItemID","onDoubleClick","posX","posY","addMapTile","tiles","tileStyle","map_panel_MapTile","tile","selectable","selectedItemID","thumbnail","tokens","tokenStyle","map_panel_MapToken","simple","mt","dragOverlay","showOverlay","yOver","xOver","overlayStyle","overlay","gridSquareClicked","GridSquare","doubleClick","MapTile","MapToken","initials","hpGauge","altitudeBadge","conditionsBadge","hit_point_gauge_HitPointGauge","altitude","CombatListItem","map_panel_MapPanel","setSelection","CardGroup","showCards","hidden","closeBtn","showClose","close","showToggle","toggleCards","cards","CombatManagerScreen","selectedTokenID","addingToMapID","pc_card_PCCard","setAddingToMapID","monster_card_MonsterCard","createCard","combat_manager_screen_PendingCombatantRow","setSelectedTokenID","combat_manager_screen_PCRow","combat_manager_screen_MonsterRow","showHelp","pendingHelp","concat","activeHelp","notificationSection","combat_manager_screen_NotificationPanel","notification","mapSection","addCombatantToMap","selectedCombatant","card_group_CardGroup","help","combat_manager_card_CombatManagerCard","combats","combat_list_item_CombatListItem","resumeEncounter","createCombat","NotificationPanel","success","PendingCombatantRow","_this6","getInformationText","PCRow","_this7","notes","MonsterRow","_this8","gauge","DMScreenCard","ActionsModule","fetch","response","fetchData","setOption","ConditionsModule","TextGenerator","sources","model","line","addLineToModel","String","fromCharCode","_loop","index","prev","substr","char","item","freq","requiredResults","lines","failures","extractLine","_loop2","v","candidates","repeat","_ret","Checkbox","checked","unchecked","Selector","tabs","itemsPerRow","rowCount","ceil","rowContents","rowIndex","selector_SelectorOption","rowSections","row","SelectorOption","LanguageModule","output","language","presetName","preset","getPresets","lang","addLanguage","keys","initModel","generate","presetOptions","selectedPreset","join","getLanguages","checkbox_Checkbox","removeLanguage","allowGenerate","allowReset","selector_Selector","usePreset","reset","SkillsModule","DMModuleListItem","DMScreen","selectedModuleID","skills_module_SkillsModule","conditions_module_ConditionsModule","actions_module_ActionsModule","language_module_LanguageModule","dm_screen_card_DMScreenCard","modules","getModules","moduleListItems","m","dm_module_list_item_DMModuleListItem","selectModule","DifficultyChartPanel","monsterCount","monsterXp","getMonster","experience","xpThresholds","diffSection","adjustedXp","experienceFactor","party","xpEasy","xpMedium","xpHard","xpDeadly","pc","pcExperience","adjustedDifficulty","small","getLeft","xp","getRight","right","EncounterCard","parties","partyOptions","difficultySection","selectParty","difficulty_chart_panel_DifficultyChartPanel","selection","addWave","removeEncounter","ErrorCard","FilterCard","showAll","sizeOptions","catOptions","cat","resetFilter","summary","challengeMin","challengeMax","toggleAll","EncounterBuilderCard","encounters","WaveCard","removeWave","EncounterListItem","EncounterBuilderScreen","getMonsterGroup","nudgeChallenge","changeFilterValue","error_card_ErrorCard","libraryCards","filter_card_FilterCard","nudgeFilterValue","matchMonster","encounter_builder_card_EncounterBuilderCard","encounterName","encounter_list_item_EncounterListItem","selectEncounter","encounterCards","encounter_card_EncounterCard","getMonsterCards","card","w","waveCards","wave_card_WaveCard","addEncounter","getLibrarySection","HomeScreen","addOpenGameContent","MapFoliosCard","mapFolios","MapCard","editMap","removeMap","MapFolioCard","addMap","removeMapFolio","MapFolioListItem","mapFolio","MapFoliosScreen","map_folios_card_MapFoliosCard","folios","map_folio_list_item_MapFolioListItem","f","selectMapFolio","folio","folioCards","map_folio_card_MapFolioCard","map_card_MapCard","addMapFolio","MonsterLibraryCard","MonsterGroupCard","addMonster","sortMonsters","removeMonsterGroup","MonsterGroupListItem","matchGroup","MonsterLibraryScreen","monster_library_card_MonsterLibraryCard","listItems","showMonsterGroup","monster_group_list_item_MonsterGroupListItem","selectMonsterGroup","monster_group_card_MonsterGroupCard","groupID","addMonsterGroup","PartiesCard","PartyCard","activePCs","reduce","array","localeCompare","insightSummary","investigationSummary","perceptionSummary","insight","invest","percep","addPC","sortPCs","removeParty","PartyListItem","PartiesScreen","parties_card_PartiesCard","party_list_item_PartyListItem","activeCards","inactiveCards","party_card_PartyCard","activePC","inactivePC","addParty","AboutModal","pkg","version","resetAll","CombatStartModal","combatSetup","notify","enc","getMonsterNames","slotID","partyContent","selectedParty","pcSections","setParty","encounterOptions","encounterContent","selectedEncounter","monsterSections","waveMonsters","setEncounter","folioOptions","selectMapSection","thumbnailSection","mapOptions","setMapID","setFolioID","waveOptions","waveContent","selectedWave","setWave","_this9","_this10","slotsContainer","slotNames","inputs","combat_start_modal_MonsterName","changeName","setEncounterInitMode","leftSection","rightSection","getPartySection","getEncounterSection","getMapSection","getDifficultySection","getMonsterSection","getWaveSection","margin","MonsterName","_this11","CONDITION_TYPES","RadioGroup","radio_group_RadioGroupItem","itemID","RadioGroupItem","ConditionModal","conditionName","durationType","createConditionDurationSaves","createConditionDurationCombatant","createConditionDurationRounds","object","controls","saveOptions","pointOptions","combatantOptions","durations","radio_group_RadioGroup","setCondition","setDuration","DemographicsModal","chart","demographics","allMonsters","buckets","maxBucketSize","bucket","bars","set","selectChart","TERRAIN_TYPES","MapTileCard","terrainOptions","moveMapItem","resizeMapItem","cloneMapItem","removeMapItem","MapEditorModal","selectedTileID","createMapItem","smallMapItem","bigMapItem","copy","JSON","parse","stringify","splice","tools","map_tile_card_MapTileCard","mapItem","setSelectedTileID","MonsterEditorModal","page","showFilter","helpSection","subtype","sections","getHelpOptionsForPage","section","setRandomValue","findIndex","distinct","d","addedIDs","avg","createTrait","getActionTypeName","index1","index2","plural","newValue","hpPerDie","getValueSection","getActionsSection","dataType","values","sortByValue","sortByCount","valueSections","rows","addRandomTrait","criteria","criteriaText","similar","filterContent","toggleMatch","geneSplice","toggleFilter","showMonsters","getMonsters","changeTrait","selector","setHelpSection","getHelpSection","monsterList","getFilterCard","transition","setPage","Navbar","dmStyle","view","partiesStyle","libraryStyle","encounterStyle","mapStyle","combatStyle","encountersEnabled","combatEnabled","blur","setView","Titlebar","openHome","actions","cog","openAbout","Dojo","selectedPartyID","selectedMonsterGroupID","selectedEncounterID","selectedMapFolioID","selectedCombatID","selectedDMModuleID","modal","libraryFilter","json","window","localStorage","getItem","setItem","createParty","getParty","createPC","createMonsterGroup","createMonster","sourceGroup","findMonster","original","clone","then","parseChallenge","challenge_rating","armor_class","hit_points","hit_dice","strength","dexterity","constitution","intelligence","wisdom","charisma","damage_resistances","damage_vulnerabilities","damage_immunities","condition_immunities","skill","special_abilities","rawTrait","buildTrait","legendary_actions","groupName","getMonsterGroupByName","openBracket","closeBracket","replace","createEncounter","getEncounter","createEncounterSlot","sortEncounterSlots","slotContainer","createEncounterWave","createMapFolio","getMapFolio","createMap","setup","createCombatSetup","partyName","init","groupRoll","dieRoll","singleRoll","sortCombatants","getCombat","Date","toLocaleString","newRound","actor","issue","miniSize","saveNotification","createNotification","endNotification","createCondition","conditionIndex","obj","home_screen_HomeScreen","dm_screen_DMScreen","selectDMModule","parties_screen_PartiesScreen","monster_library_screen_MonsterLibraryScreen","openDemographics","encounter_builder_screen_EncounterBuilderScreen","addWaveToEncounter","map_folios_screen_MapFoliosScreen","combat_manager_screen_CombatManagerScreen","pausedCombat","resumeCombat","closeNotification","openWaveModal","pauseCombat","endCombat","modalTitle","modalContent","modalAllowClose","modalAllowScroll","modalButtons","about_modal_AboutModal","demographics_modal_DemographicsModal","monster_editor_modal_MonsterEditorModal","toggleShowSimilarMonsters","saveMonster","closeModal","map_editor_modal_MapEditorModal","saveMap","combat_start_modal_CombatStartModal","startCombat","addWaveToCombat","condition_modal_ConditionModal","addConditionFromModal","editConditionFromModal","titlebar_Titlebar","navbar_Navbar","ReactDOM","render","dojo_Dojo","document","getElementById"],"mappings":"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","file":"static/js/main.a9341413.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/down-arrow-black.a2fc7a1f.svg\";","module.exports = __webpack_public_path__ + \"static/media/down-arrow.697dc1af.svg\";","module.exports = __webpack_public_path__ + \"static/media/close-black.7645a5b9.svg\";","module.exports = __webpack_public_path__ + \"static/media/warning.67a11a95.svg\";","module.exports = __webpack_public_path__ + \"static/media/ellipsis.9650a20f.svg\";","module.exports = __webpack_public_path__ + \"static/media/minus.7003cf50.svg\";","module.exports = __webpack_public_path__ + \"static/media/plus.b60accff.svg\";","module.exports = __webpack_public_path__ + \"static/media/checked.5cbd1005.svg\";","module.exports = __webpack_public_path__ + \"static/media/unchecked.3d4ae2dd.svg\";","module.exports = __webpack_public_path__ + \"static/media/settings.042bb1c2.svg\";","import { Combat } from '../models/combat';\r\nimport { Condition, ConditionDurationCombatant, ConditionDurationRounds, ConditionDurationSaves } from '../models/condition';\r\nimport { Encounter, EncounterWave } from '../models/encounter';\r\nimport { Monster, MonsterGroup } from '../models/monster-group';\r\n\r\nexport default class Utils {\r\n\r\n    // This is an internal dictionary to speed up lookup\r\n    private static monsterIdToGroup: { [id: string]: MonsterGroup } = {};\r\n\r\n    public static getMonsterGroup(monster: Monster, library: MonsterGroup[]): MonsterGroup {\r\n        let group = this.monsterIdToGroup[monster.id];\r\n\r\n        if (!group) {\r\n            const grp = library.find(g => g.monsters.includes(monster));\r\n            if (grp) {\r\n                group = grp;\r\n                this.monsterIdToGroup[monster.id] = group;\r\n            }\r\n        }\r\n\r\n        return group;\r\n    }\r\n\r\n    public static match(filter: string, text: string): boolean {\r\n        if (!filter) {\r\n            return true;\r\n        }\r\n\r\n        let result = true;\r\n\r\n        const tokens = filter.toLowerCase().split(' ');\r\n        tokens.forEach(token => {\r\n            if (text.toLowerCase().indexOf(token) === -1) {\r\n                result = false;\r\n            }\r\n        });\r\n\r\n        return result;\r\n    }\r\n\r\n    public static guid(): string {\r\n        const s4 = () => Math.floor((1 + Math.random()) * 0x10000).toString(16).substring(1);\r\n        return s4() + s4() + '-' + s4() + '-' + s4() + '-' + s4() + '-' + s4() + s4() + s4();\r\n    }\r\n\r\n    public static sort(collection: any[]): any[] {\r\n        collection.sort((a, b) => {\r\n            const aName = a.name.toLowerCase();\r\n            const bName = b.name.toLowerCase();\r\n            if (aName < bName) { return -1; }\r\n            if (aName > bName) { return 1; }\r\n            return 0;\r\n        });\r\n        return collection;\r\n    }\r\n\r\n    public static sortByValue(collection: any[]): any[] {\r\n        collection.sort((a, b) => {\r\n            if (a.value < b.value) { return -1; }\r\n            if (a.value > b.value) { return 1; }\r\n            return 0;\r\n        });\r\n        return collection;\r\n    }\r\n\r\n    public static sortByCount(collection: any[]): any[] {\r\n        collection.sort((a, b) => {\r\n            if (a.count < b.count) { return 1; }\r\n            if (a.count > b.count) { return -1; }\r\n\r\n            const aValue = a.value.toLowerCase();\r\n            const bValue = b.value.toLowerCase();\r\n            if (aValue < bValue) { return -1; }\r\n            if (aValue > bValue) { return 1; }\r\n\r\n            return 0;\r\n        });\r\n        return collection;\r\n    }\r\n\r\n    public static modifierValue(score: number): number {\r\n        return Math.floor((score - 10) / 2);\r\n    }\r\n\r\n    public static modifier(score: number): string {\r\n        const mod = this.modifierValue(score);\r\n        let str = mod.toString();\r\n        if (mod >= 0) {\r\n            str = '+' + str;\r\n        }\r\n        return str;\r\n    }\r\n\r\n    public static dieRoll(): number {\r\n        return Math.floor(Math.random() * 20) + 1;\r\n    }\r\n\r\n    public static miniSize(size: string): number {\r\n        switch (size) {\r\n            case 'tiny': return 1;\r\n            case 'small': return 1;\r\n            case 'medium': return 1;\r\n            case 'large': return 2;\r\n            case 'huge': return 3;\r\n            case 'gargantuan': return 4;\r\n            default: return 1;\r\n        }\r\n    }\r\n\r\n    public static hitDieType(size: string) {\r\n        switch (size) {\r\n            case 'tiny': return 4;\r\n            case 'small': return 6;\r\n            case 'medium': return 8;\r\n            case 'large': return 10;\r\n            case 'huge': return 12;\r\n            case 'gargantuan': return 20;\r\n            default: return 8;\r\n        }\r\n    }\r\n\r\n    public static challenge(cr: number): string {\r\n        switch (cr) {\r\n            case 0.125: return '1/8';\r\n            case 0.25: return '1/4';\r\n            case 0.5: return '1/2';\r\n            default: return cr.toString();\r\n        }\r\n    }\r\n\r\n    public static parseChallenge(cr: string): number {\r\n        switch (cr) {\r\n            case '1/8': return 0.125;\r\n            case '1/4': return 0.25;\r\n            case '1/2': return 0.5;\r\n            default: return parseInt(cr, 10);\r\n        }\r\n    }\r\n\r\n    public static challengeDetails(): any[] {\r\n        const result: any[] = [];\r\n\r\n        result.push({ cr: 0,        ac: 13,       hpMin: 1, hpMax: 6,       attack: 3,  dmgMin: 0,   dmgMax: 1,   save: 13 });\r\n        result.push({ cr: 0.125,    ac: 13,       hpMin: 7, hpMax: 35,      attack: 3,  dmgMin: 2,   dmgMax: 3,   save: 13 });\r\n        result.push({ cr: 0.25,     ac: 13,       hpMin: 36, hpMax: 49,     attack: 3,  dmgMin: 4,   dmgMax: 5,   save: 13 });\r\n        result.push({ cr: 0.5,      ac: 13,       hpMin: 50, hpMax: 70,     attack: 3,  dmgMin: 6,   dmgMax: 8,   save: 13 });\r\n        result.push({ cr: 1,        ac: 13,       hpMin: 71, hpMax: 85,     attack: 3,  dmgMin: 9,   dmgMax: 14,  save: 13 });\r\n        result.push({ cr: 2,        ac: 13,       hpMin: 86, hpMax: 100,    attack: 3,  dmgMin: 15,  dmgMax: 20,  save: 13 });\r\n        result.push({ cr: 3,        ac: 13,       hpMin: 101, hpMax: 115,   attack: 4,  dmgMin: 21,  dmgMax: 26,  save: 13 });\r\n        result.push({ cr: 4,        ac: 14,       hpMin: 116, hpMax: 130,   attack: 5,  dmgMin: 27,  dmgMax: 32,  save: 14 });\r\n        result.push({ cr: 5,        ac: 15,       hpMin: 131, hpMax: 145,   attack: 6,  dmgMin: 33,  dmgMax: 38,  save: 15 });\r\n        result.push({ cr: 6,        ac: 15,       hpMin: 146, hpMax: 160,   attack: 6,  dmgMin: 39,  dmgMax: 44,  save: 15 });\r\n        result.push({ cr: 7,        ac: 15,       hpMin: 161, hpMax: 175,   attack: 6,  dmgMin: 45,  dmgMax: 50,  save: 15 });\r\n        result.push({ cr: 8,        ac: 16,       hpMin: 176, hpMax: 190,   attack: 7,  dmgMin: 51,  dmgMax: 56,  save: 16 });\r\n        result.push({ cr: 9,        ac: 16,       hpMin: 191, hpMax: 205,   attack: 7,  dmgMin: 57,  dmgMax: 62,  save: 16 });\r\n        result.push({ cr: 10,       ac: 17,       hpMin: 206, hpMax: 220,   attack: 7,  dmgMin: 63,  dmgMax: 68,  save: 16 });\r\n        result.push({ cr: 11,       ac: 17,       hpMin: 221, hpMax: 235,   attack: 8,  dmgMin: 69,  dmgMax: 74,  save: 17 });\r\n        result.push({ cr: 12,       ac: 17,       hpMin: 236, hpMax: 250,   attack: 8,  dmgMin: 75,  dmgMax: 80,  save: 17 });\r\n        result.push({ cr: 13,       ac: 18,       hpMin: 251, hpMax: 265,   attack: 8,  dmgMin: 81,  dmgMax: 86,  save: 18 });\r\n        result.push({ cr: 14,       ac: 18,       hpMin: 266, hpMax: 280,   attack: 8,  dmgMin: 87,  dmgMax: 92,  save: 18 });\r\n        result.push({ cr: 15,       ac: 18,       hpMin: 281, hpMax: 295,   attack: 8,  dmgMin: 93,  dmgMax: 98,  save: 18 });\r\n        result.push({ cr: 16,       ac: 18,       hpMin: 296, hpMax: 310,   attack: 9,  dmgMin: 99,  dmgMax: 104, save: 18 });\r\n        result.push({ cr: 17,       ac: 19,       hpMin: 311, hpMax: 325,   attack: 10, dmgMin: 105, dmgMax: 110, save: 19 });\r\n        result.push({ cr: 18,       ac: 19,       hpMin: 326, hpMax: 340,   attack: 10, dmgMin: 111, dmgMax: 116, save: 19 });\r\n        result.push({ cr: 19,       ac: 19,       hpMin: 341, hpMax: 355,   attack: 10, dmgMin: 117, dmgMax: 122, save: 19 });\r\n        result.push({ cr: 20,       ac: 19,       hpMin: 356, hpMax: 400,   attack: 10, dmgMin: 123, dmgMax: 140, save: 19 });\r\n        result.push({ cr: 21,       ac: 19,       hpMin: 401, hpMax: 445,   attack: 11, dmgMin: 141, dmgMax: 158, save: 20 });\r\n        result.push({ cr: 22,       ac: 19,       hpMin: 446, hpMax: 490,   attack: 11, dmgMin: 159, dmgMax: 176, save: 20 });\r\n        result.push({ cr: 23,       ac: 19,       hpMin: 491, hpMax: 535,   attack: 11, dmgMin: 177, dmgMax: 194, save: 20 });\r\n        result.push({ cr: 24,       ac: 19,       hpMin: 536, hpMax: 580,   attack: 12, dmgMin: 195, dmgMax: 212, save: 21 });\r\n        result.push({ cr: 25,       ac: 19,       hpMin: 581, hpMax: 625,   attack: 12, dmgMin: 213, dmgMax: 230, save: 21 });\r\n        result.push({ cr: 26,       ac: 19,       hpMin: 626, hpMax: 670,   attack: 12, dmgMin: 231, dmgMax: 248, save: 21 });\r\n        result.push({ cr: 27,       ac: 19,       hpMin: 671, hpMax: 715,   attack: 13, dmgMin: 249, dmgMax: 266, save: 22 });\r\n        result.push({ cr: 28,       ac: 19,       hpMin: 716, hpMax: 760,   attack: 13, dmgMin: 267, dmgMax: 284, save: 22 });\r\n        result.push({ cr: 29,       ac: 19,       hpMin: 761, hpMax: 805,   attack: 13, dmgMin: 285, dmgMax: 302, save: 22 });\r\n        result.push({ cr: 30,       ac: 19,       hpMin: 806, hpMax: 850,   attack: 14, dmgMin: 303, dmgMax: 320, save: 23 });\r\n\r\n        return result;\r\n    }\r\n\r\n    public static experience(cr: number): number {\r\n        switch (cr) {\r\n            case 0: return 10;\r\n            case 0.125: return 25;\r\n            case 0.25: return 50;\r\n            case 0.5: return 100;\r\n            case 1: return 200;\r\n            case 2: return 450;\r\n            case 3: return 700;\r\n            case 4: return 1100;\r\n            case 5: return 1800;\r\n            case 6: return 2300;\r\n            case 7: return 2900;\r\n            case 8: return 3900;\r\n            case 9: return 5000;\r\n            case 10: return 5900;\r\n            case 11: return 7200;\r\n            case 12: return 8400;\r\n            case 13: return 10000;\r\n            case 14: return 11500;\r\n            case 15: return 13000;\r\n            case 16: return 15000;\r\n            case 17: return 18000;\r\n            case 18: return 20000;\r\n            case 19: return 22000;\r\n            case 20: return 25000;\r\n            case 21: return 33000;\r\n            case 22: return 41000;\r\n            case 23: return 50000;\r\n            case 24: return 62000;\r\n            case 30: return 155000;\r\n            default: return 0;\r\n        }\r\n    }\r\n\r\n    public static experienceFactor(count: number): number {\r\n        switch (count) {\r\n            case 0:\r\n                return 0;\r\n            case 1:\r\n                return 1;\r\n            case 2:\r\n                return 1.5;\r\n            case 3:\r\n            case 4:\r\n            case 5:\r\n            case 6:\r\n                return 2;\r\n            case 7:\r\n            case 8:\r\n            case 9:\r\n            case 10:\r\n                return 2.5;\r\n            case 11:\r\n            case 12:\r\n            case 13:\r\n            case 14:\r\n                return 3;\r\n            default:\r\n                return 4;\r\n        }\r\n    }\r\n\r\n    public static pcExperience(level: number, difficulty: string): number {\r\n        switch (difficulty) {\r\n            case 'easy':\r\n                switch (level) {\r\n                    case 1: return 25;\r\n                    case 2: return 50;\r\n                    case 3: return 75;\r\n                    case 4: return 125;\r\n                    case 5: return 250;\r\n                    case 6: return 300;\r\n                    case 7: return 350;\r\n                    case 8: return 450;\r\n                    case 9: return 550;\r\n                    case 10: return 600;\r\n                    case 11: return 800;\r\n                    case 12: return 1000;\r\n                    case 13: return 1100;\r\n                    case 14: return 1250;\r\n                    case 15: return 1400;\r\n                    case 16: return 1600;\r\n                    case 17: return 2000;\r\n                    case 18: return 2100;\r\n                    case 19: return 2400;\r\n                    case 20: return 2800;\r\n                    default: return 0;\r\n                }\r\n            case 'medium':\r\n                switch (level) {\r\n                    case 1: return 50;\r\n                    case 2: return 100;\r\n                    case 3: return 150;\r\n                    case 4: return 250;\r\n                    case 5: return 500;\r\n                    case 6: return 600;\r\n                    case 7: return 750;\r\n                    case 8: return 900;\r\n                    case 9: return 1100;\r\n                    case 10: return 1200;\r\n                    case 11: return 1600;\r\n                    case 12: return 2000;\r\n                    case 13: return 2200;\r\n                    case 14: return 2500;\r\n                    case 15: return 2800;\r\n                    case 16: return 3200;\r\n                    case 17: return 3900;\r\n                    case 18: return 4200;\r\n                    case 19: return 4900;\r\n                    case 20: return 5700;\r\n                    default: return 0;\r\n                }\r\n            case 'hard':\r\n                switch (level) {\r\n                    case 1: return 75;\r\n                    case 2: return 150;\r\n                    case 3: return 225;\r\n                    case 4: return 375;\r\n                    case 5: return 750;\r\n                    case 6: return 900;\r\n                    case 7: return 1100;\r\n                    case 8: return 1400;\r\n                    case 9: return 1600;\r\n                    case 10: return 1900;\r\n                    case 11: return 2400;\r\n                    case 12: return 3000;\r\n                    case 13: return 3400;\r\n                    case 14: return 3800;\r\n                    case 15: return 4300;\r\n                    case 16: return 4800;\r\n                    case 17: return 5900;\r\n                    case 18: return 6300;\r\n                    case 19: return 7300;\r\n                    case 20: return 8500;\r\n                    default: return 0;\r\n                }\r\n            case 'deadly':\r\n                switch (level) {\r\n                    case 1: return 100;\r\n                    case 2: return 200;\r\n                    case 3: return 400;\r\n                    case 4: return 500;\r\n                    case 5: return 1100;\r\n                    case 6: return 1400;\r\n                    case 7: return 1700;\r\n                    case 8: return 2100;\r\n                    case 9: return 2400;\r\n                    case 10: return 2800;\r\n                    case 11: return 3600;\r\n                    case 12: return 4500;\r\n                    case 13: return 5100;\r\n                    case 14: return 5700;\r\n                    case 15: return 6400;\r\n                    case 16: return 7200;\r\n                    case 17: return 8800;\r\n                    case 18: return 9500;\r\n                    case 19: return 10900;\r\n                    case 20: return 12700;\r\n                    default: return 0;\r\n                }\r\n            default:\r\n                return 0;\r\n        }\r\n    }\r\n\r\n    public static traitType(type: string): string {\r\n        switch (type) {\r\n            case 'trait':\r\n                return 'trait';\r\n            case 'action':\r\n                return 'action';\r\n            case 'legendary':\r\n                return 'legendary action';\r\n            case 'lair':\r\n                return 'lair action';\r\n            case 'regional':\r\n                return 'regional effect';\r\n            default:\r\n                return type;\r\n        }\r\n    }\r\n\r\n    public static nudgeChallenge(value: number, delta: number): number {\r\n        let result = 0;\r\n\r\n        switch (value) {\r\n            case 0:\r\n                if (delta === -1) {\r\n                    result = 0;\r\n                }\r\n                if (delta === +1) {\r\n                    result = 0.125;\r\n                }\r\n                break;\r\n            case 0.125:\r\n                if (delta === -1) {\r\n                    result = 0;\r\n                }\r\n                if (delta === +1) {\r\n                    result = 0.25;\r\n                }\r\n                break;\r\n            case 0.25:\r\n                if (delta === -1) {\r\n                    result = 0.125;\r\n                }\r\n                if (delta === +1) {\r\n                    result = 0.5;\r\n                }\r\n                break;\r\n            case 0.5:\r\n                if (delta === -1) {\r\n                    result = 0.25;\r\n                }\r\n                if (delta === +1) {\r\n                    result = 1;\r\n                }\r\n                break;\r\n            case 1:\r\n                if (delta === -1) {\r\n                    result = 0.5;\r\n                }\r\n                if (delta === +1) {\r\n                    result = 2;\r\n                }\r\n                break;\r\n            default:\r\n                result = value + delta;\r\n                break;\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    public static conditionText(condition: Condition): string[] {\r\n        switch (condition.name) {\r\n            case 'blinded':\r\n                return [\r\n                    'a blinded creature cant see and automatically fails any ability check that requires sight',\r\n                    'attack rolls against the creature have advantage, and the creatures attack rolls have disadvantage'\r\n                ];\r\n            case 'charmed':\r\n                return [\r\n                    'a charmed creature cant attack the charmer or target the charmer with harmful abilities or magical effects',\r\n                    'the charmer has advantage on any ability check to interact socially with the creature'\r\n                ];\r\n            case 'deafened':\r\n                return [\r\n                    'a deafened creature cant hear and automatically fails any ability check that requires hearing.'\r\n                ];\r\n            case 'exhaustion': {\r\n                switch (condition.level) {\r\n                case 1:\r\n                    return [\r\n                        'disadvantage on ability checks'\r\n                    ];\r\n                case 2:\r\n                    return [\r\n                        'disadvantage on ability checks',\r\n                        'speed halved'\r\n                    ];\r\n                case 3:\r\n                    return [\r\n                        'disadvantage on ability checks',\r\n                        'speed halved',\r\n                        'disadvantage on attack rolls and saving throws'\r\n                    ];\r\n                case 4:\r\n                    return [\r\n                        'disadvantage on ability checks',\r\n                        'speed halved',\r\n                        'disadvantage on attack rolls and saving throws',\r\n                        'hit point maximum halved'\r\n                    ];\r\n                case 5:\r\n                    return [\r\n                        'disadvantage on ability checks',\r\n                        'speed halved',\r\n                        'disadvantage on attack rolls and saving throws',\r\n                        'hit point maximum halved',\r\n                        'speed reduced to 0'\r\n                    ];\r\n                case 6:\r\n                    return [\r\n                        'disadvantage on ability checks',\r\n                        'speed halved',\r\n                        'disadvantage on attack rolls and saving throws',\r\n                        'hit point maximum halved',\r\n                        'speed reduced to 0',\r\n                        'death'\r\n                    ];\r\n                default:\r\n                    return [];\r\n                }\r\n            }\r\n            case 'frightened':\r\n                return [\r\n                    'a frightened creature has disadvantage on ability checks and attack rolls while the source of its fear is within line of sight',\r\n                    'the creature cant willingly move closer to the source of its fear'\r\n                ];\r\n            case 'grappled':\r\n                return [\r\n                    'a grappled creatures speed becomes 0, and it cant benefit from any bonus to its speed',\r\n                    'the condition ends if the grappler is incapacitated',\r\n                    'the condition also ends if an effect removes the grappled creature from the reach of the grappler or grappling effect'\r\n                ];\r\n            case 'incapacitated':\r\n                return [\r\n                    'an incapacitated creature cant take actions or reactions'\r\n                ];\r\n            case 'invisible':\r\n                return [\r\n                    'an invisible creature is impossible to see without the aid of magic or a special sense',\r\n                    'for the purpose of hiding, the creature is heavily obscured',\r\n                    'the creatures location can be detected by any noise it makes or any tracks it leaves',\r\n                    'attack rolls against the creature have disadvantage, and the creatures attack rolls have advantage'\r\n                ];\r\n            case 'paralyzed':\r\n                return [\r\n                    'a paralyzed creature is incapacitated (cant take actions or reactions) and cant move or speak',\r\n                    'the creature automatically fails strength and dexterity saving throws',\r\n                    'attack rolls against the creature have advantage',\r\n                    'any attack that hits the creature is a critical hit if the attacker is within 5 feet of the creature'\r\n                ];\r\n            case 'petrified':\r\n                return [\r\n                    /* tslint:disable-next-line:max-line-length */\r\n                    'a petrified creature is transformed, along with any nonmagical objects it is wearing or carrying, into a solid inanimate substance (usually stone)',\r\n                    'its weight increases by a factor of ten, and it ceases aging',\r\n                    'the creature is incapacitated (cant take actions or reactions), cant move or speak, and is unaware of its surroundings',\r\n                    'attack rolls against the creature have advantage',\r\n                    'the creature automatically fails strength and dexterity saving throws',\r\n                    'the creature has resistance to all damage',\r\n                    'the creature is immune to poison and disease, although a poison or disease already in its system is suspended, not neutralized'\r\n                ];\r\n            case 'poisoned':\r\n                return [\r\n                    'a poisoned creature has disadvantage on attack rolls and ability checks'\r\n                ];\r\n            case 'prone':\r\n                return [\r\n                    'a prone creatures only movement option is to crawl, unless it stands up and thereby ends the condition',\r\n                    'the creature has disadvantage on attack rolls',\r\n                    /* tslint:disable-next-line:max-line-length */\r\n                    'an attack roll against the creature has advantage if the attacker is Within 5 feet of the creature; otherwise, the attack roll has disadvantage'\r\n                ];\r\n            case 'restrained':\r\n                return [\r\n                    'a restrained creatures speed becomes 0, and it cant benefit from any bonus to its speed',\r\n                    'attack rolls against the creature have advantage, and the creatures attack rolls have disadvantage',\r\n                    'the creature has disadvantage on dexterity saving throws'\r\n                ];\r\n            case 'stunned':\r\n                return [\r\n                    'a stunned creature is incapacitated (cant take actions or reactions), cant move, and can speak only falteringly',\r\n                    'the creature automatically fails strength and dexterity saving throws',\r\n                    'attack rolls against the creature have advantage'\r\n                ];\r\n            case 'unconscious':\r\n                return [\r\n                    'an unconscious creature is incapacitated (cant take actions or reactions), cant move or speak, and is unaware of its surroundings',\r\n                    'the creature drops whatever its holding and falls prone',\r\n                    'the creature automatically fails strength and dexterity saving throws',\r\n                    'attack rolls against the creature have advantage',\r\n                    'any attack that hits the creature is a critical hit if the attacker is within 5 feet of the creature'\r\n                ];\r\n            case 'custom':\r\n                return [];\r\n            default:\r\n                return [];\r\n        }\r\n    }\r\n\r\n    public static conditionDurationText(condition: Condition, combat: Combat) {\r\n        if (condition.duration !== null) {\r\n            switch (condition.duration.type) {\r\n                case 'saves':\r\n                    const saveDuration = condition.duration as ConditionDurationSaves;\r\n                    let saveType = saveDuration.saveType.toString();\r\n                    if (saveType !== 'death') {\r\n                        saveType = saveType.toUpperCase();\r\n                    }\r\n                    const saves = saveDuration.count > 1 ? 'saves' : 'save';\r\n                    return 'until you make ' + saveDuration.count + ' ' + saveType + ' ' + saves + ' at dc ' + saveDuration.saveDC;\r\n                case 'combatant':\r\n                    const combatantDuration = condition.duration as ConditionDurationCombatant;\r\n                    const point = combatantDuration.point;\r\n                    const c = combat.combatants.find(cmb => cmb.id === combatantDuration.combatantID);\r\n                    const combatant = c ? (c.displayName || c.name || 'unnamed monster') + '\\'s' : 'someone\\'s';\r\n                    return 'until the ' + point + ' of ' + combatant + ' next turn';\r\n                case 'rounds':\r\n                    const roundsDuration = condition.duration as ConditionDurationRounds;\r\n                    const rounds = roundsDuration.count > 1 ? 'rounds' : 'round';\r\n                    return 'for ' + roundsDuration.count + ' ' + rounds;\r\n                default:\r\n                    return null;\r\n            }\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    public static getMonsterNames(encounter: Encounter | EncounterWave): { id: string, names: string[] }[] {\r\n        const monsterNames: any[] = [];\r\n        if (encounter) {\r\n            encounter.slots.forEach(slot => {\r\n                const names: any[] = [];\r\n                if (slot.count === 1) {\r\n                    names.push(slot.monsterName);\r\n                } else {\r\n                    for (let n = 0; n !== slot.count; ++n) {\r\n                        names.push(slot.monsterName + ' ' + (n + 1));\r\n                    }\r\n                }\r\n\r\n                monsterNames.push({\r\n                    id: slot.id,\r\n                    names: names\r\n                });\r\n            });\r\n        }\r\n\r\n        return monsterNames;\r\n    }\r\n}\r\n","import Utils from './utils';\r\n\r\nimport { Combat, CombatSetup, Notification } from '../models/combat';\r\nimport { Condition, ConditionDurationCombatant, ConditionDurationRounds, ConditionDurationSaves } from '../models/condition';\r\nimport { Encounter, EncounterSlot, EncounterWave } from '../models/encounter';\r\nimport { Map, MapFolio, MapItem } from '../models/map-folio';\r\nimport { Monster, MonsterGroup, Trait } from '../models/monster-group';\r\nimport { Party, PC } from '../models/party';\r\n\r\nexport default class Factory {\r\n\r\n    public static createParty(): Party {\r\n        return {\r\n            id: Utils.guid(),\r\n            name: '',\r\n            pcs: []\r\n        };\r\n    }\r\n\r\n    public static createPC(): PC {\r\n        return {\r\n            id: Utils.guid(),\r\n            type: 'pc',\r\n            active: true,\r\n            player: '',\r\n            name: '',\r\n            race: '',\r\n            classes: '',\r\n            level: 1,\r\n            languages: 'Common',\r\n            passiveInsight: 10,\r\n            passiveInvestigation: 10,\r\n            passivePerception: 10,\r\n            initiative: 10,\r\n            url: ''\r\n        };\r\n    }\r\n\r\n    public static createMonsterGroup(): MonsterGroup {\r\n        return {\r\n            id: Utils.guid(),\r\n            name: '',\r\n            monsters: []\r\n        };\r\n    }\r\n\r\n    public static createMonster(): Monster {\r\n        return {\r\n            id: Utils.guid(),\r\n            type: 'monster',\r\n            name: '',\r\n            size: 'medium',\r\n            category: 'humanoid',\r\n            tag: '',\r\n            alignment: '',\r\n            challenge: 1,\r\n            abilityScores: {\r\n                str: 10,\r\n                dex: 10,\r\n                con: 10,\r\n                int: 10,\r\n                wis: 10,\r\n                cha: 10\r\n            },\r\n            ac: 10,\r\n            hpMax: 4,\r\n            hpTemp: 0,\r\n            hitDice: 1,\r\n            damage: {\r\n                resist: '',\r\n                vulnerable: '',\r\n                immune: ''\r\n            },\r\n            savingThrows: '',\r\n            speed: '',\r\n            skills: '',\r\n            senses: '',\r\n            languages: '',\r\n            equipment: '',\r\n            traits: [],\r\n            conditionImmunities: ''\r\n        };\r\n    }\r\n\r\n    public static createTrait(): Trait {\r\n        return {\r\n            id: Utils.guid(),\r\n            name: '',\r\n            usage: '',\r\n            type: 'action',\r\n            text: '',\r\n            uses: 0\r\n        };\r\n    }\r\n\r\n    public static createEncounter(): Encounter {\r\n        return {\r\n            id: Utils.guid(),\r\n            name: '',\r\n            slots: [],\r\n            waves: []\r\n        };\r\n    }\r\n\r\n    public static createEncounterSlot(): EncounterSlot {\r\n        return {\r\n            id: Utils.guid(),\r\n            monsterGroupName: '',\r\n            monsterName: '',\r\n            count: 1\r\n        };\r\n    }\r\n\r\n    public static createEncounterWave(): EncounterWave {\r\n        return {\r\n            id: Utils.guid(),\r\n            name: '',\r\n            slots: []\r\n        };\r\n    }\r\n\r\n    public static createMapFolio(): MapFolio {\r\n        return {\r\n            id: Utils.guid(),\r\n            name: '',\r\n            maps: []\r\n        };\r\n    }\r\n\r\n    public static createMap(): Map {\r\n        return {\r\n            id: Utils.guid(),\r\n            name: '',\r\n            items: []\r\n        };\r\n    }\r\n\r\n    public static createMapItem(): MapItem {\r\n        return {\r\n            id: Utils.guid(),\r\n            type: 'tile',\r\n            x: 0,\r\n            y: 0,\r\n            width: 4,\r\n            height: 4,\r\n            terrain: null\r\n        };\r\n    }\r\n\r\n    public static createCombatSetup(): CombatSetup {\r\n        return {\r\n            partyID: null,\r\n            encounterID: null,\r\n            waveID: null,\r\n            folioID: null,\r\n            mapID: null,\r\n            monsterNames: [],\r\n            encounterInitMode: 'group'\r\n        };\r\n    }\r\n\r\n    public static createCombat(): Combat {\r\n        return {\r\n            id: Utils.guid(),\r\n            name: '',\r\n            encounterID: null,\r\n            combatants: [],\r\n            map: null,\r\n            round: 1,\r\n            notifications: [],\r\n            issues: [],\r\n            timestamp: null\r\n        };\r\n    }\r\n\r\n    public static createNotification(): Notification {\r\n        return {\r\n            id: Utils.guid(),\r\n            type: 'condition-save',\r\n            data: null,\r\n            combatant: null\r\n        };\r\n    }\r\n\r\n    public static createCondition(): Condition {\r\n        return {\r\n            id: Utils.guid(),\r\n            name: '',\r\n            level: 1,\r\n            text: null,\r\n            duration: null\r\n        };\r\n    }\r\n\r\n    public static createConditionDurationSaves(): ConditionDurationSaves {\r\n        return {\r\n            type: 'saves',\r\n            count: 1,\r\n            saveType: 'str',\r\n            saveDC: 10,\r\n            point: 'start'\r\n        };\r\n    }\r\n\r\n    public static createConditionDurationCombatant(): ConditionDurationCombatant {\r\n        return {\r\n            type: 'combatant',\r\n            point: 'start',\r\n            combatantID: null\r\n        };\r\n    }\r\n\r\n    public static createConditionDurationRounds(): ConditionDurationRounds {\r\n        return {\r\n            type: 'rounds',\r\n            count: 1\r\n        };\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\ninterface Props {\r\n    getHeading: () => (string | JSX.Element);\r\n    getContent: () => (string | JSX.Element);\r\n}\r\n\r\nexport default class InfoCard extends React.Component<Props> {\r\n    public static defaultProps = {\r\n        getHeading: null,\r\n        getContent: null\r\n    };\r\n\r\n    public render() {\r\n        try {\r\n            let heading = null;\r\n            if (this.props.getHeading) {\r\n                heading = this.props.getHeading();\r\n            }\r\n\r\n            let content = null;\r\n            if (this.props.getContent) {\r\n                content = this.props.getContent();\r\n            }\r\n            if (!content) {\r\n                return null;\r\n            }\r\n\r\n            return (\r\n                <div className='card'>\r\n                    {heading}\r\n                    <div className='card-content'>\r\n                        {content}\r\n                    </div>\r\n                </div>\r\n            );\r\n        } catch (e) {\r\n            console.error(e);\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport InfoCard from '../info-card';\r\n\r\nexport default class CombatManagerCard extends React.Component {\r\n    private getContent() {\r\n        return (\r\n            <div>\r\n                <div className='section'>here you can run a combat encounter by specifying a party and an encounter</div>\r\n                <div className='divider' />\r\n                <div className='section'>below you will see a list of encounters that you have paused</div>\r\n                <div className='section'>you can resume a paused combat by selecting it</div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    public render() {\r\n        return (\r\n            <InfoCard getContent={this.getContent}/>\r\n        );\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\ninterface Props {\r\n    buttons: {\r\n        id: string;\r\n        text: string;\r\n        disabled: boolean;\r\n        callback: () => void;\r\n    }[];\r\n    disabled: boolean;\r\n}\r\n\r\nexport default class ButtonRow extends React.Component<Props> {\r\n    public static defaultProps = {\r\n        disabled: false\r\n    };\r\n\r\n    public render() {\r\n        try {\r\n            let style = 'button-row';\r\n            if (this.props.disabled) {\r\n                style += ' disabled';\r\n            }\r\n            switch (this.props.buttons.length) {\r\n                case 1:\r\n                    style += ' one';\r\n                    break;\r\n                case 2:\r\n                    style += ' two';\r\n                    break;\r\n                case 3:\r\n                    style += ' three';\r\n                    break;\r\n                case 4:\r\n                    style += ' four';\r\n                    break;\r\n                case 5:\r\n                    style += ' five';\r\n                    break;\r\n            }\r\n\r\n            const buttons = this.props.buttons.map(button => {\r\n                return (\r\n                    <button key={button.id} className={button.disabled ? 'disabled' : ''} onClick={() => button.callback()}>\r\n                        {button.text}\r\n                    </button>\r\n                );\r\n            });\r\n\r\n            return (\r\n                <div className={style}>\r\n                    {buttons}\r\n                </div>\r\n            );\r\n        } catch (ex) {\r\n            console.error(ex);\r\n            return null;\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport warning from '../../resources/images/warning.svg';\r\n\r\ninterface Props {\r\n    text: string;\r\n    callback: () => void;\r\n    details: string;\r\n    disabled: boolean;\r\n}\r\n\r\ninterface State {\r\n    pressed: boolean;\r\n}\r\n\r\nexport default class ConfirmButton extends React.Component<Props, State> {\r\n    public static defaultProps = {\r\n        details: null,\r\n        disabled: false\r\n    };\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n        this.state = {\r\n            pressed: false\r\n        };\r\n    }\r\n\r\n    private toggle() {\r\n        this.setState({\r\n            pressed: !this.state.pressed\r\n        });\r\n    }\r\n\r\n    private perform() {\r\n        this.toggle();\r\n        this.props.callback();\r\n    }\r\n\r\n    public render() {\r\n        try {\r\n            let content = null;\r\n            if (this.state.pressed) {\r\n                content = (\r\n                    <div>\r\n                        <div className='title'>{this.props.text} - are you sure?</div>\r\n                        <img className='image' src={warning} alt='warning' />\r\n                        {this.props.details ? <div className='details'>{this.props.details}</div> : null}\r\n                        <div className='confirmation'>\r\n                            <div className='destructive' onClick={() => this.perform()}>yes</div>\r\n                            <div className='non-destructive' onClick={() => this.toggle()}>no</div>\r\n                        </div>\r\n                    </div>\r\n                );\r\n            } else {\r\n                content = (\r\n                    <div>\r\n                        <div className='title'>{this.props.text}</div>\r\n                        <img className='image' src={warning} alt='warning' />\r\n                    </div>\r\n                );\r\n            }\r\n\r\n            return (\r\n                <button className={this.props.disabled ? 'disabled' : ''} onClick={() => this.toggle()}>\r\n                    {content}\r\n                </button>\r\n            );\r\n        } catch (ex) {\r\n            console.error(ex);\r\n            return null;\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport ellipsis from '../../resources/images/ellipsis.svg';\r\n\r\ninterface Props {\r\n    options: { id: string; text: string; disabled?: boolean }[];\r\n    select: (optionID: string) => void;\r\n    selectedID: string;\r\n    placeholder: string;\r\n    disabled: boolean;\r\n}\r\n\r\ninterface State {\r\n    open: boolean;\r\n}\r\n\r\nexport default class Dropdown extends React.Component<Props, State> {\r\n    public static defaultProps = {\r\n        selectedID: null,\r\n        placeholder: 'select...',\r\n        disabled: false\r\n    };\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            open: false\r\n        };\r\n    }\r\n\r\n    private toggleOpen(e: React.MouseEvent) {\r\n        e.stopPropagation();\r\n        this.setState({\r\n            open: !this.state.open\r\n        });\r\n    }\r\n\r\n    private select(optionID: string) {\r\n        this.setState({\r\n            open: false\r\n        });\r\n        this.props.select(optionID);\r\n    }\r\n\r\n    public render() {\r\n        try {\r\n            if (this.props.options.length === 0) {\r\n                return null;\r\n            }\r\n\r\n            let style = this.props.disabled ? 'dropdown disabled' : 'dropdown';\r\n            const content = [];\r\n\r\n            let selectedText;\r\n            if (this.props.selectedID) {\r\n                const option: { id: string; text: string; disabled?: boolean } | undefined = this.props.options.find(o => o.id === this.props.selectedID);\r\n                if (option) {\r\n                    selectedText = option.text;\r\n                }\r\n            } else {\r\n                selectedText = /*this.props.text ||*/ this.props.placeholder;\r\n            }\r\n\r\n            content.push(\r\n                <div key='selection' className='dropdown-top' title={selectedText}>\r\n                    <div className='item-text'>{selectedText}</div>\r\n                    <img className='arrow' src={ellipsis} alt='arrow' />\r\n                </div>\r\n            );\r\n\r\n            if (this.state.open) {\r\n                style += ' open';\r\n\r\n                const items = this.props.options.map(option => {\r\n                    if (option.text === null) {\r\n                        return <div key={option.id} className='divider' />;\r\n                    } else {\r\n                        return (\r\n                            <DropdownOption\r\n                                key={option.id}\r\n                                option={option}\r\n                                selected={option.id === this.props.selectedID}\r\n                                select={optionID => this.select(optionID)}\r\n                            />\r\n                        );\r\n                    }\r\n                });\r\n\r\n                content.push(\r\n                    <div key='options' className='dropdown-options'>\r\n                        {items}\r\n                    </div>\r\n                );\r\n            }\r\n\r\n            return (\r\n                <div className={style} onClick={e => this.toggleOpen(e)}>\r\n                    {content}\r\n                </div>\r\n            );\r\n        } catch (ex) {\r\n            console.error(ex);\r\n            return null;\r\n        }\r\n    }\r\n}\r\n\r\ninterface DropdownOptionProps {\r\n    option: { id: string; text: string; disabled?: boolean };\r\n    selected: boolean;\r\n    select: (optionID: string) => void;\r\n}\r\n\r\nclass DropdownOption extends React.Component<DropdownOptionProps> {\r\n    private click(e: React.MouseEvent) {\r\n        e.stopPropagation();\r\n        if (!this.props.option.disabled) {\r\n            this.props.select(this.props.option.id);\r\n        }\r\n    }\r\n\r\n    public render() {\r\n        try {\r\n            let style = 'dropdown-option';\r\n            if (this.props.selected) {\r\n                style += ' selected';\r\n            }\r\n            if (this.props.option.disabled) {\r\n                style += ' disabled';\r\n            }\r\n\r\n            return (\r\n                <div className={style} title={this.props.option.text} onClick={e => this.click(e)}>\r\n                    {this.props.option.text}\r\n                </div>\r\n            );\r\n        } catch (ex) {\r\n            console.error(ex);\r\n            return null;\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport arrow from '../../resources/images/down-arrow-black.svg';\r\n\r\ninterface Props {\r\n    text: string;\r\n    content: string | JSX.Element;\r\n    disabled: boolean;\r\n}\r\n\r\ninterface State {\r\n    expanded: boolean;\r\n}\r\n\r\nexport default class Expander extends React.Component<Props, State> {\r\n    public static defaultProps = {\r\n        disabled: false\r\n    };\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            expanded: false\r\n        };\r\n    }\r\n\r\n    private toggle() {\r\n        this.setState({\r\n            expanded: !this.state.expanded\r\n        });\r\n    }\r\n\r\n    public render() {\r\n        try {\r\n            let style = this.props.disabled ? 'expander disabled' : 'expander';\r\n            if (this.state.expanded) {\r\n                style += ' expanded';\r\n            }\r\n\r\n            let content = null;\r\n            if (this.state.expanded) {\r\n                content = (\r\n                    <div className='expander-content'>\r\n                        {this.props.content}\r\n                    </div>\r\n                );\r\n            }\r\n\r\n            return (\r\n                <div className={style}>\r\n                    <div className='expander-header' onClick={() => this.toggle()}>\r\n                        <div className='expander-text'>{this.props.text}</div>\r\n                        <img className='expander-button' src={arrow} alt='arrow' />\r\n                    </div>\r\n                    {content}\r\n                </div>\r\n            );\r\n        } catch (ex) {\r\n            console.error(ex);\r\n            return null;\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport arrow from '../../resources/images/down-arrow-black.svg';\r\n\r\ninterface Props {\r\n    click: (dir: string, dir2: 'in' | 'out' | null) => void;\r\n    direction: 'out' | 'in' | 'both' | 'eight';\r\n    disabled: boolean;\r\n}\r\n\r\nexport default class Radial extends React.Component<Props> {\r\n    public static defaultProps = {\r\n        direction: 'out',\r\n        disabled: false\r\n    };\r\n\r\n    private click(e: React.MouseEvent, dir: string, dir2: 'in' | 'out' | null = null) {\r\n        e.stopPropagation();\r\n        this.props.click(dir, dir2);\r\n    }\r\n\r\n    public render() {\r\n        try {\r\n            let style = 'radial ' + (this.props.direction || 'out');\r\n            if (this.props.disabled) {\r\n                style += ' disabled';\r\n            }\r\n\r\n            const showOut = (this.props.direction === 'out') || (this.props.direction === 'both') || (this.props.direction === 'eight');\r\n            const showIn = (this.props.direction === 'in') || (this.props.direction === 'both');\r\n            const showDiag = (this.props.direction === 'eight');\r\n\r\n            return (\r\n                <div className={style}>\r\n                    <div className='empty' style={{ display: showDiag ? 'none' : 'inline-block' }} />\r\n                    <div className='btn diag' style={{ display: showDiag ? 'inline-block' : 'none' }}>\r\n                        <img\r\n                            src={arrow}\r\n                            style={{ display: showOut ? 'inline-block' : 'none', transform: 'rotate(135deg)' }}\r\n                            alt='nw'\r\n                            onClick={e => this.click(e, 'NW')}\r\n                        />\r\n                    </div>\r\n                    <div className='btn'>\r\n                        <div>\r\n                            <img\r\n                                src={arrow}\r\n                                style={{ display: showOut ? 'inline-block' : 'none', transform: 'rotate(180deg)' }}\r\n                                alt='n'\r\n                                onClick={e => this.click(e, 'N', 'out')}\r\n                            />\r\n                        </div>\r\n                        <div>\r\n                            <img\r\n                                src={arrow}\r\n                                style={{ display: showIn ? 'inline-block' : 'none' }}\r\n                                alt='n'\r\n                                onClick={e => this.click(e, 'N', 'in')}\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                    <div className='empty' style={{ display: showDiag ? 'none' : 'inline-block' }} />\r\n                    <div className='btn diag' style={{ display: showDiag ? 'inline-block' : 'none' }}>\r\n                        <img\r\n                            src={arrow}\r\n                            style={{ display: showOut ? 'inline-block' : 'none', transform: 'rotate(-135deg)' }}\r\n                            alt='ne'\r\n                            onClick={e => this.click(e, 'NE')}\r\n                        />\r\n                    </div>\r\n                    <div className='btn' style={{ padding: (showIn && showOut) ? '10px 0' : '0'}}>\r\n                        <img\r\n                            src={arrow}\r\n                            style={{ display: showOut ? 'inline-block' : 'none', transform: 'rotate(90deg)' }}\r\n                            alt='w'\r\n                            onClick={e => this.click(e, 'W', 'out')}\r\n                        />\r\n                        <img\r\n                            src={arrow}\r\n                            style={{ display: showIn ? 'inline-block' : 'none', transform: 'rotate(-90deg)' }}\r\n                            alt='w'\r\n                            onClick={e => this.click(e, 'W', 'in')}\r\n                        />\r\n                    </div>\r\n                    <div className='empty' />\r\n                    <div className='btn' style={{ padding: (showIn && showOut) ? '10px 0' : '0'}}>\r\n                        <img\r\n                            src={arrow}\r\n                            style={{ display: showIn ? 'inline-block' : 'none', transform: 'rotate(90deg)' }}\r\n                            alt='e'\r\n                            onClick={e => this.click(e, 'E', 'in')}\r\n                        />\r\n                        <img\r\n                            src={arrow}\r\n                            style={{ display: showOut ? 'inline-block' : 'none', transform: 'rotate(-90deg)' }}\r\n                            alt='e'\r\n                            onClick={e => this.click(e, 'E', 'out')}\r\n                        />\r\n                    </div>\r\n                    <div className='empty' style={{ display: showDiag ? 'none' : 'inline-block' }} />\r\n                    <div className='btn diag' style={{ display: showDiag ? 'inline-block' : 'none' }}>\r\n                        <img\r\n                            src={arrow}\r\n                            style={{ display: showOut ? 'inline-block' : 'none', transform: 'rotate(45deg)' }}\r\n                            alt='sw'\r\n                            onClick={e => this.click(e, 'SW')}\r\n                        />\r\n                    </div>\r\n                    <div className='btn'>\r\n                        <div>\r\n                            <img\r\n                                src={arrow}\r\n                                style={{ display: showIn ? 'inline-block' : 'none', transform: 'rotate(180deg)' }}\r\n                                alt='s'\r\n                                onClick={e => this.click(e, 'S', 'in')}\r\n                            />\r\n                        </div>\r\n                        <div>\r\n                            <img\r\n                                src={arrow}\r\n                                style={{ display: showOut ? 'inline-block' : 'none' }}\r\n                                alt='s'\r\n                                onClick={e => this.click(e, 'S', 'out')}\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                    <div className='empty' style={{ display: showDiag ? 'none' : 'inline-block' }} />\r\n                    <div className='btn diag' style={{ display: showDiag ? 'inline-block' : 'none' }}>\r\n                        <img\r\n                            src={arrow}\r\n                            style={{ display: showOut ? 'inline-block' : 'none', transform: 'rotate(-45deg)' }}\r\n                            alt='se'\r\n                            onClick={e => this.click(e, 'SE')}\r\n                        />\r\n                    </div>\r\n                </div>\r\n            );\r\n\r\n        } catch (ex) {\r\n            console.error(ex);\r\n            return null;\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport minus from '../../resources/images/minus.svg';\r\nimport plus from '../../resources/images/plus.svg';\r\n\r\ninterface Props {\r\n    source: any;\r\n    name: string;\r\n    nudgeValue: (delta: number) => void;\r\n    label: string;\r\n    disabled: boolean;\r\n    factors: number[];\r\n    display: ((value: number) => string) | null;\r\n}\r\n\r\nexport default class Spin extends React.Component<Props> {\r\n    public static defaultProps = {\r\n        label: null,\r\n        disabled: false,\r\n        factors: null,\r\n        display: null\r\n    };\r\n\r\n    private click(e: React.MouseEvent, delta: number) {\r\n        e.stopPropagation();\r\n        this.props.nudgeValue(delta);\r\n    }\r\n\r\n    private touchEnd(e: React.TouchEvent, delta: number) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        this.props.nudgeValue(delta);\r\n    }\r\n\r\n    public render() {\r\n        try {\r\n            let style = 'info-value';\r\n            let value = this.props.source[this.props.name];\r\n            if (value === 0) {\r\n                style += ' dimmed';\r\n            }\r\n\r\n            if (this.props.display) {\r\n                value = this.props.display(value);\r\n            }\r\n\r\n            const minusBtns: JSX.Element[] = [];\r\n            const plusBtns: JSX.Element[] = [];\r\n\r\n            if (this.props.factors) {\r\n                this.props.factors.forEach(factor => {\r\n                    minusBtns.push(\r\n                        <div\r\n                            key={'minus' + factor}\r\n                            className='spin-button factor'\r\n                            onTouchEnd={e => this.touchEnd(e, -1 * factor)}\r\n                            onClick={e => this.click(e, -1 * factor)}\r\n                        >\r\n                            {'-' + factor}\r\n                        </div>\r\n                    );\r\n\r\n                    plusBtns.push(\r\n                        <div\r\n                            key={'plus' + factor}\r\n                            className='spin-button factor'\r\n                            onTouchEnd={e => this.touchEnd(e, +1 * factor)}\r\n                            onClick={e => this.click(e, +1 * factor)}\r\n                        >\r\n                            {'+' + factor}\r\n                        </div>\r\n                    );\r\n                });\r\n\r\n                minusBtns.reverse();\r\n            } else {\r\n                minusBtns.push(\r\n                    <div key='minus1' className='spin-button' onTouchEnd={e => this.touchEnd(e, -1)} onClick={e => this.click(e, -1)}>\r\n                        <img className='image' src={minus} alt='minus' />\r\n                    </div>\r\n                );\r\n\r\n                plusBtns.push(\r\n                    <div key='plus1' className='spin-button' onTouchEnd={e => this.touchEnd(e, +1)} onClick={e => this.click(e, +1)}>\r\n                        <img className='image' src={plus} alt='plus' />\r\n                    </div>\r\n                );\r\n            }\r\n\r\n            const infoWidth = 80 * (this.props.factors ? this.props.factors.length : 1);\r\n\r\n            return (\r\n                <div className={this.props.disabled ? 'spin disabled' : 'spin'}>\r\n                    <div className='minus'>\r\n                        {minusBtns}\r\n                    </div>\r\n                    <div className='info' style={{ width: 'calc(100% - ' + infoWidth + 'px)' }}>\r\n                        <div className='info-label'>{this.props.label}</div>\r\n                        <div className={style}>{value}</div>\r\n                    </div>\r\n                    <div className='plus'>\r\n                        {plusBtns}\r\n                    </div>\r\n                </div>\r\n            );\r\n        } catch (ex) {\r\n            console.error(ex);\r\n            return null;\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport Utils from '../../utils/utils';\r\n\r\nimport { Monster } from '../../models/monster-group';\r\n\r\nimport Spin from '../controls/spin';\r\n\r\ninterface Props {\r\n    combatant: Monster;\r\n    edit: boolean;\r\n    nudgeValue: (combatant: Monster, field: string, delta: number) => void;\r\n}\r\n\r\ninterface State {\r\n    showAbilityScores: boolean;\r\n}\r\n\r\nexport default class AbilityScorePanel extends React.Component<Props, State> {\r\n    public static defaultProps = {\r\n        edit: null,\r\n        nudgeValue: null\r\n    };\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n        this.state = {\r\n            showAbilityScores: false\r\n        };\r\n    }\r\n\r\n    private toggleAbilityScores() {\r\n        this.setState({\r\n            showAbilityScores: !this.state.showAbilityScores\r\n        });\r\n    }\r\n\r\n    public render() {\r\n        try {\r\n            let result = null;\r\n\r\n            if (this.props.edit) {\r\n                result = (\r\n                    <div>\r\n                        <Spin\r\n                            source={this.props.combatant.abilityScores}\r\n                            name='str'\r\n                            label='strength'\r\n                            nudgeValue={(delta: number) => this.props.nudgeValue(this.props.combatant, 'abilityScores.str', delta)}\r\n                        />\r\n                        <Spin\r\n                            source={this.props.combatant.abilityScores}\r\n                            name='dex'\r\n                            label='dexterity'\r\n                            nudgeValue={(delta: number) => this.props.nudgeValue(this.props.combatant, 'abilityScores.dex', delta)}\r\n                        />\r\n                        <Spin\r\n                            source={this.props.combatant.abilityScores}\r\n                            name='con'\r\n                            label='constitution'\r\n                            nudgeValue={(delta: number) => this.props.nudgeValue(this.props.combatant, 'abilityScores.con', delta)}\r\n                        />\r\n                        <Spin\r\n                            source={this.props.combatant.abilityScores}\r\n                            name='int'\r\n                            label='intelligence'\r\n                            nudgeValue={(delta: number) => this.props.nudgeValue(this.props.combatant, 'abilityScores.int', delta)}\r\n                        />\r\n                        <Spin\r\n                            source={this.props.combatant.abilityScores}\r\n                            name='wis'\r\n                            label='wisdom'\r\n                            nudgeValue={(delta: number) => this.props.nudgeValue(this.props.combatant, 'abilityScores.wis', delta)}\r\n                        />\r\n                        <Spin\r\n                            source={this.props.combatant.abilityScores}\r\n                            name='cha'\r\n                            label='charisma'\r\n                            nudgeValue={(delta: number) => this.props.nudgeValue(this.props.combatant, 'abilityScores.cha', delta)}\r\n                        />\r\n                    </div>\r\n                );\r\n            } else {\r\n                result = (\r\n                    <div className='ability-scores' onClick={() => this.toggleAbilityScores()}>\r\n                        <div className='ability-score'>\r\n                            <div className='ability-heading'>str</div>\r\n                            <div className='ability-value'>\r\n                                {\r\n                                    this.state.showAbilityScores\r\n                                    ? this.props.combatant.abilityScores.str\r\n                                    : Utils.modifier(this.props.combatant.abilityScores.str)\r\n                                }\r\n                            </div>\r\n                        </div>\r\n                        <div className='ability-score'>\r\n                            <div className='ability-heading'>dex</div>\r\n                            <div className='ability-value'>\r\n                                {\r\n                                    this.state.showAbilityScores\r\n                                    ? this.props.combatant.abilityScores.dex\r\n                                    : Utils.modifier(this.props.combatant.abilityScores.dex)\r\n                                }\r\n                            </div>\r\n                        </div>\r\n                        <div className='ability-score'>\r\n                            <div className='ability-heading'>con</div>\r\n                            <div className='ability-value'>\r\n                                {\r\n                                    this.state.showAbilityScores\r\n                                    ? this.props.combatant.abilityScores.con\r\n                                    : Utils.modifier(this.props.combatant.abilityScores.con)\r\n                                }\r\n                            </div>\r\n                        </div>\r\n                        <div className='ability-score'>\r\n                            <div className='ability-heading'>int</div>\r\n                            <div className='ability-value'>\r\n                                {\r\n                                    this.state.showAbilityScores\r\n                                    ? this.props.combatant.abilityScores.int\r\n                                    : Utils.modifier(this.props.combatant.abilityScores.int)\r\n                                }\r\n                            </div>\r\n                        </div>\r\n                        <div className='ability-score'>\r\n                            <div className='ability-heading'>wis</div>\r\n                            <div className='ability-value'>\r\n                                {\r\n                                    this.state.showAbilityScores\r\n                                    ? this.props.combatant.abilityScores.wis\r\n                                    : Utils.modifier(this.props.combatant.abilityScores.wis)\r\n                                }\r\n                            </div>\r\n                        </div>\r\n                        <div className='ability-score'>\r\n                            <div className='ability-heading'>cha</div>\r\n                            <div className='ability-value'>\r\n                                {\r\n                                    this.state.showAbilityScores\r\n                                    ? this.props.combatant.abilityScores.cha\r\n                                    : Utils.modifier(this.props.combatant.abilityScores.cha)\r\n                                }\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                );\r\n            }\r\n\r\n            return result;\r\n        } catch (e) {\r\n            console.error(e);\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport Utils from '../../utils/utils';\r\n\r\nimport { Combat, Combatant } from '../../models/combat';\r\nimport { Condition } from '../../models/condition';\r\n\r\nimport Expander from '../controls/expander';\r\nimport Spin from '../controls/spin';\r\n\r\ninterface Props {\r\n    combatant: Combatant;\r\n    combat: Combat;\r\n    nudgeConditionValue: (condition: Condition, field: string, delta: number) => void;\r\n    addCondition: () => void;\r\n    editCondition: (condition: Condition) => void;\r\n    removeCondition: (conditionID: string) => void;\r\n}\r\n\r\nexport default class ConditionsPanel extends React.Component<Props> {\r\n    public render() {\r\n        try {\r\n            const conditions = [];\r\n            if (this.props.combatant.conditions) {\r\n                for (let n = 0; n !== this.props.combatant.conditions.length; ++n) {\r\n                    const c = this.props.combatant.conditions[n];\r\n                    conditions.push(\r\n                        <ConditionPanel\r\n                            key={n}\r\n                            condition={c}\r\n                            combat={this.props.combat}\r\n                            nudgeConditionValue={(condition, type, delta) => this.props.nudgeConditionValue(condition, type, delta)}\r\n                            editCondition={condition => this.props.editCondition(condition)}\r\n                            removeCondition={conditionID => this.props.removeCondition(conditionID)}\r\n                        />\r\n                    );\r\n                }\r\n            }\r\n\r\n            return (\r\n                <div className='section'>\r\n                    {conditions}\r\n                    <button onClick={() => this.props.addCondition()}>add a condition</button>\r\n                </div>\r\n            );\r\n        } catch (e) {\r\n            console.error(e);\r\n        }\r\n    }\r\n}\r\n\r\ninterface ConditionPanelProps {\r\n    condition: Condition;\r\n    combat: Combat;\r\n    nudgeConditionValue: (condition: Condition, field: string, delta: number) => void;\r\n    editCondition: (condition: Condition) => void;\r\n    removeCondition: (conditionID: string) => void;\r\n}\r\n\r\nclass ConditionPanel extends React.Component<ConditionPanelProps> {\r\n    public render() {\r\n        try {\r\n            let name: string = this.props.condition.name || 'condition';\r\n            if (this.props.condition.name === 'exhaustion') {\r\n                name += ' (' + this.props.condition.level + ')';\r\n            }\r\n            if ((this.props.condition.name === 'custom') && (this.props.condition.text !== null)) {\r\n                name = this.props.condition.text;\r\n            }\r\n\r\n            if (this.props.condition.duration !== null) {\r\n                name += ' ' + Utils.conditionDurationText(this.props.condition, this.props.combat);\r\n            }\r\n\r\n            const description = [];\r\n            if (this.props.condition.name === 'exhaustion') {\r\n                description.push(\r\n                    <div key='level' className='section'>\r\n                        <Spin\r\n                            source={this.props.condition}\r\n                            name='level'\r\n                            label='level'\r\n                            nudgeValue={delta => this.props.nudgeConditionValue(this.props.condition, 'level', delta)}\r\n                        />\r\n                    </div>\r\n                );\r\n            }\r\n            const text = Utils.conditionText(this.props.condition);\r\n            for (let n = 0; n !== text.length; ++n) {\r\n                description.push(<div key={n} className='section'>{text[n]}</div>);\r\n            }\r\n\r\n            return (\r\n                <Expander\r\n                    text={name}\r\n                    content={(\r\n                        <div>\r\n                            {description}\r\n                            <div className='divider' />\r\n                            <button onClick={() => this.props.editCondition(this.props.condition)}>edit</button>\r\n                            <button onClick={() => this.props.removeCondition(this.props.condition.id)}>remove</button>\r\n                        </div>\r\n                    )}\r\n                />\r\n            );\r\n        } catch (e) {\r\n            console.error(e);\r\n        }\r\n    }\r\n}\r\n","export interface MonsterGroup {\r\n    id: string;\r\n    name: string;\r\n    monsters: Monster[];\r\n}\r\n\r\nexport interface Monster {\r\n    id: string;\r\n    type: string;\r\n    name: string;\r\n    size: string;\r\n    category: string;\r\n    tag: string;\r\n    alignment: string;\r\n    challenge: number;\r\n    abilityScores: {\r\n        str: number;\r\n        dex: number;\r\n        con: number;\r\n        int: number;\r\n        wis: number;\r\n        cha: number;\r\n    };\r\n    ac: number;\r\n    hpMax: number;\r\n    hpTemp: number;\r\n    hitDice: number;\r\n    damage: {\r\n        resist: string;\r\n        vulnerable: string;\r\n        immune: string;\r\n    };\r\n    savingThrows: string;\r\n    speed: string;\r\n    skills: string;\r\n    senses: string;\r\n    languages: string;\r\n    equipment: string;\r\n    traits: Trait[];\r\n    conditionImmunities: string;\r\n}\r\n\r\nexport interface Trait {\r\n    id: string;\r\n    name: string;\r\n    usage: string;\r\n    type: 'trait' | 'action' | 'legendary' | 'lair' | 'regional';\r\n    text: string;\r\n    uses: number;\r\n}\r\n\r\nexport const SIZE_TYPES = [\r\n    'tiny',\r\n    'small',\r\n    'medium',\r\n    'large',\r\n    'huge',\r\n    'gargantuan'\r\n];\r\n\r\nexport const CATEGORY_TYPES = [\r\n    'aberration',\r\n    'beast',\r\n    'celestial',\r\n    'construct',\r\n    'dragon',\r\n    'elemental',\r\n    'fey',\r\n    'fiend',\r\n    'giant',\r\n    'humanoid',\r\n    'monstrosity',\r\n    'ooze',\r\n    'plant',\r\n    'undead'\r\n];\r\n\r\nexport const TRAIT_TYPES = [\r\n    'trait',\r\n    'action',\r\n    'legendary',\r\n    'lair',\r\n    'regional'\r\n];\r\n","import React from 'react';\r\nimport Showdown from 'showdown';\r\n\r\nimport Utils from '../../utils/utils';\r\n\r\nimport { Combatant } from '../../models/combat';\r\nimport { Monster, Trait, TRAIT_TYPES } from '../../models/monster-group';\r\n\r\nimport ConfirmButton from '../controls/confirm-button';\r\nimport Expander from '../controls/expander';\r\n\r\nconst showdown = new Showdown.Converter();\r\n\r\ninterface Props {\r\n    combatant: Monster | (Combatant & Monster);\r\n    mode: 'view' | 'edit' | 'template' | 'combat';\r\n    addTrait: (traitType: 'trait' | 'action' | 'legendary' | 'lair' | 'regional') => void;\r\n    copyTrait: (trait: Trait) => void;\r\n    removeTrait: (trait: Trait) => void;\r\n    changeValue: (trait: Trait, field: string, value: any) => void;\r\n    swapTraits: (t1: Trait, t2: Trait) => void;\r\n}\r\n\r\nexport default class TraitsPanel extends React.Component<Props> {\r\n    public static defaultProps = {\r\n        mode: 'view',\r\n        addTrait: null,\r\n        copyTrait: null,\r\n        removeTrait: null,\r\n        changeValue: null,\r\n        swapTraits: null\r\n    };\r\n\r\n    private createTraitPanel(trait: Trait, prevTrait: Trait | null, nextTrait: Trait | null) {\r\n        return (\r\n            <TraitPanel\r\n                key={trait.id}\r\n                trait={trait}\r\n                mode={this.props.mode}\r\n                prevTrait={prevTrait}\r\n                nextTrait={nextTrait}\r\n                changeValue={(action, type, value) => this.props.changeValue(action, type, value)}\r\n                removeTrait={action => this.props.removeTrait(action)}\r\n                copyTrait={action => this.props.copyTrait(action)}\r\n                swapTraits={(t1, t2) => this.props.swapTraits(t1, t2)}\r\n            />\r\n        );\r\n    }\r\n\r\n    private createSection(traitsByType: { [id: string]: JSX.Element[] }, type: string) {\r\n        const types = Utils.traitType(type) + 's';\r\n        const traits = traitsByType[type];\r\n        if (traits.length === 0) {\r\n            return null;\r\n        }\r\n\r\n        return (\r\n            <div>\r\n                <div className='section subheading'>{types}</div>\r\n                {traits}\r\n            </div>\r\n        );\r\n    }\r\n\r\n    public render() {\r\n        try {\r\n            const traitsByType: { [id: string]: JSX.Element[] } = {};\r\n\r\n            TRAIT_TYPES.forEach(type => {\r\n                const traits = this.props.combatant.traits.filter(t => t.type === type);\r\n\r\n                const list: JSX.Element[] = [];\r\n                for (let n = 0; n !== traits.length; ++n) {\r\n                    const trait = traits[n];\r\n                    const prevTrait = n !== 0 ? traits[n - 1] : null;\r\n                    const nextTrait = n !== traits.length - 1 ? traits[n + 1] : null;\r\n                    list.push(this.createTraitPanel(trait, prevTrait, nextTrait));\r\n                }\r\n\r\n                if (this.props.mode === 'edit') {\r\n                    list.push(\r\n                        <button key='add' onClick={() => this.props.addTrait(type as 'trait' | 'action' | 'legendary' | 'lair' | 'regional')}>\r\n                            add a new {Utils.traitType(type)}\r\n                        </button>\r\n                    );\r\n                }\r\n\r\n                traitsByType[type] = list;\r\n            });\r\n\r\n            if (this.props.mode === 'edit') {\r\n                return (\r\n                    <div className='row collapse'>\r\n                        <div className='columns small-4 medium-4 large-4 list-column'>\r\n                            {this.createSection(traitsByType, 'trait')}\r\n                        </div>\r\n                        <div className='columns small-4 medium-4 large-4 list-column'>\r\n                            {this.createSection(traitsByType, 'action')}\r\n                        </div>\r\n                        <div className='columns small-4 medium-4 large-4 list-column'>\r\n                            {this.createSection(traitsByType, 'legendary')}\r\n                            {this.createSection(traitsByType, 'lair')}\r\n                            {this.createSection(traitsByType, 'regional')}\r\n                        </div>\r\n                    </div>\r\n                );\r\n            }\r\n\r\n            return (\r\n                <div>\r\n                    {this.createSection(traitsByType, 'trait')}\r\n                    {this.createSection(traitsByType, 'action')}\r\n                    {this.createSection(traitsByType, 'legendary')}\r\n                    {this.createSection(traitsByType, 'lair')}\r\n                    {this.createSection(traitsByType, 'regional')}\r\n                </div>\r\n            );\r\n        } catch (e) {\r\n            console.error(e);\r\n        }\r\n    }\r\n}\r\n\r\ninterface TraitPanelProps {\r\n    trait: Trait;\r\n    mode: 'view' | 'edit' | 'template' | 'combat';\r\n    prevTrait: Trait | null;\r\n    nextTrait: Trait | null;\r\n    changeValue: (trait: Trait, field: string, value: any) => void;\r\n    copyTrait: (trait: Trait) => void;\r\n    removeTrait: (trait: Trait) => void;\r\n    swapTraits: (t1: Trait, t2: Trait) => void;\r\n}\r\n\r\nclass TraitPanel extends React.Component<TraitPanelProps> {\r\n    public render() {\r\n        try {\r\n            let maxUses = 0;\r\n            let heading = this.props.trait.name || 'unnamed ' + Utils.traitType(this.props.trait.type);\r\n\r\n            if (this.props.trait.usage) {\r\n                let used = '';\r\n                if (this.props.trait.usage.toLowerCase().startsWith('recharge ')) {\r\n                    maxUses = 1;\r\n                    if (this.props.trait.uses > 0) {\r\n                        used = '; used';\r\n                    }\r\n                }\r\n                const found = this.props.trait.usage.toLowerCase().match(/(\\d+)\\s*\\/\\s*day/);\r\n                if (found) {\r\n                    maxUses = parseInt(found[1], 10);\r\n                    if (this.props.trait.uses > 0) {\r\n                        used = '; used ' + this.props.trait.uses;\r\n                    }\r\n                }\r\n                heading += ' *(' + this.props.trait.usage + used + ')*';\r\n            }\r\n            const markdown = '**' + heading + '** ' + this.props.trait.text;\r\n\r\n            switch (this.props.mode) {\r\n                case 'view':\r\n                    return (\r\n                        <div key={this.props.trait.id} className='section trait'>\r\n                            <div dangerouslySetInnerHTML={{ __html: showdown.makeHtml(markdown) }} />\r\n                        </div>\r\n                    );\r\n                case 'edit':\r\n                    const details = (\r\n                        <div className='section'>\r\n                            <input\r\n                                type='text'\r\n                                placeholder='name'\r\n                                value={this.props.trait.name}\r\n                                onChange={event => this.props.changeValue(this.props.trait, 'name', event.target.value)}\r\n                            />\r\n                            <input\r\n                                type='text'\r\n                                placeholder='usage'\r\n                                value={this.props.trait.usage}\r\n                                onChange={event => this.props.changeValue(this.props.trait, 'usage', event.target.value)}\r\n                            />\r\n                            <textarea\r\n                                placeholder='details'\r\n                                value={this.props.trait.text}\r\n                                onChange={event => this.props.changeValue(this.props.trait, 'text', event.target.value)}\r\n                            />\r\n                            <div className='divider' />\r\n                            <button\r\n                                className={this.props.prevTrait ? '' : 'disabled'}\r\n                                onClick={() => this.props.swapTraits(this.props.trait, this.props.prevTrait as Trait)}\r\n                            >\r\n                                move up\r\n                            </button>\r\n                            <button\r\n                                className={this.props.nextTrait ? '' : 'disabled'}\r\n                                onClick={() => this.props.swapTraits(this.props.trait, this.props.nextTrait as Trait)}\r\n                            >\r\n                                move down\r\n                            </button>\r\n                            <ConfirmButton text='delete' callback={() => this.props.removeTrait(this.props.trait)} />\r\n                        </div>\r\n                    );\r\n\r\n                    return (\r\n                        <Expander\r\n                            text={this.props.trait.name || 'unnamed ' + Utils.traitType(this.props.trait.type)}\r\n                            content={details}\r\n                        />\r\n                    );\r\n                case 'template':\r\n                    return (\r\n                        <div key={this.props.trait.id} className='section trait'>\r\n                            <div dangerouslySetInnerHTML={{ __html: showdown.makeHtml(markdown) }} />\r\n                            <button onClick={() => this.props.copyTrait(this.props.trait)}>copy</button>\r\n                        </div>\r\n                    );\r\n                case 'combat':\r\n                    let style = '';\r\n                    let usage = null;\r\n                    if (maxUses > 0) {\r\n                        const isTapped = this.props.trait.uses >= maxUses;\r\n                        if (isTapped) {\r\n                            style = 'strikethrough';\r\n                            usage = <button onClick={() => this.props.changeValue(this.props.trait, 'uses', 0)}>recharge</button>;\r\n                        } else {\r\n                            usage = <button onClick={() => this.props.changeValue(this.props.trait, 'uses', this.props.trait.uses + 1)}>use</button>;\r\n                        }\r\n                    }\r\n                    return (\r\n                        <div key={this.props.trait.id} className='section trait'>\r\n                            <div className={style} dangerouslySetInnerHTML={{ __html: showdown.makeHtml(markdown) }} />\r\n                            {usage}\r\n                        </div>\r\n                    );\r\n            }\r\n        } catch (e) {\r\n            console.error(e);\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport Utils from '../../utils/utils';\r\n\r\nimport { Combat, Combatant } from '../../models/combat';\r\nimport { Condition } from '../../models/condition';\r\nimport { Encounter, EncounterSlot, EncounterWave } from '../../models/encounter';\r\nimport { Monster, MonsterGroup, Trait } from '../../models/monster-group';\r\n\r\nimport ButtonRow from '../controls/button-row';\r\nimport ConfirmButton from '../controls/confirm-button';\r\nimport Dropdown from '../controls/dropdown';\r\nimport Expander from '../controls/expander';\r\nimport Radial from '../controls/radial';\r\nimport Spin from '../controls/spin';\r\nimport AbilityScorePanel from '../panels/ability-score-panel';\r\nimport ConditionsPanel from '../panels/conditions-panel';\r\nimport TraitsPanel from '../panels/traits-panel';\r\nimport InfoCard from './info-card';\r\n\r\nimport arrow from '../../resources/images/down-arrow.svg';\r\n\r\ninterface Props {\r\n    combatant: Monster | (Monster & Combatant);\r\n    mode: string;\r\n    library: MonsterGroup[];\r\n    changeValue: (monster: any, field: string, value: any) => void;\r\n    nudgeValue: (source: any, field: string, delta: number) => void;\r\n    // Library\r\n    editMonster: (monster: Monster) => void;\r\n    removeMonster: (monster: Monster) => void;\r\n    cloneMonster: (monster: Monster, name: string) => void;\r\n    moveToGroup: (monster: Monster, group: string) => void;\r\n    copyTrait: (trait: Trait) => void;\r\n    // Encounter builder\r\n    encounter: Encounter;\r\n    slot: EncounterSlot;\r\n    addEncounterSlot: (monster: Monster, waveID: string | null) => void;\r\n    removeEncounterSlot: (slot: EncounterSlot) => void;\r\n    // Combat\r\n    combat: Combat;\r\n    makeCurrent: (combatant: Combatant) => void;\r\n    makeActive: (combatant: Combatant) => void;\r\n    makeDefeated: (combatant: Combatant) => void;\r\n    endTurn: (combatant: Combatant) => void;\r\n    mapAdd: (combatant: Combatant) => void;\r\n    mapMove: (combatant: Combatant, dir: string) => void;\r\n    mapRemove: (combatant: Combatant) => void;\r\n    removeCombatant: (combatant: Combatant) => void;\r\n    changeHP: (combatant: Combatant, hp: number, tempHP: number) => void;\r\n    addCondition: (combatant: Combatant) => void;\r\n    editCondition: (combatant: Combatant, condition: Condition) => void;\r\n    removeCondition: (combatant: Combatant, conditionID: string) => void;\r\n    nudgeConditionValue: (condition: Condition, field: string, delta: number) => void;\r\n}\r\n\r\ninterface State {\r\n    showDetails: boolean;\r\n    cloneName: string;\r\n    damageOrHealing: number;\r\n}\r\n\r\nexport default class MonsterCard extends React.Component<Props, State> {\r\n    public static defaultProps = {\r\n        library: null,\r\n        changeValue: null,\r\n        nudgeValue: null,\r\n        editMonster: null,\r\n        removeMonster: null,\r\n        cloneMonster: null,\r\n        moveToGroup: null,\r\n        copyTrait: null,\r\n        encounter: null,\r\n        slot: null,\r\n        addEncounterSlot: null,\r\n        removeEncounterSlot: null,\r\n        combat: null,\r\n        makeCurrent: null,\r\n        makeActive: null,\r\n        makeDefeated: null,\r\n        endTurn: null,\r\n        mapAdd: null,\r\n        mapMove: null,\r\n        mapRemove: null,\r\n        removeCombatant: null,\r\n        changeHP: null,\r\n        addCondition: null,\r\n        editCondition: null,\r\n        removeCondition: null,\r\n        nudgeConditionValue: null\r\n    };\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n        this.state = {\r\n            showDetails: false,\r\n            cloneName: props.combatant.name + ' copy',\r\n            damageOrHealing: 0\r\n        };\r\n    }\r\n\r\n    private setCloneName(cloneName: string) {\r\n        this.setState({\r\n            cloneName: cloneName\r\n        });\r\n    }\r\n\r\n    private toggleDetails() {\r\n        this.setState({\r\n            showDetails: !this.state.showDetails\r\n        });\r\n    }\r\n\r\n    private setDamage(value: number) {\r\n        this.setState({\r\n            damageOrHealing: value\r\n        });\r\n    }\r\n\r\n    private nudgeDamage(delta: number) {\r\n        this.setState({\r\n            damageOrHealing: Math.max(this.state.damageOrHealing + delta, 0)\r\n        });\r\n    }\r\n\r\n    private heal() {\r\n        const combatant = this.props.combatant as Combatant;\r\n\r\n        let hp = (combatant.hp ? combatant.hp : 0) + this.state.damageOrHealing;\r\n        hp = Math.min(hp, this.props.combatant.hpMax);\r\n\r\n        this.setState({\r\n            damageOrHealing: 0\r\n        }, () => {\r\n            this.props.changeHP(combatant, hp, this.props.combatant.hpTemp);\r\n        });\r\n    }\r\n\r\n    private damage() {\r\n        const combatant = this.props.combatant as Combatant;\r\n\r\n        let hp = (combatant.hp ? combatant.hp : 0);\r\n        let temp = this.props.combatant.hpTemp;\r\n\r\n        let damage = this.state.damageOrHealing;\r\n\r\n        // Take damage off temp HP first\r\n        const val = Math.min(damage, temp);\r\n        damage -= val;\r\n        temp -= val;\r\n\r\n        // Take the rest off HP\r\n        hp -= damage;\r\n        hp = Math.max(hp, 0);\r\n\r\n        this.setState({\r\n            damageOrHealing: 0\r\n        }, () => {\r\n            this.props.changeHP(combatant, hp, temp);\r\n        });\r\n    }\r\n\r\n    private description() {\r\n        let sizeAndType = (this.props.combatant.size + ' ' + this.props.combatant.category).toLowerCase();\r\n        if (this.props.combatant.tag) {\r\n            sizeAndType += ' (' + this.props.combatant.tag.toLowerCase() + ')';\r\n        }\r\n        sizeAndType += ', ';\r\n\r\n        let align = '';\r\n        if (this.props.combatant.alignment) {\r\n            align = this.props.combatant.alignment.toLowerCase() + ', ';\r\n        }\r\n\r\n        const cr = 'cr ' + Utils.challenge(this.props.combatant.challenge);\r\n\r\n        return sizeAndType + align + cr;\r\n    }\r\n\r\n    private monsterIsInWave(wave: EncounterWave) {\r\n        return wave.slots.some(s => {\r\n            const group = this.props.library.find(g => g.monsters.includes(this.props.combatant));\r\n            return !!group && (s.monsterGroupName === group.name) && (s.monsterName === this.props.combatant.name);\r\n        });\r\n    }\r\n\r\n    private getHP() {\r\n        if (this.props.combatant.hitDice === 0) {\r\n            return this.props.combatant.hpMax;\r\n        }\r\n\r\n        const die = Utils.hitDieType(this.props.combatant.size);\r\n        const conMod = Utils.modifierValue(this.props.combatant.abilityScores.con) * this.props.combatant.hitDice;\r\n        let conModStr = '';\r\n        if (conMod > 0) {\r\n            conModStr = ' +' + conMod;\r\n        }\r\n        if (conMod < 0) {\r\n            conModStr = ' ' + conMod;\r\n        }\r\n        return this.props.combatant.hpMax + ' (' + this.props.combatant.hitDice + 'd' + die + conModStr + ')';\r\n    }\r\n\r\n    public render() {\r\n        try {\r\n            const options = [];\r\n            if (this.props.mode.indexOf('no-buttons') === -1) {\r\n                if (this.props.mode.indexOf('view') !== -1) {\r\n                    if (this.props.mode.indexOf('editable') !== -1) {\r\n                        options.push(\r\n                            <button key='edit' onClick={() => this.props.editMonster(this.props.combatant)}>edit monster</button>\r\n                        );\r\n\r\n                        options.push(\r\n                            <Expander\r\n                                key='clone'\r\n                                text='clone monster'\r\n                                content={\r\n                                    <div>\r\n                                        <input\r\n                                            type='text'\r\n                                            placeholder='monster name'\r\n                                            value={this.state.cloneName}\r\n                                            onChange={event => this.setCloneName(event.target.value)}\r\n                                        />\r\n                                        <button onClick={() => this.props.cloneMonster(this.props.combatant, this.state.cloneName)}>create copy</button>\r\n                                    </div>\r\n                                }\r\n                            />\r\n                        );\r\n\r\n                        const groupOptions: { id: string, text: string }[] = [];\r\n                        this.props.library.forEach(group => {\r\n                            if (group.monsters.indexOf(this.props.combatant) === -1) {\r\n                                groupOptions.push({\r\n                                    id: group.id,\r\n                                    text: group.name\r\n                                });\r\n                            }\r\n                        });\r\n                        options.push(\r\n                            <Dropdown\r\n                                key='move'\r\n                                options={groupOptions}\r\n                                placeholder='move to group...'\r\n                                select={optionID => this.props.moveToGroup(this.props.combatant, optionID)}\r\n                            />\r\n                        );\r\n\r\n                        options.push(<ConfirmButton key='remove' text='delete monster' callback={() => this.props.removeMonster(this.props.combatant)} />);\r\n                    }\r\n                    if (this.props.mode.indexOf('encounter') !== -1) {\r\n                        if (this.props.slot) {\r\n                            // This card is in an encounter or a wave\r\n                            options.push(\r\n                                <button key='remove' onClick={() => this.props.removeEncounterSlot(this.props.slot)}>\r\n                                    remove from encounter\r\n                                </button>\r\n                            );\r\n                        } else {\r\n                            let canAdd = false;\r\n                            // This card is in the library list\r\n                            if (!this.monsterIsInWave(this.props.encounter)) {\r\n                                options.push(\r\n                                    <button key='add encounter' onClick={() => this.props.addEncounterSlot(this.props.combatant, null)}>\r\n                                        add to encounter\r\n                                    </button>\r\n                                );\r\n                                canAdd = true;\r\n                            }\r\n                            this.props.encounter.waves.forEach(wave => {\r\n                                if (!this.monsterIsInWave(wave)) {\r\n                                    options.push(\r\n                                        <button key={'add ' + wave.id} onClick={() => this.props.addEncounterSlot(this.props.combatant, wave.id)}>\r\n                                            add to {wave.name}\r\n                                        </button>\r\n                                    );\r\n                                    canAdd = true;\r\n                                }\r\n                            });\r\n                            // If we can't add it anywhere, don't show it\r\n                            if (!canAdd) {\r\n                                return (\r\n                                    <InfoCard\r\n                                        getHeading={() => {\r\n                                            return (\r\n                                                <div className='heading'>\r\n                                                    <div className='title'>{this.props.combatant.name}</div>\r\n                                                </div>\r\n                                            );\r\n                                        }}\r\n                                        getContent={() => {\r\n                                            return (\r\n                                                <div className='section centered'>\r\n                                                    <i>this monster is already part of this encounter</i>\r\n                                                </div>\r\n                                            );\r\n                                        }}\r\n                                    />\r\n                                );\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                if (this.props.mode.indexOf('combat') !== -1) {\r\n                    const combatant = this.props.combatant as Combatant;\r\n\r\n                    if (this.props.mode.indexOf('tactical') !== -1) {\r\n                        if (this.props.mode.indexOf('on-map') !== -1) {\r\n                            options.push(\r\n                                <div key='mapMove' className='section centered'>\r\n                                    <Radial\r\n                                        direction='eight'\r\n                                        click={dir => this.props.mapMove(combatant, dir)}\r\n                                    />\r\n                                </div>\r\n                            );\r\n                            options.push(\r\n                                <Spin\r\n                                    key='altitude'\r\n                                    source={this.props.combatant}\r\n                                    name='altitude'\r\n                                    label='altitude'\r\n                                    display={value => value + ' ft.'}\r\n                                    nudgeValue={delta => this.props.nudgeValue(this.props.combatant, 'altitude', delta * 5)}\r\n                                />\r\n                            );\r\n                            options.push(<button key='mapRemove' onClick={() => this.props.mapRemove(combatant)}>remove from map</button>);\r\n                        }\r\n                        if (this.props.mode.indexOf('off-map') !== -1) {\r\n                            options.push(<button key='mapAdd' onClick={() => this.props.mapAdd(combatant)}>add to map</button>);\r\n                        }\r\n                        options.push(<div key='tactical-div' className='divider' />);\r\n                    }\r\n                    if (combatant.pending && !combatant.active && !combatant.defeated) {\r\n                        options.push(<ConfirmButton key='remove' text='remove from encounter' callback={() => this.props.removeCombatant(combatant)} />);\r\n                    }\r\n                    if (!combatant.pending && combatant.active && !combatant.defeated) {\r\n                        if (combatant.current) {\r\n                            options.push(<button key='endTurn' onClick={() => this.props.endTurn(combatant)}>end turn</button>);\r\n                            options.push(<button key='makeDefeated' onClick={() => this.props.makeDefeated(combatant)}>mark as defeated and end turn</button>);\r\n                        } else {\r\n                            options.push(<button key='makeCurrent' onClick={() => this.props.makeCurrent(combatant)}>start turn</button>);\r\n                            options.push(<button key='makeDefeated' onClick={() => this.props.makeDefeated(combatant)}>mark as defeated</button>);\r\n                            options.push(<ConfirmButton key='remove' text='remove from encounter' callback={() => this.props.removeCombatant(combatant)} />);\r\n                        }\r\n                    }\r\n                    if (!combatant.pending && !combatant.active && combatant.defeated) {\r\n                        options.push(<button key='makeActive' onClick={() => this.props.makeActive(combatant)}>mark as active</button>);\r\n                        options.push(<ConfirmButton key='remove' text='remove from encounter' callback={() => this.props.removeCombatant(combatant)} />);\r\n                    }\r\n                    options.push(\r\n                        <Expander\r\n                            key='rename'\r\n                            text='change name'\r\n                            content={(\r\n                                <div>\r\n                                    <input\r\n                                        type='text'\r\n                                        value={combatant.displayName}\r\n                                        onChange={event => this.props.changeValue(this.props.combatant, 'displayName', event.target.value)}\r\n                                    />\r\n                                </div>\r\n                            )}\r\n                        />\r\n                    );\r\n                    options.push(\r\n                        <Expander\r\n                            key='init'\r\n                            text='change initiative score'\r\n                            content={(\r\n                                <div>\r\n                                    <Spin\r\n                                        source={this.props.combatant}\r\n                                        name='initiative'\r\n                                        label='initiative'\r\n                                        nudgeValue={delta => this.props.nudgeValue(this.props.combatant, 'initiative', delta)}\r\n                                    />\r\n                                </div>\r\n                            )}\r\n                        />\r\n                    );\r\n                }\r\n                if (this.props.mode.indexOf('template') !== -1) {\r\n                    // None\r\n                }\r\n            }\r\n\r\n            let stats = null;\r\n            if (this.props.mode.indexOf('view') !== -1) {\r\n                let slotSection = null;\r\n                if (this.props.slot) {\r\n                    slotSection = (\r\n                        <div>\r\n                            <div className='divider' />\r\n                            <Spin\r\n                                source={this.props.slot}\r\n                                name='count'\r\n                                label='count'\r\n                                nudgeValue={delta => this.props.nudgeValue(this.props.slot, 'count', delta)}\r\n                            />\r\n                        </div>\r\n                    );\r\n                }\r\n\r\n                let details = null;\r\n                if (this.state.showDetails) {\r\n                    details = (\r\n                        <div>\r\n                            <div className='divider' />\r\n                            <div className='section'>\r\n                                <b>ac</b> {this.props.combatant.ac}\r\n                            </div>\r\n                            <div className='section' style={{ display: this.props.combatant.hpMax !== 0 ? '' : 'none' }}>\r\n                                <b>hp</b> {this.getHP()}\r\n                            </div>\r\n                            <div className='section' style={{ display: this.props.combatant.speed !== '' ? '' : 'none' }}>\r\n                                <b>speed</b> {this.props.combatant.speed}\r\n                            </div>\r\n                            <div className='section'>\r\n                                <AbilityScorePanel combatant={this.props.combatant} />\r\n                            </div>\r\n                            <div className='section' style={{ display: this.props.combatant.savingThrows !== '' ? '' : 'none' }}>\r\n                                <b>saving throws</b> {this.props.combatant.savingThrows}\r\n                            </div>\r\n                            <div className='section' style={{ display: this.props.combatant.skills !== '' ? '' : 'none' }}>\r\n                                <b>skills</b> {this.props.combatant.skills}\r\n                            </div>\r\n                            <div className='section' style={{ display: this.props.combatant.damage.resist !== '' ? '' : 'none' }}>\r\n                                <b>damage resistances</b> {this.props.combatant.damage.resist}\r\n                            </div>\r\n                            <div className='section' style={{ display: this.props.combatant.damage.vulnerable !== '' ? '' : 'none' }}>\r\n                                <b>damage vulnerabilities</b> {this.props.combatant.damage.vulnerable}\r\n                            </div>\r\n                            <div className='section' style={{ display: this.props.combatant.damage.immune !== '' ? '' : 'none' }}>\r\n                                <b>damage immunities</b> {this.props.combatant.damage.immune}\r\n                            </div>\r\n                            <div className='section' style={{ display: this.props.combatant.conditionImmunities !== '' ? '' : 'none' }}>\r\n                                <b>condition immunities</b> {this.props.combatant.conditionImmunities}\r\n                            </div>\r\n                            <div className='section' style={{ display: this.props.combatant.senses !== '' ? '' : 'none' }}>\r\n                                <b>senses</b> {this.props.combatant.senses}\r\n                            </div>\r\n                            <div className='section' style={{ display: this.props.combatant.languages !== '' ? '' : 'none' }}>\r\n                                <b>languages</b> {this.props.combatant.languages}\r\n                            </div>\r\n                            <div className='section' style={{ display: this.props.combatant.equipment !== '' ? '' : 'none' }}>\r\n                                <b>equipment</b> {this.props.combatant.equipment}\r\n                            </div>\r\n                            <div className='divider' />\r\n                            <TraitsPanel combatant={this.props.combatant} />\r\n                        </div>\r\n                    );\r\n                }\r\n\r\n                stats = (\r\n                    <div className='stats'>\r\n                        <div className='section centered'>\r\n                            <i>{this.description()}</i>\r\n                        </div>\r\n                        {slotSection}\r\n                        {details}\r\n                    </div>\r\n                );\r\n            }\r\n            if (this.props.mode.indexOf('combat') !== -1) {\r\n                stats = (\r\n                    <div className='stats'>\r\n                        <div className='section centered'>\r\n                            <i>{this.description()}</i>\r\n                        </div>\r\n                        <div className='divider' />\r\n                        <Spin\r\n                            source={this.props.combatant}\r\n                            name='hp'\r\n                            label='hit points'\r\n                            factors={[1, 10]}\r\n                            nudgeValue={delta => this.props.nudgeValue(this.props.combatant, 'hp', delta)}\r\n                        />\r\n                        <Spin\r\n                            source={this.props.combatant}\r\n                            name='hpTemp'\r\n                            label='temp hp'\r\n                            factors={[1, 10]}\r\n                            nudgeValue={delta => this.props.nudgeValue(this.props.combatant, 'hpTemp', delta)}\r\n                        />\r\n                        <div className='divider' />\r\n                        <Spin\r\n                            source={this.state}\r\n                            name='damageOrHealing'\r\n                            factors={[1, 10]}\r\n                            nudgeValue={delta => this.nudgeDamage(delta)}\r\n                        />\r\n                        <ButtonRow\r\n                            buttons={[\r\n                                { id: 'heal', text: 'heal', disabled: false, callback: () => this.heal() },\r\n                                { id: 'reset', text: 'reset', disabled: false, callback: () => this.setDamage(0) },\r\n                                { id: 'damage', text: 'damage', disabled: false, callback: () => this.damage() }\r\n                            ]}\r\n                            disabled={this.state.damageOrHealing === 0}\r\n                        />\r\n                        <div className='section' style={{ display: this.props.combatant.damage.resist !== '' ? '' : 'none' }}>\r\n                            <b>damage resistances</b> {this.props.combatant.damage.resist}\r\n                        </div>\r\n                        <div className='section' style={{ display: this.props.combatant.damage.vulnerable !== '' ? '' : 'none' }}>\r\n                            <b>damage vulnerabilities</b> {this.props.combatant.damage.vulnerable}\r\n                        </div>\r\n                        <div className='section' style={{ display: this.props.combatant.damage.immune !== '' ? '' : 'none' }}>\r\n                            <b>damage immunities</b> {this.props.combatant.damage.immune}\r\n                        </div>\r\n                        <div className='divider' />\r\n                        <div className='section'>\r\n                            <AbilityScorePanel combatant={this.props.combatant} />\r\n                        </div>\r\n                        <div className='section' style={{ display: this.props.combatant.ac !== 0 ? '' : 'none' }}>\r\n                            <b>ac</b> {this.props.combatant.ac}\r\n                        </div>\r\n                        <div className='section' style={{ display: this.props.combatant.savingThrows !== '' ? '' : 'none' }}>\r\n                            <b>saving throws</b> {this.props.combatant.savingThrows}\r\n                        </div>\r\n                        <div className='section' style={{ display: this.props.combatant.skills !== '' ? '' : 'none' }}>\r\n                            <b>skills</b> {this.props.combatant.skills}\r\n                        </div>\r\n                        <div className='section' style={{ display: this.props.combatant.speed !== '' ? '' : 'none' }}>\r\n                            <b>speed</b> {this.props.combatant.speed}\r\n                        </div>\r\n                        <div className='section' style={{ display: this.props.combatant.senses !== '' ? '' : 'none' }}>\r\n                            <b>senses</b> {this.props.combatant.senses}\r\n                        </div>\r\n                        <div className='section' style={{ display: this.props.combatant.languages !== '' ? '' : 'none' }}>\r\n                            <b>languages</b> {this.props.combatant.languages}\r\n                        </div>\r\n                        <div className='section' style={{ display: this.props.combatant.equipment !== '' ? '' : 'none' }}>\r\n                            <b>equipment</b> {this.props.combatant.equipment}\r\n                        </div>\r\n                        <div className='divider' />\r\n                        <TraitsPanel\r\n                            combatant={this.props.combatant}\r\n                            mode='combat'\r\n                            changeValue={(trait, field, value) => this.props.changeValue(trait, field, value)}\r\n                        />\r\n                        <div className='divider' />\r\n                        <div className='section subheading'>\r\n                            conditions\r\n                        </div>\r\n                        <div className='section' style={{ display: this.props.combatant.conditionImmunities !== '' ? '' : 'none' }}>\r\n                            <b>condition immunities</b> {this.props.combatant.conditionImmunities}\r\n                        </div>\r\n                        <ConditionsPanel\r\n                            combatant={this.props.combatant as Combatant}\r\n                            combat={this.props.combat}\r\n                            addCondition={() => this.props.addCondition(this.props.combatant as Combatant)}\r\n                            editCondition={condition => this.props.editCondition(this.props.combatant as Combatant, condition)}\r\n                            removeCondition={conditionID => this.props.removeCondition(this.props.combatant as Combatant, conditionID)}\r\n                            nudgeConditionValue={(condition, type, delta) => this.props.nudgeConditionValue(condition, type, delta)}\r\n                        />\r\n                    </div>\r\n                );\r\n            }\r\n            if (this.props.mode.indexOf('template') !== -1) {\r\n                if (this.props.mode.indexOf('overview') !== -1) {\r\n                    stats = (\r\n                        <div>\r\n                            <div className='section centered'>\r\n                                <i>{this.description()}</i>\r\n                            </div>\r\n                            <div className='divider' />\r\n                            <div className='section'>\r\n                                <b>speed</b> {this.props.combatant.speed || '-'}\r\n                            </div>\r\n                            <div className='section'>\r\n                                <b>senses</b> {this.props.combatant.senses || '-'}\r\n                            </div>\r\n                            <div className='section'>\r\n                                <b>languages</b> {this.props.combatant.languages || '-'}\r\n                            </div>\r\n                            <div className='section'>\r\n                                <b>equipment</b> {this.props.combatant.equipment || '-'}\r\n                            </div>\r\n                        </div>\r\n                    );\r\n                }\r\n                if (this.props.mode.indexOf('abilities') !== -1) {\r\n                    stats = (\r\n                        <div>\r\n                            <div className='section'>\r\n                                <AbilityScorePanel combatant={this.props.combatant} />\r\n                            </div>\r\n                            <div className='section'>\r\n                                <b>saving throws</b> {this.props.combatant.savingThrows || '-'}\r\n                            </div>\r\n                            <div className='section'>\r\n                                <b>skills</b> {this.props.combatant.skills || '-'}\r\n                            </div>\r\n                        </div>\r\n                    );\r\n                }\r\n                if (this.props.mode.indexOf('cbt-stats') !== -1) {\r\n                    stats = (\r\n                        <div>\r\n                            <div className='section'>\r\n                                <b>ac</b> {this.props.combatant.ac}\r\n                            </div>\r\n                            <div className='section'>\r\n                                <b>hp</b> {this.getHP()}\r\n                            </div>\r\n                            <div className='section'>\r\n                                <b>damage immunity</b> {this.props.combatant.damage.immune || '-'}\r\n                            </div>\r\n                            <div className='section'>\r\n                                <b>damage resistance</b> {this.props.combatant.damage.resist || '-'}\r\n                            </div>\r\n                            <div className='section'>\r\n                                <b>damage vulnerability</b> {this.props.combatant.damage.vulnerable || '-'}\r\n                            </div>\r\n                            <div className='section'>\r\n                                <b>condition immunities</b> {this.props.combatant.conditionImmunities || '-'}\r\n                            </div>\r\n                        </div>\r\n                    );\r\n                }\r\n                if (this.props.mode.indexOf('actions') !== -1) {\r\n                    stats = (\r\n                        <TraitsPanel\r\n                            combatant={this.props.combatant}\r\n                            mode='template'\r\n                            copyTrait={trait => this.props.copyTrait(trait)}\r\n                        />\r\n                    );\r\n                }\r\n            }\r\n\r\n            let toggle = null;\r\n            if (this.props.mode.indexOf('combat') !== -1) {\r\n                // Don't show toggle button for combatant\r\n            } else if (this.props.mode.indexOf('template') !== -1) {\r\n                // Don't show toggle button for template\r\n            } else {\r\n                const imageStyle = this.state.showDetails ? 'image rotate' : 'image';\r\n                toggle = (\r\n                    <img className={imageStyle} src={arrow} alt='arrow' onClick={() => this.toggleDetails()} />\r\n                );\r\n            }\r\n\r\n            const name = (this.props.combatant as Combatant ? (this.props.combatant as Combatant).displayName : null)\r\n                || this.props.combatant.name\r\n                || 'unnamed monster';\r\n\r\n            return (\r\n                <div className='card monster'>\r\n                    <div className='heading'>\r\n                        <div className='title'>{name}</div>\r\n                        {toggle}\r\n                    </div>\r\n                    <div className='card-content'>\r\n                        {stats}\r\n                        <div style={{ display: options.length > 0 ? '' : 'none' }}>\r\n                            <div className='divider' />\r\n                            <div className='section'>{options}</div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            );\r\n        } catch (e) {\r\n            console.error(e);\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport { Combatant } from '../../models/combat';\r\nimport { PC } from '../../models/party';\r\n\r\nimport ConfirmButton from '../controls/confirm-button';\r\nimport Expander from '../controls/expander';\r\nimport Radial from '../controls/radial';\r\nimport Spin from '../controls/spin';\r\n\r\nimport arrow from '../../resources/images/down-arrow.svg';\r\n\r\ninterface Props {\r\n    combatant: PC | (PC & Combatant);\r\n    mode: string;\r\n    changeValue: (pc: PC, field: string, value: any) => void;\r\n    nudgeValue: (pc: PC, field: string, delta: number) => void;\r\n    removePC: (pc: PC) => void;\r\n    // Combat\r\n    makeCurrent: (combatant: Combatant) => void;\r\n    makeActive: (combatant: Combatant) => void;\r\n    makeDefeated: (combatant: Combatant) => void;\r\n    endTurn: (combatant: Combatant) => void;\r\n    mapAdd: (combatant: Combatant) => void;\r\n    mapMove: (combatant: Combatant, dir: string) => void;\r\n    mapRemove: (combatant: Combatant) => void;\r\n    removeCombatant: (combatant: Combatant) => void;\r\n}\r\n\r\ninterface State {\r\n    showDetails: boolean;\r\n}\r\n\r\nexport default class PCCard extends React.Component<Props, State> {\r\n    public static defaultProps = {\r\n        removePC: null,\r\n        makeCurrent: null,\r\n        makeActive: null,\r\n        makeDefeated: null,\r\n        endTurn: null,\r\n        mapAdd: null,\r\n        mapMove: null,\r\n        mapRemove: null,\r\n        removeCombatant: null\r\n    };\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n        this.state = {\r\n            showDetails: false\r\n        };\r\n    }\r\n\r\n    private toggleDetails() {\r\n        this.setState({\r\n            showDetails: !this.state.showDetails\r\n        });\r\n    }\r\n\r\n    public render() {\r\n        try {\r\n            const options = [];\r\n            if (this.props.mode.indexOf('edit') !== -1) {\r\n                if (this.props.combatant.active) {\r\n                    options.push(\r\n                        <button key='toggle-active' onClick={() => this.props.changeValue(this.props.combatant, 'active', false)}>\r\n                            mark inactive\r\n                        </button>\r\n                    );\r\n                } else {\r\n                    options.push(\r\n                        <button key='toggle-active' onClick={() => this.props.changeValue(this.props.combatant, 'active', true)}>\r\n                            mark active\r\n                        </button>\r\n                    );\r\n                }\r\n                options.push(<ConfirmButton key='remove' text='delete pc' callback={() => this.props.removePC(this.props.combatant)} />);\r\n            }\r\n            if (this.props.mode.indexOf('combat') !== -1) {\r\n                const combatant = this.props.combatant as Combatant;\r\n\r\n                if (this.props.mode.indexOf('tactical') !== -1) {\r\n                    if (this.props.mode.indexOf('on-map') !== -1) {\r\n                        options.push(\r\n                            <div key='mapMove' className='section centered'>\r\n                                <Radial\r\n                                    direction='eight'\r\n                                    click={dir => this.props.mapMove(combatant, dir)}\r\n                                />\r\n                            </div>\r\n                        );\r\n                        options.push(\r\n                            <Spin\r\n                                key='altitude'\r\n                                source={this.props.combatant}\r\n                                name='altitude'\r\n                                label='altitude'\r\n                                display={value => value + ' ft.'}\r\n                                nudgeValue={delta => this.props.nudgeValue(this.props.combatant, 'altitude', delta * 5)}\r\n                            />\r\n                        );\r\n                        options.push(<button key='mapRemove' onClick={() => this.props.mapRemove(combatant)}>remove from map</button>);\r\n                    }\r\n                    if (this.props.mode.indexOf('off-map') !== -1) {\r\n                        options.push(<button key='mapAdd' onClick={() => this.props.mapAdd(combatant)}>add to map</button>);\r\n                    }\r\n                    options.push(<div key='tactical-div' className='divider' />);\r\n                }\r\n                if (combatant.pending && !combatant.active && !combatant.defeated) {\r\n                    options.push(<ConfirmButton key='remove' text='remove from encounter' callback={() => this.props.removeCombatant(combatant)} />);\r\n                }\r\n                if (!combatant.pending && combatant.active && !combatant.defeated) {\r\n                    if (combatant.current) {\r\n                        options.push(<button key='endTurn' onClick={() => this.props.endTurn(combatant)}>end turn</button>);\r\n                        options.push(<button key='makeDefeated' onClick={() => this.props.makeDefeated(combatant)}>mark as defeated and end turn</button>);\r\n                    } else {\r\n                        options.push(<button key='makeCurrent' onClick={() => this.props.makeCurrent(combatant)}>start turn</button>);\r\n                        options.push(<button key='makeDefeated' onClick={() => this.props.makeDefeated(combatant)}>mark as defeated</button>);\r\n                        options.push(<ConfirmButton key='remove' text='remove from encounter' callback={() => this.props.removeCombatant(combatant)} />);\r\n                    }\r\n                    options.push(\r\n                        <Expander\r\n                            key='init'\r\n                            text='change initiative score'\r\n                            content={(\r\n                                <div>\r\n                                    <Spin\r\n                                        source={this.props.combatant}\r\n                                        name='initiative'\r\n                                        label='initiative'\r\n                                        nudgeValue={delta => this.props.nudgeValue(this.props.combatant, 'initiative', delta)}\r\n                                    />\r\n                                </div>\r\n                            )}\r\n                        />\r\n                    );\r\n                }\r\n                if (!combatant.pending && !combatant.active && combatant.defeated) {\r\n                    options.push(<button key='makeActive' onClick={() => this.props.makeActive(combatant)}>mark as active</button>);\r\n                    options.push(<ConfirmButton key='remove' text='remove from encounter' callback={() => this.props.removeCombatant(combatant)} />);\r\n                }\r\n            }\r\n\r\n            const desc = (this.props.combatant.race || 'unknown race')\r\n                + ' ' + (this.props.combatant.classes || 'unknown class')\r\n                + ', level ' + this.props.combatant.level;\r\n\r\n            const commonStatBlock = (\r\n                <div className='stats'>\r\n                    <div className='section centered lowercase'>\r\n                        <i>{desc}</i>\r\n                        <div style={{ display: this.props.combatant.url ? '' : 'none' }}>\r\n                            <a href={this.props.combatant.url} target='_blank' rel='noopener noreferrer'>d&d beyond sheet</a>\r\n                        </div>\r\n                    </div>\r\n                    <div className='divider' />\r\n                    <div className='section subheading'>languages</div>\r\n                    <div className='section'>\r\n                        {this.props.combatant.languages || '-'}\r\n                    </div>\r\n                    <div className='section subheading'>passive skills</div>\r\n                    <div className='section'>\r\n                        <div><b>insight</b> {this.props.combatant.passiveInsight}</div>\r\n                        <div><b>investigation</b> {this.props.combatant.passiveInvestigation}</div>\r\n                        <div><b>perception</b> {this.props.combatant.passivePerception}</div>\r\n                    </div>\r\n                </div>\r\n            );\r\n\r\n            let stats = null;\r\n            if (this.props.mode.indexOf('edit') !== -1) {\r\n                if (this.state.showDetails) {\r\n                    stats = (\r\n                        <div className='edit'>\r\n                            <div className='section'>\r\n                                <div className='input-label' style={{ display: this.state.showDetails ? '' : 'none' }}>character name:</div>\r\n                                <input\r\n                                    type='text'\r\n                                    value={this.props.combatant.name}\r\n                                    onChange={event => this.props.changeValue(this.props.combatant, 'name', event.target.value)}\r\n                                />\r\n                                <div className='input-label' style={{ display: this.state.showDetails ? '' : 'none' }}>player name:</div>\r\n                                <input\r\n                                    type='text'\r\n                                    value={this.props.combatant.player}\r\n                                    onChange={event => this.props.changeValue(this.props.combatant, 'player', event.target.value)}\r\n                                />\r\n                                <div className='input-label'>race:</div>\r\n                                <input\r\n                                    type='text'\r\n                                    value={this.props.combatant.race}\r\n                                    onChange={event => this.props.changeValue(this.props.combatant, 'race', event.target.value)}\r\n                                />\r\n                                <div className='input-label'>class:</div>\r\n                                <input\r\n                                    type='text'\r\n                                    value={this.props.combatant.classes}\r\n                                    onChange={event => this.props.changeValue(this.props.combatant, 'classes', event.target.value)}\r\n                                />\r\n                                <div className='input-label'>level:</div>\r\n                                <Spin\r\n                                    source={this.props.combatant}\r\n                                    name='level'\r\n                                    nudgeValue={delta => this.props.nudgeValue(this.props.combatant, 'level', delta)}\r\n                                />\r\n                                <div className='input-label'>languages:</div>\r\n                                <input\r\n                                    type='text'\r\n                                    value={this.props.combatant.languages}\r\n                                    onChange={event => this.props.changeValue(this.props.combatant, 'languages', event.target.value)}\r\n                                />\r\n                                <div className='input-label'>d&d beyond link:</div>\r\n                                <input\r\n                                    type='text'\r\n                                    value={this.props.combatant.url}\r\n                                    onChange={event => this.props.changeValue(this.props.combatant, 'url', event.target.value)}\r\n                                />\r\n                            </div>\r\n                            <div className='divider' />\r\n                            <div className='section subheading'>passive skills</div>\r\n                            <Spin\r\n                                source={this.props.combatant}\r\n                                name='passiveInsight'\r\n                                label='insight'\r\n                                nudgeValue={delta => this.props.nudgeValue(this.props.combatant, 'passiveInsight', delta)}\r\n                            />\r\n                            <Spin\r\n                                source={this.props.combatant}\r\n                                name='passiveInvestigation'\r\n                                label='investigation'\r\n                                nudgeValue={delta => this.props.nudgeValue(this.props.combatant, 'passiveInvestigation', delta)}\r\n                            />\r\n                            <Spin\r\n                                source={this.props.combatant}\r\n                                name='passivePerception'\r\n                                label='perception'\r\n                                nudgeValue={delta => this.props.nudgeValue(this.props.combatant, 'passivePerception', delta)}\r\n                            />\r\n                        </div>\r\n                    );\r\n                } else {\r\n                    stats = commonStatBlock;\r\n                }\r\n            }\r\n            if (this.props.mode.indexOf('combat') !== -1) {\r\n                stats = commonStatBlock;\r\n            }\r\n\r\n            let toggle = null;\r\n            if (this.props.mode.indexOf('combat') !== -1) {\r\n                // Don't show toggle button for combatant\r\n            } else {\r\n                const imageStyle = this.state.showDetails ? 'image rotate' : 'image';\r\n                toggle = <img className={imageStyle} src={arrow} alt='arrow' onClick={() => this.toggleDetails()} />;\r\n            }\r\n\r\n            const name = (this.props.combatant as Combatant ? (this.props.combatant as Combatant).displayName : null)\r\n                || this.props.combatant.name\r\n                || 'unnamed pc';\r\n\r\n            return (\r\n                <div className='card pc'>\r\n                    <div className='heading'>\r\n                        <div className='title'>{name}</div>\r\n                        {toggle}\r\n                    </div>\r\n                    <div className='card-content'>\r\n                        {stats}\r\n                        <div style={{ display: options.length > 0 ? '' : 'none' }}>\r\n                            <div className='divider' />\r\n                            <div className='section'>\r\n                                {options}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            );\r\n        } catch (e) {\r\n            console.error(e);\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport { Combatant } from '../../models/combat';\r\nimport { Monster } from '../../models/monster-group';\r\n\r\ninterface Props {\r\n    combatant: Combatant & Monster;\r\n}\r\n\r\nexport default class HitPointGauge extends React.Component<Props> {\r\n    public render() {\r\n        try {\r\n            const hpCurrent = this.props.combatant.hp || 0;\r\n            const hpMax = this.props.combatant.hpMax + this.props.combatant.hpTemp;\r\n            const hpBloodied = this.props.combatant.hpMax / 2;\r\n            const hpWidth = 100 * Math.max(hpCurrent, 0) / hpMax;\r\n\r\n            let style = '';\r\n            if (hpCurrent >= this.props.combatant.hpMax) {\r\n                style = 'bar unhurt';\r\n            } else if (hpCurrent <= hpBloodied) {\r\n                style = 'bar bloodied';\r\n            } else {\r\n                style = 'bar injured';\r\n            }\r\n\r\n            let hpTempBar = null;\r\n            if (this.props.combatant.hpTemp > 0) {\r\n                const hpTempWidth = 100 * Math.max(this.props.combatant.hpTemp, 0) / hpMax;\r\n                hpTempBar = <div className='bar temp' style={{ width: hpTempWidth + '%' }} />;\r\n            }\r\n\r\n            return (\r\n                <div className='hp-gauge'>\r\n                    <div className={style} style={{ width: hpWidth + '%' }} />\r\n                    {hpTempBar}\r\n                </div>\r\n            );\r\n        } catch (e) {\r\n            console.error(e);\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport { Combatant } from '../../models/combat';\r\nimport { Map, MapItem } from '../../models/map-folio';\r\nimport { Monster } from '../../models/monster-group';\r\nimport { PC } from '../../models/party';\r\n\r\nimport HitPointGauge from './hit-point-gauge';\r\n\r\ninterface Props {\r\n    map: Map;\r\n    mode: 'edit' | 'thumbnail' | 'combat';\r\n    combatants: ((Combatant & PC) | (Combatant & Monster))[];\r\n    showOverlay: boolean;\r\n    selectedItemID: string;\r\n    setSelectedItemID: (itemID: string | null) => void;\r\n    addMapTile: (x: number, y: number) => void;\r\n    gridSquareClicked: (x: number, y: number) => void;\r\n}\r\n\r\ninterface MapDimensions {\r\n    minX: number;\r\n    maxX: number;\r\n    minY: number;\r\n    maxY: number;\r\n    width: number;\r\n    height: number;\r\n}\r\n\r\ninterface StyleData {\r\n    left: string;\r\n    top: string;\r\n    width: string;\r\n    height: string;\r\n}\r\n\r\nexport default class MapPanel extends React.Component<Props> {\r\n    public static defaultProps = {\r\n        combatants: null,\r\n        showOverlay: false,\r\n        selectedItemID: null,\r\n        setSelectedItemID: null,\r\n        addMapTile: null,\r\n        gridSquareClicked: null\r\n    };\r\n\r\n    private getMapDimensions(border: number): MapDimensions | null {\r\n        let dimensions: MapDimensions | null = null;\r\n\r\n        this.props.map.items.filter(i => {\r\n            if (this.props.mode === 'edit') {\r\n                return i.type === 'tile';\r\n            }\r\n            return true;\r\n        }).forEach(i => {\r\n            if (!dimensions) {\r\n                dimensions = {\r\n                    minX: i.x,\r\n                    maxX: i.x + i.width - 1,\r\n                    minY: i.y,\r\n                    maxY: i.y + i.height - 1,\r\n                    width: 0,\r\n                    height: 0\r\n                };\r\n            } else {\r\n                dimensions.minX = Math.min(dimensions.minX, i.x);\r\n                dimensions.maxX = Math.max(dimensions.maxX, i.x + i.width - 1);\r\n                dimensions.minY = Math.min(dimensions.minY, i.y);\r\n                dimensions.maxY = Math.max(dimensions.maxY, i.y + i.height - 1);\r\n            }\r\n        });\r\n\r\n        if (!dimensions) {\r\n            // The map is blank\r\n            if (this.props.mode === 'thumbnail') {\r\n                return null;\r\n            }\r\n\r\n            dimensions = {\r\n                minX: 0,\r\n                maxX: 0,\r\n                minY: 0,\r\n                maxY: 0,\r\n                width: 0,\r\n                height: 0\r\n            };\r\n        }\r\n\r\n        // Apply the border\r\n        dimensions.minX -= border;\r\n        dimensions.maxX += border;\r\n        dimensions.minY -= border;\r\n        dimensions.maxY += border;\r\n\r\n        // Set width and height\r\n        dimensions.width = 1 + dimensions.maxX - dimensions.minX;\r\n        dimensions.height = 1 + dimensions.maxY - dimensions.minY;\r\n\r\n        return dimensions;\r\n    }\r\n\r\n    private getSideLength(): number {\r\n        switch (this.props.mode) {\r\n            case 'thumbnail':\r\n                return 5;\r\n            case 'edit':\r\n            case 'combat':\r\n                return 25;\r\n            default:\r\n                return 5;\r\n        }\r\n    }\r\n\r\n    private getStyle(x: number, y: number, width: number, height: number, mapDimensions: MapDimensions): StyleData {\r\n        const sideLength = this.getSideLength();\r\n\r\n        return {\r\n            left: 'calc(' + sideLength + 'px * ' + (x - mapDimensions.minX) + ')',\r\n            top: 'calc(' + sideLength + 'px * ' + (y - mapDimensions.minY) + ')',\r\n            width: 'calc((' + sideLength + 'px * ' + width + ') + 1px)',\r\n            height: 'calc((' + sideLength + 'px * ' + height + ') + 1px)'\r\n        };\r\n    }\r\n\r\n    public render() {\r\n        try {\r\n            const border = (this.props.mode === 'edit') ? 2 : 0;\r\n            const mapDimensions = this.getMapDimensions(border);\r\n            if (!mapDimensions) {\r\n                return (\r\n                    <div>(blank map)</div>\r\n                );\r\n            }\r\n\r\n            // Draw the grid squares\r\n            const grid = [];\r\n            if (this.props.mode === 'edit') {\r\n                for (let y = mapDimensions.minY; y !== mapDimensions.maxY + 1; ++y) {\r\n                    for (let x = mapDimensions.minX; x !== mapDimensions.maxX + 1; ++x) {\r\n                        const gridStyle = this.getStyle(x, y, 1, 1, mapDimensions);\r\n                        grid.push(\r\n                            <GridSquare\r\n                                key={x + ',' + y}\r\n                                x={x}\r\n                                y={y}\r\n                                style={gridStyle}\r\n                                onClick={() => this.props.setSelectedItemID(null)}\r\n                                onDoubleClick={(posX, posY) => this.props.addMapTile(posX, posY)}\r\n                            />\r\n                        );\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Draw the map tiles\r\n            const tiles = this.props.map.items\r\n                .filter(i => i.type === 'tile')\r\n                .map(i => {\r\n                    const tileStyle = this.getStyle(i.x, i.y, i.width, i.height, mapDimensions as MapDimensions);\r\n                    return (\r\n                        <MapTile\r\n                            key={i.id}\r\n                            tile={i}\r\n                            style={tileStyle}\r\n                            selectable={this.props.mode === 'edit'}\r\n                            selected={this.props.selectedItemID === i.id}\r\n                            thumbnail={this.props.mode === 'thumbnail'}\r\n                            select={id => this.props.mode === 'edit' ? this.props.setSelectedItemID(id) : null}\r\n                        />\r\n                    );\r\n                });\r\n\r\n            // Draw the tokens\r\n            let tokens: JSX.Element[] = [];\r\n            if (this.props.mode !== 'edit') {\r\n                tokens = this.props.map.items\r\n                    .filter(i => (i.type === 'monster') || (i.type === 'pc'))\r\n                    .map(i => {\r\n                        const tokenStyle = this.getStyle(i.x, i.y, i.width, i.height, mapDimensions as MapDimensions);\r\n                        const combatant = this.props.combatants.find(c => c.id === i.id);\r\n                        if (combatant) {\r\n                            return (\r\n                                <MapToken\r\n                                    key={i.id}\r\n                                    token={i}\r\n                                    combatant={combatant}\r\n                                    style={tokenStyle}\r\n                                    simple={this.props.mode === 'thumbnail'}\r\n                                    selectable={this.props.mode === 'combat'}\r\n                                    selected={this.props.selectedItemID ===  i.id}\r\n                                    select={id => this.props.setSelectedItemID(id)}\r\n                                />\r\n                            );\r\n                        }\r\n\r\n                        return null;\r\n                    })\r\n                    .filter(mt => mt !== null) as JSX.Element[];\r\n            }\r\n\r\n            // Draw the drag overlay\r\n            const dragOverlay = [];\r\n            if (this.props.showOverlay) {\r\n                for (let yOver = mapDimensions.minY; yOver !== mapDimensions.maxY + 1; ++yOver) {\r\n                    for (let xOver = mapDimensions.minX; xOver !== mapDimensions.maxX + 1; ++xOver) {\r\n                        const overlayStyle = this.getStyle(xOver, yOver, 1, 1, mapDimensions);\r\n                        dragOverlay.push(\r\n                            <GridSquare\r\n                                key={xOver + ',' + yOver}\r\n                                x={xOver}\r\n                                y={yOver}\r\n                                style={overlayStyle}\r\n                                overlay={true}\r\n                                onClick={(posX, posY) => this.props.gridSquareClicked(posX, posY)}\r\n                            />\r\n                        );\r\n                    }\r\n                }\r\n            }\r\n\r\n            const style = 'map-panel ' + this.props.mode;\r\n            return (\r\n                <div className={style} onClick={() => this.props.setSelectedItemID(null)}>\r\n                    <div className='grid' style={{ height: ((this.getSideLength() * mapDimensions.height) + 1) + 'px' }}>\r\n                        {grid}\r\n                        {tiles}\r\n                        {tokens}\r\n                        {dragOverlay}\r\n                    </div>\r\n                </div>\r\n            );\r\n        } catch (e) {\r\n            console.error(e);\r\n        }\r\n    }\r\n}\r\n\r\ninterface GridSquareProps {\r\n    x: number;\r\n    y: number;\r\n    style: StyleData;\r\n    overlay: boolean;\r\n    onClick: (x: number, y: number) => void;\r\n    onDoubleClick: (x: number, y: number) => void;\r\n}\r\n\r\nclass GridSquare extends React.Component<GridSquareProps> {\r\n    public static defaultProps = {\r\n        overlay: false,\r\n        onDoubleClick: null\r\n    };\r\n\r\n    private click(e: React.MouseEvent) {\r\n        e.stopPropagation();\r\n        if (this.props.onClick) {\r\n            this.props.onClick(this.props.x, this.props.y);\r\n        }\r\n    }\r\n\r\n    private doubleClick(e: React.MouseEvent) {\r\n        e.stopPropagation();\r\n        if (this.props.onDoubleClick) {\r\n            this.props.onDoubleClick(this.props.x, this.props.y);\r\n        }\r\n    }\r\n\r\n    public render() {\r\n        let style = 'grid-square';\r\n        if (this.props.overlay) {\r\n            style += ' grid-overlay';\r\n        }\r\n\r\n        return (\r\n            <div\r\n                className={style}\r\n                style={this.props.style}\r\n                onClick={e => this.click(e)}\r\n                onDoubleClick={e => this.doubleClick(e)}\r\n            />\r\n        );\r\n    }\r\n}\r\n\r\ninterface MapTileProps {\r\n    tile: MapItem;\r\n    style: StyleData;\r\n    thumbnail: boolean;\r\n    selectable: boolean;\r\n    selected: boolean;\r\n    select: (tileID: string) => void;\r\n}\r\n\r\nclass MapTile extends React.Component<MapTileProps> {\r\n    private select(e: React.MouseEvent) {\r\n        if (this.props.selectable) {\r\n            e.stopPropagation();\r\n            this.props.select(this.props.tile.id);\r\n        }\r\n    }\r\n\r\n    public render() {\r\n        let style = 'tile ' + this.props.tile.terrain;\r\n        if (this.props.selected) {\r\n            style += ' selected';\r\n        }\r\n        if (this.props.thumbnail) {\r\n            style += ' thumbnail';\r\n        }\r\n\r\n        return (\r\n            <div\r\n                className={style}\r\n                style={this.props.style}\r\n                onClick={e => this.select(e)}\r\n            />\r\n        );\r\n    }\r\n}\r\n\r\ninterface MapTokenProps {\r\n    token: MapItem;\r\n    combatant: (Combatant & PC) | (Combatant & Monster);\r\n    style: StyleData;\r\n    simple: boolean;\r\n    selectable: boolean;\r\n    selected: boolean;\r\n    select: (tokenID: string) => void;\r\n}\r\n\r\nclass MapToken extends React.Component<MapTokenProps> {\r\n    private select(e: React.MouseEvent) {\r\n        if (this.props.selectable) {\r\n            e.stopPropagation();\r\n            this.props.select(this.props.token.id);\r\n        }\r\n    }\r\n\r\n    public render() {\r\n        let style = 'token ' + this.props.token.type;\r\n        if (this.props.selected) {\r\n            style += ' selected';\r\n        }\r\n        if (this.props.combatant.current) {\r\n            style += ' current';\r\n        }\r\n\r\n        let initials = null;\r\n        let hpGauge = null;\r\n        let altitudeBadge = null;\r\n        let conditionsBadge = null;\r\n        if (!this.props.simple) {\r\n            const name = this.props.combatant.displayName || this.props.combatant.name;\r\n            initials = (\r\n                <div className='initials'>{name.split(' ').map(s => s[0])}</div>\r\n            );\r\n\r\n            if (this.props.combatant.type === 'monster') {\r\n                hpGauge = (\r\n                    <HitPointGauge combatant={this.props.combatant as Combatant & Monster} />\r\n                );\r\n            }\r\n\r\n            if (this.props.combatant.altitude > 0) {\r\n                altitudeBadge = (\r\n                    <div className='badge altitude'>&#9206;</div>\r\n                );\r\n            }\r\n\r\n            if (this.props.combatant.altitude < 0) {\r\n                altitudeBadge = (\r\n                    <div className='badge altitude'>&#9207;</div>\r\n                );\r\n            }\r\n\r\n            if ((this.props.combatant.conditions) && (this.props.combatant.conditions.length > 0)) {\r\n                conditionsBadge = (\r\n                    <div className='badge'>&#9670;</div>\r\n                );\r\n            }\r\n        }\r\n\r\n        return (\r\n            <div\r\n                title={this.props.combatant.displayName || this.props.combatant.name}\r\n                className={style}\r\n                style={this.props.style}\r\n                onClick={e => this.select(e)}\r\n            >\r\n                {initials}\r\n                {hpGauge}\r\n                {altitudeBadge}\r\n                {conditionsBadge}\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport { Combat } from '../../models/combat';\r\n\r\nimport MapPanel from '../panels/map-panel';\r\n\r\ninterface Props {\r\n    combat: Combat;\r\n    selected: boolean;\r\n    setSelection: (combat: Combat) => void;\r\n}\r\n\r\nexport default class CombatListItem extends React.Component<Props> {\r\n    public render() {\r\n        try {\r\n            let map = null;\r\n            if (this.props.combat.map) {\r\n                map = (\r\n                    <MapPanel\r\n                        map={this.props.combat.map}\r\n                        mode='thumbnail'\r\n                        combatants={this.props.combat.combatants}\r\n                    />\r\n                );\r\n            }\r\n\r\n            return (\r\n                <div className={this.props.selected ? 'list-item selected' : 'list-item'} onClick={() => this.props.setSelection(this.props.combat)}>\r\n                    <div className='heading'>{this.props.combat.name || 'unnamed combat'}</div>\r\n                    <div className='text'>paused at {this.props.combat.timestamp}</div>\r\n                    {map}\r\n                </div>\r\n            );\r\n        } catch (e) {\r\n            console.error(e);\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport close from '../../resources/images/close-black.svg';\r\nimport arrow from '../../resources/images/down-arrow-black.svg';\r\n\r\ninterface Props {\r\n    content: any[];\r\n    heading: string;\r\n    hidden: boolean;\r\n    showClose: boolean;\r\n    showToggle: boolean;\r\n    close: () => void;\r\n}\r\n\r\ninterface State {\r\n    showCards: boolean;\r\n}\r\n\r\nexport default class CardGroup extends React.Component<Props, State> {\r\n    public static defaultProps = {\r\n        heading: null,\r\n        hidden: false,\r\n        showClose: false,\r\n        showToggle: false,\r\n        close: null\r\n    };\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            showCards: true\r\n        };\r\n    }\r\n\r\n    private toggleCards() {\r\n        this.setState({\r\n            showCards: !this.state.showCards\r\n        });\r\n    }\r\n\r\n    public render() {\r\n        try {\r\n            if (this.props.hidden) {\r\n                return null;\r\n            }\r\n\r\n            let heading = null;\r\n            if (this.props.heading) {\r\n                let closeBtn = null;\r\n                if (this.props.showClose) {\r\n                    closeBtn = (\r\n                        <img className='image' src={close} alt='close' onClick={() => this.props.close()} />\r\n                    );\r\n                }\r\n\r\n                let toggle = null;\r\n                if (this.props.showToggle) {\r\n                    const style = this.state.showCards ? 'image rotate' : 'image';\r\n                    toggle = (\r\n                        <img className={style} src={arrow} alt='arrow' onClick={() => this.toggleCards()} />\r\n                    );\r\n                }\r\n\r\n                heading = (\r\n                    <div className='heading'>\r\n                        <div className='title'>{this.props.heading}</div>\r\n                        {toggle}\r\n                        {closeBtn}\r\n                    </div>\r\n                );\r\n            }\r\n\r\n            let cards = [];\r\n            if ((this.props.content.length > 0) && this.state.showCards) {\r\n                cards = this.props.content;\r\n            }\r\n\r\n            return (\r\n                <div className='card-group'>\r\n                    {heading}\r\n                    <div className='row small-up-1 medium-up-2 large-up-4 collapse'>\r\n                        {cards}\r\n                    </div>\r\n                </div>\r\n            );\r\n        } catch (e) {\r\n            console.error(e);\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport Utils from '../../utils/utils';\r\n\r\nimport { Combat, Combatant, Notification } from '../../models/combat';\r\nimport { Condition, ConditionDurationSaves } from '../../models/condition';\r\nimport { Monster, Trait } from '../../models/monster-group';\r\nimport { PC } from '../../models/party';\r\n\r\nimport InfoCard from '../cards/info-card';\r\nimport CombatManagerCard from '../cards/information/combat-manager-card';\r\nimport MonsterCard from '../cards/monster-card';\r\nimport PCCard from '../cards/pc-card';\r\nimport Spin from '../controls/spin';\r\nimport CombatListItem from '../list-items/combat-list-item';\r\nimport CardGroup from '../panels/card-group';\r\nimport HitPointGauge from '../panels/hit-point-gauge';\r\nimport MapPanel from '../panels/map-panel';\r\n\r\ninterface Props {\r\n    combats: Combat[];\r\n    combat: Combat | null;\r\n    showHelp: boolean;\r\n    createCombat: () => void;\r\n    resumeEncounter: (combat: Combat) => void;\r\n    close: (notification: Notification, removeCondition: boolean) => void;\r\n    mapAdd: (combatant: (Combatant & PC) | (Combatant & Monster), x: number, y: number) => void;\r\n    makeCurrent: (combatant: (Combatant & PC) | (Combatant & Monster)) => void;\r\n    makeActive: (combatant: (Combatant & PC) | (Combatant & Monster)) => void;\r\n    makeDefeated: (combatant: (Combatant & PC) | (Combatant & Monster)) => void;\r\n    removeCombatant: (combatant: (Combatant & PC) | (Combatant & Monster)) => void;\r\n    addCondition: (combatant: Combatant & Monster) => void;\r\n    editCondition: (combatant: Combatant & Monster, condition: Condition) => void;\r\n    removeCondition: (combatant: Combatant & Monster, conditionID: string) => void;\r\n    mapMove: (combatant: (Combatant & PC) | (Combatant & Monster), dir: string) => void;\r\n    mapRemove: (combatant: (Combatant & PC) | (Combatant & Monster)) => void;\r\n    endTurn: (combatant: (Combatant & PC) | (Combatant & Monster)) => void;\r\n    changeHP: (combatant: Combatant & Monster, hp: number, temp: number) => void;\r\n    changeValue: (source: {}, type: string, value: any) => void;\r\n    nudgeValue: (source: {}, type: string, delta: number) => void;\r\n}\r\n\r\ninterface State {\r\n    selectedTokenID: string | null;\r\n    addingToMapID: string | null;\r\n}\r\n\r\nexport default class CombatManagerScreen extends React.Component<Props, State> {\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            selectedTokenID: null,  // The ID of the combatant that's selected\r\n            addingToMapID: null     // The ID of the combatant we're adding to the map\r\n        };\r\n    }\r\n\r\n    private setSelectedTokenID(id: string | null) {\r\n        this.setState({\r\n            selectedTokenID: id\r\n        });\r\n    }\r\n\r\n    private setAddingToMapID(id: string | null) {\r\n        this.setState({\r\n            addingToMapID: id\r\n        });\r\n    }\r\n\r\n    private createCard(combatant: (Combatant & PC) | (Combatant & Monster)) {\r\n        let mode = 'combat';\r\n        if (this.props.combat && this.props.combat.map) {\r\n            mode += ' tactical';\r\n            const onMap = this.props.combat.map.items.find(i => i.id === combatant.id);\r\n            mode += onMap ? ' on-map' : ' off-map';\r\n        }\r\n\r\n        switch (combatant.type) {\r\n            case 'pc':\r\n                return (\r\n                    <PCCard\r\n                        key='selected'\r\n                        combatant={combatant as Combatant & PC}\r\n                        mode={mode}\r\n                        changeValue={(source, type, value) => this.props.changeValue(source, type, value)}\r\n                        nudgeValue={(source, type, delta) => this.props.nudgeValue(source, type, delta)}\r\n                        makeCurrent={c => this.props.makeCurrent(c as Combatant & PC)}\r\n                        makeActive={c => this.props.makeActive(c as Combatant & PC)}\r\n                        makeDefeated={c => this.props.makeDefeated(c as Combatant & PC)}\r\n                        removeCombatant={c => this.props.removeCombatant(c as Combatant & PC)}\r\n                        mapAdd={c => this.setAddingToMapID(c.id)}\r\n                        mapMove={(c, dir) => this.props.mapMove(c as Combatant & PC, dir)}\r\n                        mapRemove={c => this.props.mapRemove(c as Combatant & PC)}\r\n                        endTurn={c => this.props.endTurn(c as Combatant & PC)}\r\n                    />\r\n                );\r\n            case 'monster':\r\n                return (\r\n                    <MonsterCard\r\n                        key='selected'\r\n                        combatant={combatant as Combatant & Monster}\r\n                        mode={mode}\r\n                        combat={this.props.combat as Combat}\r\n                        changeValue={(c, type, value) => this.props.changeValue(c, type, value)}\r\n                        nudgeValue={(c, type, delta) => this.props.nudgeValue(c, type, delta)}\r\n                        makeCurrent={c => this.props.makeCurrent(c as Combatant & Monster)}\r\n                        makeActive={c => this.props.makeActive(c as Combatant & Monster)}\r\n                        makeDefeated={c => this.props.makeDefeated(c as Combatant & Monster)}\r\n                        removeCombatant={c => this.props.removeCombatant(c as Combatant & Monster)}\r\n                        addCondition={c => this.props.addCondition(c as Combatant & Monster)}\r\n                        editCondition={(c, condition) => this.props.editCondition(c as Combatant & Monster, condition)}\r\n                        removeCondition={(c, conditionID) => this.props.removeCondition(c as Combatant & Monster, conditionID)}\r\n                        nudgeConditionValue={(c, type, delta) => this.props.nudgeValue(c, type, delta)}\r\n                        mapAdd={c => this.setAddingToMapID(c.id)}\r\n                        mapMove={(c, dir) => this.props.mapMove(c as Combatant & Monster, dir)}\r\n                        mapRemove={c => this.props.mapRemove(c as Combatant & Monster)}\r\n                        endTurn={(c) => this.props.endTurn(c as Combatant & Monster)}\r\n                        changeHP={(c, hp, temp) => this.props.changeHP(c as Combatant & Monster, hp, temp)}\r\n                    />\r\n                );\r\n            default:\r\n                return null;\r\n        }\r\n    }\r\n\r\n    private addCombatantToMap(x: number, y: number) {\r\n        if (this.props.combat) {\r\n            const combatant = this.props.combat.combatants.find(c => c.id === this.state.addingToMapID);\r\n            if (combatant) {\r\n                this.props.mapAdd(combatant, x, y);\r\n            }\r\n            this.setAddingToMapID(null);\r\n        }\r\n    }\r\n\r\n    public render() {\r\n        try {\r\n            if (this.props.combat) {\r\n                const current: JSX.Element[] = [];\r\n                let pending: JSX.Element[] = [];\r\n                let active: JSX.Element[] = [];\r\n                const defeated: JSX.Element[] = [];\r\n\r\n                this.props.combat.combatants.forEach(combatant => {\r\n                    if (combatant.current) {\r\n                        current.push(\r\n                            <div key={combatant.id}>\r\n                                {this.createCard(combatant)}\r\n                            </div>\r\n                        );\r\n                    }\r\n                    if (combatant.pending && !combatant.active && !combatant.defeated) {\r\n                        pending.push(\r\n                            <PendingCombatantRow\r\n                                key={combatant.id}\r\n                                combatant={combatant}\r\n                                select={c => this.setSelectedTokenID(c.id)}\r\n                                selected={combatant.id === this.state.selectedTokenID}\r\n                                nudgeValue={(c, type, delta) => this.props.nudgeValue(c, type, delta)}\r\n                                makeActive={c => this.props.makeActive(c)}\r\n                            />\r\n                        );\r\n                    }\r\n                    if (!combatant.pending && combatant.active && !combatant.defeated) {\r\n                        switch (combatant.type) {\r\n                            case 'pc':\r\n                                active.push(\r\n                                    <PCRow\r\n                                        key={combatant.id}\r\n                                        combatant={combatant as Combatant & PC}\r\n                                        combat={this.props.combat as Combat}\r\n                                        select={c => this.setSelectedTokenID(c.id)}\r\n                                        selected={combatant.id === this.state.selectedTokenID}\r\n                                    />\r\n                                );\r\n                                break;\r\n                            case 'monster':\r\n                                active.push(\r\n                                    <MonsterRow\r\n                                        key={combatant.id}\r\n                                        combatant={combatant as Combatant & Monster}\r\n                                        combat={this.props.combat as Combat}\r\n                                        select={c => this.setSelectedTokenID(c.id)}\r\n                                        selected={combatant.id === this.state.selectedTokenID}\r\n                                    />\r\n                                );\r\n                                break;\r\n                        }\r\n                    }\r\n                    if (!combatant.pending && !combatant.active && combatant.defeated) {\r\n                        switch (combatant.type) {\r\n                            case 'pc':\r\n                                defeated.push(\r\n                                    <PCRow\r\n                                        key={combatant.id}\r\n                                        combatant={combatant as Combatant & PC}\r\n                                        combat={this.props.combat as Combat}\r\n                                        select={c => this.setSelectedTokenID(c.id)}\r\n                                        selected={combatant.id === this.state.selectedTokenID}\r\n                                    />\r\n                                );\r\n                                break;\r\n                            case 'monster':\r\n                                defeated.push(\r\n                                    <MonsterRow\r\n                                        key={combatant.id}\r\n                                        combatant={combatant as Combatant & Monster}\r\n                                        combat={this.props.combat as Combat}\r\n                                        select={c => this.setSelectedTokenID(c.id)}\r\n                                        selected={combatant.id === this.state.selectedTokenID}\r\n                                    />\r\n                                );\r\n                                break;\r\n                        }\r\n                    }\r\n                });\r\n\r\n                if (this.props.showHelp && (pending.length !== 0)) {\r\n                    const pendingHelp = (\r\n                        <div key='pending-help'>\r\n                            <InfoCard\r\n                                getContent={() =>\r\n                                    <div>\r\n                                        <div className='section'>these combatants are not yet part of the encounter</div>\r\n                                        <div className='section'>set initiative on each of them, then add them to the encounter</div>\r\n                                    </div>\r\n                                }\r\n                            />\r\n                        </div>\r\n                    );\r\n                    pending = [pendingHelp].concat(pending);\r\n                }\r\n\r\n                if (this.props.showHelp && (current.length === 0)) {\r\n                    const activeHelp = (\r\n                        /* tslint:disable:max-line-length */\r\n                        <div key='active-help'>\r\n                            <InfoCard\r\n                                getContent={() =>\r\n                                    <div>\r\n                                        <div className='section'>these are the combatants taking part in this encounter; you can select them to see their stat blocks (on the right)</div>\r\n                                        <div className='section'>to begin the encounter, select the first combatant and press the <b>start turn</b> button on their stat block</div>\r\n                                    </div>\r\n                                }\r\n                            />\r\n                        </div>\r\n                        /* tslint:enable:max-line-length */\r\n                    );\r\n                    active = [activeHelp].concat(active);\r\n                }\r\n\r\n                if (current.length === 0) {\r\n                    current.push(\r\n                        <InfoCard\r\n                            key='current'\r\n                            getContent={() =>\r\n                                <div className='section'>the current initiative holder will be displayed here</div>\r\n                            }\r\n                        />\r\n                    );\r\n                }\r\n\r\n                let notificationSection = null;\r\n                if (this.props.combat.notifications.length > 0) {\r\n                    const notifications = this.props.combat.notifications.map(n => (\r\n                        <NotificationPanel\r\n                            key={n.id}\r\n                            notification={n}\r\n                            close={(notification, removeCondition) => this.props.close(notification, removeCondition)}\r\n                        />\r\n                    ));\r\n                    notificationSection = (\r\n                        <div className='notifications'>\r\n                            {notifications}\r\n                        </div>\r\n                    );\r\n                }\r\n\r\n                let mapSection = null;\r\n                if (this.props.combat.map) {\r\n                    mapSection = (\r\n                        <MapPanel\r\n                            map={this.props.combat.map}\r\n                            mode='combat'\r\n                            showOverlay={this.state.addingToMapID !== null}\r\n                            combatants={this.props.combat.combatants}\r\n                            selectedItemID={this.state.selectedTokenID ? this.state.selectedTokenID : undefined}\r\n                            setSelectedItemID={id => {\r\n                                if (id) {\r\n                                    this.setSelectedTokenID(id);\r\n                                }\r\n                            }}\r\n                            gridSquareClicked={(x, y) => this.addCombatantToMap(x, y)}\r\n                        />\r\n                    );\r\n                }\r\n\r\n                let selectedCombatant = null;\r\n                if (this.state.selectedTokenID) {\r\n                    const combatant = this.props.combat.combatants.find(c => c.id === this.state.selectedTokenID);\r\n                    if (combatant && !combatant.current) {\r\n                        selectedCombatant = this.createCard(combatant);\r\n                    }\r\n                }\r\n                if (!selectedCombatant) {\r\n                    selectedCombatant = (\r\n                        <InfoCard\r\n                            key='selected'\r\n                            getContent={() =>\r\n                                <div className='section'>select a pc or monster to see its details here</div>\r\n                            }\r\n                        />\r\n                    );\r\n                }\r\n\r\n                return (\r\n                    <div className='combat-manager row collapse'>\r\n                        <div className='columns small-4 medium-4 large-4 scrollable'>\r\n                            <CardGroup\r\n                                heading='initiative holder'\r\n                                content={current}\r\n                            />\r\n                        </div>\r\n                        <div className='columns small-4 medium-4 large-4 scrollable'>\r\n                            {notificationSection}\r\n                            <CardGroup\r\n                                heading='waiting for intiative to be entered'\r\n                                content={pending}\r\n                                hidden={pending.length === 0}\r\n                                showToggle={true}\r\n                            />\r\n                            {mapSection}\r\n                            <CardGroup\r\n                                heading='combatants in the encounter'\r\n                                content={active}\r\n                                hidden={active.length === 0}\r\n                            />\r\n                            <CardGroup\r\n                                heading='defeated'\r\n                                content={defeated}\r\n                                hidden={defeated.length === 0}\r\n                                showToggle={true}\r\n                            />\r\n                        </div>\r\n                        <div className='columns small-4 medium-4 large-4 scrollable'>\r\n                            <CardGroup\r\n                                heading='selected combatant'\r\n                                content={[selectedCombatant]}\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                );\r\n            } else {\r\n                let help = null;\r\n                if (this.props.showHelp) {\r\n                    help = (\r\n                        <CombatManagerCard />\r\n                    );\r\n                }\r\n\r\n                const combats: JSX.Element[] = [];\r\n                this.props.combats.forEach(c => {\r\n                    combats.push(\r\n                        <CombatListItem\r\n                            key={c.id}\r\n                            combat={c}\r\n                            selected={false}\r\n                            setSelection={combat => this.props.resumeEncounter(combat)}\r\n                        />\r\n                    );\r\n                });\r\n\r\n                return (\r\n                    <div className='combat-manager row collapse'>\r\n                        <div className='columns small-4 medium-4 large-3 scrollable list-column'>\r\n                            {help}\r\n                            <button onClick={() => this.props.createCombat()}>start a new combat</button>\r\n                            {combats}\r\n                        </div>\r\n                        <div className='columns small-8 medium-8 large-9 scrollable' />\r\n                    </div>\r\n                );\r\n            }\r\n        } catch (e) {\r\n            console.error(e);\r\n        }\r\n    }\r\n}\r\n\r\ninterface NotificationProps {\r\n    notification: Notification;\r\n    close: (notification: Notification, removeCondition: boolean) => void;\r\n}\r\n\r\nclass NotificationPanel extends React.Component<NotificationProps> {\r\n    private success() {\r\n        switch (this.props.notification.type) {\r\n            case 'condition-save':\r\n            case 'condition-end':\r\n                const condition = this.props.notification.data as Condition;\r\n                if (condition.duration) {\r\n                    // Reduce save by 1\r\n                    if ((condition.duration.type === 'saves') || (condition.duration.type === 'rounds')) {\r\n                        condition.duration.count -= 1;\r\n                        if (condition.duration.count === 0) {\r\n                            // Remove the condition\r\n                            this.close(true);\r\n                        } else {\r\n                            this.close();\r\n                        }\r\n                    }\r\n                }\r\n                break;\r\n            case 'trait-recharge':\r\n                // Mark trait as recharged\r\n                const trait = this.props.notification.data as Trait;\r\n                trait.uses = 0;\r\n                this.close();\r\n                break;\r\n        }\r\n    }\r\n\r\n    private close(removeCondition = false) {\r\n        this.props.close(this.props.notification, removeCondition);\r\n    }\r\n\r\n    public render() {\r\n        const combatant = this.props.notification.combatant as (Combatant & Monster);\r\n        const condition = this.props.notification.data as Condition;\r\n        const trait = this.props.notification.data as Trait;\r\n\r\n        const name = combatant.displayName || combatant.name || 'unnamed monster';\r\n        switch (this.props.notification.type) {\r\n            case 'condition-save':\r\n                const duration = condition.duration as ConditionDurationSaves;\r\n                let saveType = duration.saveType.toString();\r\n                if (saveType !== 'death') {\r\n                    saveType = saveType.toUpperCase();\r\n                }\r\n                return (\r\n                    <div key={this.props.notification.id} className='notification'>\r\n                        <div className='text'>\r\n                            {name} must make a {saveType} save against dc {duration.saveDC}\r\n                        </div>\r\n                        <div className='buttons'>\r\n                            <button onClick={() => this.success()}>success</button>\r\n                            <button onClick={() => this.close()}>close</button>\r\n                        </div>\r\n                    </div>\r\n                );\r\n            case 'condition-end':\r\n                return (\r\n                    <div key={this.props.notification.id} className='notification'>\r\n                        <div className='text'>\r\n                            {name} is no longer affected by condition {condition.name}\r\n                        </div>\r\n                        <div className='buttons'>\r\n                            <button onClick={() => this.close()}>close</button>\r\n                        </div>\r\n                    </div>\r\n                );\r\n            case 'trait-recharge':\r\n                return (\r\n                    <div key={this.props.notification.id} className='notification'>\r\n                        <div className='text'>\r\n                            {name} can attempt to recharge {trait.name} ({trait.usage})\r\n                        </div>\r\n                        <div className='buttons'>\r\n                            <button onClick={() => this.success()}>recharge</button>\r\n                            <button onClick={() => this.close()}>close</button>\r\n                        </div>\r\n                    </div>\r\n                );\r\n            default:\r\n                return null;\r\n        }\r\n    }\r\n}\r\n\r\ninterface PendingCombatantRowProps {\r\n    combatant: (Combatant & PC) | (Combatant & Monster);\r\n    selected: boolean;\r\n    select: (combatant: (Combatant & PC) | (Combatant & Monster)) => void;\r\n    nudgeValue: (combatant: (Combatant & PC) | (Combatant & Monster), field: string, delta: number) => void;\r\n    makeActive: (combatant: (Combatant & PC) | (Combatant & Monster)) => void;\r\n}\r\n\r\nclass PendingCombatantRow extends React.Component<PendingCombatantRowProps> {\r\n    private getInformationText() {\r\n        if (this.props.selected) {\r\n            return 'selected';\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    private onClick(e: React.MouseEvent) {\r\n        e.stopPropagation();\r\n        if (this.props.select) {\r\n            this.props.select(this.props.combatant);\r\n        }\r\n    }\r\n\r\n    public render() {\r\n        let style = 'combatant-row ' + this.props.combatant.type;\r\n        if (this.props.combatant.current || this.props.selected) {\r\n            style += ' highlight';\r\n        }\r\n\r\n        return (\r\n            <div className={style} onClick={e => this.onClick(e)}>\r\n                <div className='name'>\r\n                    {this.props.combatant.displayName || this.props.combatant.name || 'combatant'}\r\n                    <span className='info'>{this.getInformationText()}</span>\r\n                </div>\r\n                <div className='content'>\r\n                    <Spin\r\n                        source={this.props.combatant}\r\n                        name='initiative'\r\n                        label='initiative'\r\n                        nudgeValue={delta => this.props.nudgeValue(this.props.combatant, 'initiative', delta)}\r\n                    />\r\n                    <button onClick={e => { e.stopPropagation(); this.props.makeActive(this.props.combatant); }}>add to encounter</button>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\ninterface PCRowProps {\r\n    combatant: Combatant & PC;\r\n    combat: Combat;\r\n    selected: boolean;\r\n    select: (combatant: Combatant & PC) => void;\r\n}\r\n\r\nclass PCRow extends React.Component<PCRowProps> {\r\n    private getInformationText() {\r\n        if (this.props.combatant.current) {\r\n            return 'current turn';\r\n        }\r\n\r\n        if (this.props.selected) {\r\n            return 'selected';\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    private onClick(e: React.MouseEvent) {\r\n        e.stopPropagation();\r\n        if (!this.props.combatant.current && !this.props.selected && this.props.select) {\r\n            this.props.select(this.props.combatant);\r\n        }\r\n    }\r\n\r\n    public render() {\r\n        let style = 'combatant-row ' + this.props.combatant.type;\r\n        if (this.props.combatant.current || this.props.selected) {\r\n            style += ' highlight';\r\n        }\r\n\r\n        const desc = (this.props.combatant.race || 'unknown race')\r\n                + ' ' + (this.props.combatant.classes || 'unknown class')\r\n                + ', level ' + this.props.combatant.level;\r\n\r\n        const notes = [];\r\n        if (this.props.combat.map) {\r\n            if (!this.props.combatant.pending && !this.props.combat.map.items.find(i => i.id === this.props.combatant.id)) {\r\n                notes.push(\r\n                    <div key='not-on-map' className='note'>not on the map</div>\r\n                );\r\n            }\r\n        }\r\n\r\n        return (\r\n            <div className={style} onClick={e => this.onClick(e)}>\r\n                <div className='name'>\r\n                    {this.props.combatant.displayName || this.props.combatant.name || 'combatant'}\r\n                    {this.props.combatant.player ? ' | ' + this.props.combatant.player : ''}\r\n                    <span className='info'>{this.getInformationText()}</span>\r\n                </div>\r\n                <div className='content'>\r\n                    <div className='section lowercase'>\r\n                        {desc}\r\n                    </div>\r\n                    {notes}\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\ninterface MonsterRowProps {\r\n    combatant: Combatant & Monster;\r\n    combat: Combat;\r\n    selected: boolean;\r\n    select: (combatant: Combatant & Monster) => void;\r\n}\r\n\r\nclass MonsterRow extends React.Component<MonsterRowProps> {\r\n    private getInformationText() {\r\n        if (this.props.combatant.current) {\r\n            return 'current turn';\r\n        }\r\n\r\n        if (this.props.selected) {\r\n            return 'selected';\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    private onClick(e: React.MouseEvent) {\r\n        e.stopPropagation();\r\n        if (!this.props.combatant.current && !this.props.selected && this.props.select) {\r\n            this.props.select(this.props.combatant);\r\n        }\r\n    }\r\n\r\n    public render() {\r\n        let style = 'combatant-row ' + this.props.combatant.type;\r\n        if (this.props.combatant.current || this.props.selected) {\r\n            style += ' highlight';\r\n        }\r\n\r\n        let hp = (this.props.combatant.hp ? this.props.combatant.hp : 0).toString();\r\n        if (this.props.combatant.hpTemp > 0) {\r\n            hp += '+' + this.props.combatant.hpTemp;\r\n        }\r\n\r\n        let gauge = null;\r\n        if (!this.props.combatant.pending) {\r\n            gauge = (\r\n                <HitPointGauge combatant={this.props.combatant} />\r\n            );\r\n        }\r\n\r\n        let conditions = null;\r\n        if (this.props.combatant.conditions) {\r\n            conditions = this.props.combatant.conditions.map(c => {\r\n                let name = c.name;\r\n                if (c.name === 'exhaustion') {\r\n                    name += ' (' + c.level + ')';\r\n                }\r\n                if ((c.name === 'custom') && (c.text)) {\r\n                    name = c.text;\r\n                }\r\n                if (c.duration) {\r\n                    name += ' ' + Utils.conditionDurationText(c, this.props.combat);\r\n                }\r\n                const description = [];\r\n                const text = Utils.conditionText(c);\r\n                for (let n = 0; n !== text.length; ++n) {\r\n                    description.push(<li key={n} className='condition-text'>{text[n]}</li>);\r\n                }\r\n                return (\r\n                    <div key={c.id} className='condition'>\r\n                        <div className='condition-name'>{name}</div>\r\n                        <ul>\r\n                            {description}\r\n                        </ul>\r\n                    </div>\r\n                );\r\n            });\r\n        }\r\n\r\n        const notes = [];\r\n        if (this.props.combat.map) {\r\n            if (!this.props.combatant.pending && !this.props.combat.map.items.find(i => i.id === this.props.combatant.id)) {\r\n                notes.push(\r\n                    <div key='not-on-map' className='note'>not on the map</div>\r\n                );\r\n            }\r\n        }\r\n\r\n        return (\r\n            <div className={style} onClick={e => this.onClick(e)}>\r\n                <div className='name'>\r\n                    {this.props.combatant.displayName || this.props.combatant.name || 'combatant'}\r\n                    <span className='info'>{this.getInformationText()}</span>\r\n                </div>\r\n                <div className='content'>\r\n                    <div className='section key-stats'>\r\n                        <div className='key-stat'>\r\n                            <div className='stat-label'>ac</div>\r\n                            <div className='stat-value'>{this.props.combatant.ac}</div>\r\n                        </div>\r\n                        <div className='key-stat'>\r\n                            <div className='stat-value'>{hp}</div>\r\n                            <div className='stat-label'>hp</div>\r\n                        </div>\r\n                    </div>\r\n                    {gauge}\r\n                    {conditions}\r\n                    {notes}\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport InfoCard from '../info-card';\r\n\r\nexport default class DMScreenCard extends React.Component {\r\n    private getContent() {\r\n        return (\r\n            <div>\r\n                <div className='section'>this is the dm screen</div>\r\n                <div className='section'>it contains a collection of modules which might be useful when you're running the game</div>\r\n                <div className='divider' />\r\n                <div className='section'>click on a module below to open it</div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    public render() {\r\n        return (\r\n            <InfoCard getContent={this.getContent}/>\r\n        );\r\n    }\r\n}\r\n","import React from 'react';\r\nimport Showdown from 'showdown';\r\n\r\nconst showdown = new Showdown.Converter();\r\n\r\n// tslint:disable-next-line:no-empty-interface\r\ninterface Props {\r\n    //\r\n}\r\n\r\ninterface State {\r\n    source: string | null;\r\n}\r\n\r\nexport default class ActionsModule extends React.Component<Props, State> {\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            source: null\r\n        };\r\n    }\r\n\r\n    private async fetchData() {\r\n        const response = await fetch('./data/actions.md');\r\n        this.setState({\r\n            source: await response.text()\r\n        });\r\n    }\r\n\r\n    public render() {\r\n        if (!this.state.source) {\r\n            this.fetchData();\r\n        }\r\n\r\n        return (\r\n            <div dangerouslySetInnerHTML={{ __html: showdown.makeHtml(this.state.source || '') }} />\r\n        );\r\n    }\r\n}\r\n","import React from 'react';\r\nimport Showdown from 'showdown';\r\n\r\nconst showdown = new Showdown.Converter();\r\nshowdown.setOption('tables', true);\r\n\r\n// tslint:disable-next-line:no-empty-interface\r\ninterface Props {\r\n    //\r\n}\r\n\r\ninterface State {\r\n    source: string | null;\r\n}\r\n\r\nexport default class ConditionsModule extends React.Component<Props, State> {\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            source: null\r\n        };\r\n    }\r\n\r\n    private async fetchData() {\r\n        const response = await fetch('./data/conditions.md');\r\n        this.setState({\r\n            source: await response.text()\r\n        });\r\n    }\r\n\r\n    public render() {\r\n        if (!this.state.source) {\r\n            this.fetchData();\r\n        }\r\n\r\n        return (\r\n            <div dangerouslySetInnerHTML={{ __html: showdown.makeHtml(this.state.source || '') }} />\r\n        );\r\n    }\r\n}\r\n","interface ModelLine {\r\n    prev: string;\r\n    freq: ModelChar[];\r\n}\r\n\r\ninterface ModelChar {\r\n    char: string;\r\n    count: number;\r\n}\r\n\r\nexport default class TextGenerator {\r\n\r\n    private static model: ModelLine[] = [];\r\n\r\n    public static initModel(sources: string[]) {\r\n        const model: ModelLine[] = [];\r\n\r\n        sources.forEach(source => {\r\n            const lines = source.split(/\\r?\\n/);\r\n            lines.forEach(line => {\r\n                if (line) {\r\n                    TextGenerator.addLineToModel(line, model);\r\n                }\r\n            });\r\n        });\r\n\r\n        TextGenerator.model = model;\r\n    }\r\n\r\n    private static addLineToModel(line: string, model: ModelLine[]) {\r\n        line = String.fromCharCode(0, 1) + line + String.fromCharCode(2);\r\n\r\n        for (let index = 2; index !== line.length; ++index) {\r\n            const prev = line.substr(index - 2, 2);\r\n            const char = line.substr(index, 1);\r\n\r\n            let item = model.find(x => x.prev === prev);\r\n            if (!item) {\r\n                item = {\r\n                    prev: prev,\r\n                    freq: []\r\n                };\r\n                model.push(item);\r\n            }\r\n\r\n            let freq = item.freq.find(x => x.char === char);\r\n            if (!freq) {\r\n                freq = {\r\n                    char: char,\r\n                    count: 0\r\n                };\r\n                item.freq.push(freq);\r\n            }\r\n\r\n            freq.count += 1;\r\n        }\r\n    }\r\n\r\n    public static generate(requiredResults: number): string[] {\r\n        const lines: string[] = [];\r\n        const allowedFailures = 100;\r\n        let failures = 0;\r\n\r\n        while ((lines.length < requiredResults) && (failures < allowedFailures)) {\r\n            const line = TextGenerator.extractLine();\r\n            if (line && !lines.includes(line)) {\r\n                lines.push(line);\r\n            } else {\r\n                failures += 1;\r\n            }\r\n        }\r\n\r\n        return lines;\r\n    }\r\n\r\n    private static extractLine() {\r\n        let line = String.fromCharCode(0, 1);\r\n\r\n        while (true) {\r\n            const prev = line.substr(line.length - 2, 2);\r\n\r\n            const item = TextGenerator.model.find(x => x.prev === prev);\r\n            if (item) {\r\n                let candidates = '';\r\n                item.freq.forEach(freq => {\r\n                    candidates += freq.char.repeat(freq.count);\r\n                });\r\n\r\n                const index = Math.floor(Math.random() * candidates.length);\r\n                const char = candidates[index];\r\n                if (char === String.fromCharCode(2)) {\r\n                    line = line.substr(2);\r\n                    return line;\r\n                } else {\r\n                    line += char;\r\n                }\r\n            } else {\r\n                return null;\r\n            }\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport checked from '../../resources/images/checked.svg';\r\nimport unchecked from '../../resources/images/unchecked.svg';\r\n\r\ninterface Props {\r\n    label: string;\r\n    checked: boolean;\r\n    changeValue: (value: boolean) => void;\r\n    disabled: boolean;\r\n}\r\n\r\nexport default class Checkbox extends React.Component<Props> {\r\n    public static defaultProps = {\r\n        disabled: false\r\n    };\r\n\r\n    private click(e: React.MouseEvent) {\r\n        e.stopPropagation();\r\n        this.props.changeValue(!this.props.checked);\r\n    }\r\n\r\n    public render() {\r\n        try {\r\n            let style = 'checkbox';\r\n            if (this.props.checked) {\r\n                style += ' checked';\r\n            }\r\n            if (this.props.disabled) {\r\n                style += ' disabled';\r\n            }\r\n\r\n            return (\r\n                <div className={style} onClick={e => this.click(e)}>\r\n                    <img className='image' src={this.props.checked ? checked : unchecked} alt='check' />\r\n                    <div className='checkbox-label'>{this.props.label}</div>\r\n                </div>\r\n            );\r\n\r\n        } catch (ex) {\r\n            console.error(ex);\r\n            return null;\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\ninterface Props {\r\n    options: { id: string; text: string; disabled?: boolean }[];\r\n    selectedID: string | null;\r\n    select: (optionID: string) => void;\r\n    tabs: boolean;\r\n    disabled: boolean;\r\n    itemsPerRow: number;\r\n}\r\n\r\nexport default class Selector extends React.Component<Props> {\r\n    public static defaultProps = {\r\n        tabs: false,\r\n        disabled: false,\r\n        itemsPerRow: null\r\n    };\r\n\r\n    public render() {\r\n        try {\r\n            let style = this.props.tabs ? 'selector tabs' : 'selector radio';\r\n            if (this.props.disabled) {\r\n                style += ' disabled';\r\n            }\r\n\r\n            const itemsPerRow = this.props.itemsPerRow ? this.props.itemsPerRow : this.props.options.length;\r\n            const rowCount = Math.ceil(this.props.options.length / itemsPerRow);\r\n            const rowContents: JSX.Element[][] = [];\r\n            for (let n = 0; n !== rowCount; ++n) {\r\n                rowContents.push([]);\r\n            }\r\n\r\n            this.props.options.forEach(option => {\r\n                const index = this.props.options.indexOf(option);\r\n                const rowIndex = Math.floor(index / itemsPerRow);\r\n                const row = rowContents[rowIndex];\r\n                row.push(\r\n                    <SelectorOption\r\n                        key={option.id}\r\n                        option={option}\r\n                        selected={option.id === this.props.selectedID}\r\n                        count={itemsPerRow}\r\n                        select={(optionID: string) => this.props.select(optionID)}\r\n                    />\r\n                );\r\n            });\r\n\r\n            const rowSections = rowContents.map(row => {\r\n                const index = rowContents.indexOf(row);\r\n                return <div key={index}>{row}</div>;\r\n            });\r\n\r\n            return (\r\n                <div className={style}>\r\n                    {rowSections}\r\n                </div>\r\n            );\r\n        } catch (ex) {\r\n            console.error(ex);\r\n            return null;\r\n        }\r\n    }\r\n}\r\n\r\ninterface SelectorOptionInterface {\r\n    option: { id: string; text: string; disabled?: boolean };\r\n    selected: boolean;\r\n    count: number;\r\n    select: (optionID: string) => void;\r\n}\r\n\r\nclass SelectorOption extends React.Component<SelectorOptionInterface> {\r\n    private click(e: React.MouseEvent) {\r\n        e.stopPropagation();\r\n        if (!this.props.option.disabled) {\r\n            this.props.select(this.props.option.id);\r\n        }\r\n    }\r\n\r\n    public render() {\r\n        try {\r\n            const width = 'calc(((100% - 1px) / ' + this.props.count + ') - 2px )';\r\n\r\n            let style = 'option';\r\n            if (this.props.selected) {\r\n                style += ' selected';\r\n            }\r\n            if (this.props.option.disabled) {\r\n                style += ' disabled';\r\n            }\r\n\r\n            return (\r\n                <div key={this.props.option.id} className={style} style={{ width: width }} title={this.props.option.text} onClick={e => this.click(e)}>\r\n                    {this.props.option.text}\r\n                </div>\r\n            );\r\n        } catch (ex) {\r\n            console.error(ex);\r\n            return null;\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport TextGenerator from '../../utils/text-generation';\r\n\r\nimport ButtonRow from '../controls/button-row';\r\nimport Checkbox from '../controls/checkbox';\r\nimport Selector from '../controls/selector';\r\n\r\n// tslint:disable-next-line:no-empty-interface\r\ninterface Props {\r\n    //\r\n}\r\n\r\ninterface State {\r\n    sources: { [id: string]: string; };\r\n    output: string[];\r\n}\r\n\r\ninterface Preset {\r\n    name: string;\r\n    languages: string[];\r\n}\r\n\r\nexport default class LanguageModule extends React.Component<Props, State> {\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            sources: {},\r\n            output: []\r\n        };\r\n    }\r\n\r\n    private getLanguages(): string[] {\r\n        return [\r\n            'afrikaans',\r\n            'amharic',\r\n            'armenian',\r\n            'basque',\r\n            'belarusian',\r\n            'bulgarian',\r\n            'chichewa',\r\n            'chinese',\r\n            'croatian',\r\n            'czech',\r\n            'danish',\r\n            'dutch',\r\n            'english',\r\n            'finnish',\r\n            'french',\r\n            'german',\r\n            'greek',\r\n            'hawaiian',\r\n            'hindi',\r\n            'hungarian',\r\n            'icelandic',\r\n            'irish',\r\n            'italian',\r\n            'japanese',\r\n            'kannada',\r\n            'kazakh',\r\n            'korean',\r\n            'kyrgyz',\r\n            'latvian',\r\n            'lithuanian',\r\n            'macedonian',\r\n            'malay',\r\n            'maltese',\r\n            'maori',\r\n            'myanmar',\r\n            'nepalese',\r\n            'norwegian',\r\n            'persian',\r\n            'portuguese',\r\n            'punjabi',\r\n            'romanian',\r\n            'russian',\r\n            'samoan',\r\n            'serbian',\r\n            'shona',\r\n            'somali',\r\n            'spanish',\r\n            'swahili',\r\n            'swedish',\r\n            'thai',\r\n            'turkish',\r\n            'welsh',\r\n            'yiddish',\r\n            'zulu'\r\n        ];\r\n    }\r\n\r\n    private getPresets(): Preset[] {\r\n        return [\r\n            {\r\n                name: 'draconic',\r\n                languages: ['armenian', 'irish', 'maltese']\r\n            },\r\n            {\r\n                name: 'dwarvish',\r\n                languages: ['czech', 'german', 'yiddish']\r\n            },\r\n            {\r\n                name: 'elvish',\r\n                languages: ['finnish', 'spanish', 'welsh']\r\n            },\r\n            {\r\n                name: 'goblin',\r\n                languages: ['hawaiian', 'kyrgyz', 'somali']\r\n            },\r\n            {\r\n                name: 'orc',\r\n                languages: ['macedonian', 'russian', 'turkish']\r\n            }\r\n        ];\r\n    }\r\n\r\n    private async addLanguage(language: string) {\r\n        const response = await fetch('./data/langs/' + language + '.txt');\r\n        this.state.sources[language] = await response.text();\r\n        this.setState({\r\n            sources: this.state.sources\r\n        });\r\n    }\r\n\r\n    private removeLanguage(language: string) {\r\n        delete this.state.sources[language];\r\n        this.setState({\r\n            sources: this.state.sources\r\n        });\r\n    }\r\n\r\n    private usePreset(presetName: string) {\r\n        const preset = this.getPresets().find(p => p.name === presetName);\r\n        if (preset) {\r\n            this.setState({\r\n                sources: {},\r\n                output: []\r\n            }, () => {\r\n                preset.languages.forEach(lang => {\r\n                    this.addLanguage(lang);\r\n                });\r\n            });\r\n        }\r\n    }\r\n\r\n    private generate() {\r\n        const sources: string[] = [];\r\n        Object.keys(this.state.sources).forEach(key => {\r\n            const src = this.state.sources[key];\r\n            sources.push(src);\r\n        });\r\n        TextGenerator.initModel(sources);\r\n        this.setState({\r\n            output: TextGenerator.generate(5)\r\n        });\r\n    }\r\n\r\n    private reset() {\r\n        this.setState({\r\n            sources: {},\r\n            output: []\r\n        });\r\n    }\r\n\r\n    public render() {\r\n        const presetOptions = this.getPresets().map(p => {\r\n            return {\r\n                id: p.name,\r\n                text: p.name\r\n            };\r\n        });\r\n\r\n        let selectedPreset = 'custom';\r\n        this.getPresets().forEach(p => {\r\n            const selected = Object.keys(this.state.sources).sort().join(', ');\r\n            const setting = p.languages.sort().join(', ');\r\n            if (selected === setting) {\r\n                selectedPreset = p.name;\r\n            }\r\n        });\r\n\r\n        const languages = this.getLanguages()\r\n            .map(lang => {\r\n                const selected = Object.keys(this.state.sources).includes(lang);\r\n                return (\r\n                    <div className='column' key={lang}>\r\n                        <Checkbox\r\n                            label={lang}\r\n                            checked={selected}\r\n                            changeValue={value => value ? this.addLanguage(lang) : this.removeLanguage(lang)}\r\n                        />\r\n                    </div>\r\n                );\r\n            });\r\n\r\n        const allowGenerate = Object.keys(this.state.sources).length > 0;\r\n        const allowReset = allowGenerate || this.state.output.length > 0;\r\n\r\n        const output = [];\r\n        for (let n = 0; n !== this.state.output.length; ++n) {\r\n            output.push(\r\n                <div key={n} className='section'>\r\n                    {this.state.output[n]}\r\n                </div>\r\n            );\r\n        }\r\n\r\n        return (\r\n            <div className='language'>\r\n                <div className='subheading'>presets</div>\r\n                <Selector\r\n                    options={presetOptions}\r\n                    selectedID={selectedPreset}\r\n                    select={optionID => this.usePreset(optionID)}\r\n                />\r\n                <div className='subheading'>languages</div>\r\n                <div className='row collapse small-up-3 medium-up-4 large-up-6 language-options'>\r\n                    {languages}\r\n                </div>\r\n                <div className='subheading'>output</div>\r\n                <ButtonRow\r\n                    buttons={[\r\n                        { id: 'generate', text: 'generate text', disabled: !allowGenerate, callback: () => this.generate() },\r\n                        { id: 'reset', text: 'reset', disabled: !allowReset, callback: () => this.reset() }\r\n                    ]}\r\n                />\r\n                <div className='language-output'>\r\n                    {output}\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","import React from 'react';\r\nimport Showdown from 'showdown';\r\n\r\nconst showdown = new Showdown.Converter();\r\n\r\n// tslint:disable-next-line:no-empty-interface\r\ninterface Props {\r\n    //\r\n}\r\n\r\ninterface State {\r\n    source: string | null;\r\n}\r\n\r\nexport default class SkillsModule extends React.Component<Props, State> {\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            source: null\r\n        };\r\n    }\r\n\r\n    private async fetchData() {\r\n        const response = await fetch('./data/skills.md');\r\n        this.setState({\r\n            source: await response.text()\r\n        });\r\n    }\r\n\r\n    public render() {\r\n        if (!this.state.source) {\r\n            this.fetchData();\r\n        }\r\n\r\n        return (\r\n            <div dangerouslySetInnerHTML={{ __html: showdown.makeHtml(this.state.source || '') }} />\r\n        );\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport { DMModule } from '../../models/dm-module';\r\n\r\ninterface Props {\r\n    module: DMModule;\r\n    selected: boolean;\r\n    setSelection: (module: DMModule) => void;\r\n}\r\n\r\nexport default class DMModuleListItem extends React.Component<Props> {\r\n    public render() {\r\n        try {\r\n            return (\r\n                <div className={this.props.selected ? 'list-item selected' : 'list-item'} onClick={() => this.props.setSelection(this.props.module)}>\r\n                    <div className='heading'>{this.props.module.name || 'unnamed module'}</div>\r\n                    <div className='text'>{this.props.module.desc || 'no information'}</div>\r\n                </div>\r\n            );\r\n        } catch (e) {\r\n            console.error(e);\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport { DMModule } from '../../models/dm-module';\r\n\r\nimport DMScreenCard from '../cards/information/dm-screen-card';\r\nimport ActionsModule from '../dm-modules/actions-module';\r\nimport ConditionsModule from '../dm-modules/conditions-module';\r\nimport LanguageModule from '../dm-modules/language-module';\r\nimport SkillsModule from '../dm-modules/skills-module';\r\nimport DMModuleListItem from '../list-items/dm-module-list-item';\r\n\r\ninterface Props {\r\n    selectedModuleID: string | null;\r\n    showHelp: boolean;\r\n    selectModule: (module: DMModule | null) => void;\r\n}\r\n\r\nexport default class DMScreen extends React.Component<Props> {\r\n    private getModules(): DMModule[] {\r\n        return [\r\n            {\r\n                id: 'skills',\r\n                name: 'skills',\r\n                desc: 'listing of all the skills in the game'\r\n            },\r\n            {\r\n                id: 'conditions',\r\n                name: 'conditions',\r\n                desc: 'information about conditions and their effects'\r\n            },\r\n            {\r\n                id: 'actions',\r\n                name: 'actions',\r\n                desc: 'list of the available action types and examples'\r\n            },\r\n            {\r\n                id: 'language',\r\n                name: 'language generator',\r\n                desc: 'this tool allows you to generate text in unique languages'\r\n            }\r\n        ];\r\n    }\r\n\r\n    private getContent(): JSX.Element | null {\r\n        switch (this.props.selectedModuleID) {\r\n            case 'skills':\r\n                return (\r\n                    <SkillsModule />\r\n                );\r\n            case 'conditions':\r\n                return (\r\n                    <ConditionsModule />\r\n                );\r\n            case 'actions':\r\n                return (\r\n                    <ActionsModule />\r\n                );\r\n            case 'language':\r\n                return (\r\n                    <LanguageModule />\r\n                );\r\n            default:\r\n                return null;\r\n        }\r\n    }\r\n\r\n    public render() {\r\n        try {\r\n            let help = null;\r\n            if (this.props.showHelp) {\r\n                help = (\r\n                    <DMScreenCard />\r\n                );\r\n            }\r\n\r\n            const modules: DMModule[] = this.getModules();\r\n\r\n            const moduleListItems = [];\r\n            for (let n = 0; n !== modules.length; ++n) {\r\n                const m = modules[n];\r\n                moduleListItems.push(\r\n                    <DMModuleListItem\r\n                        key={m.id}\r\n                        module={m}\r\n                        selected={m.id === this.props.selectedModuleID}\r\n                        setSelection={module => this.props.selectModule(module)}\r\n                    />\r\n                );\r\n            }\r\n\r\n            return (\r\n                <div className='dm-screen row collapse'>\r\n                    <div className='columns small-4 medium-4 large-3 scrollable list-column'>\r\n                        {help}\r\n                        {moduleListItems}\r\n                    </div>\r\n                    <div className='columns small-8 medium-8 large-9 scrollable'>\r\n                        <div className='dm-module'>\r\n                            {this.getContent()}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            );\r\n        } catch (ex) {\r\n            console.error(ex);\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport Utils from '../../utils/utils';\r\n\r\nimport { Encounter, EncounterSlot } from '../../models/encounter';\r\nimport { Monster } from '../../models/monster-group';\r\nimport { Party } from '../../models/party';\r\n\r\ninterface Props {\r\n    encounter: Encounter;\r\n    party: Party | null;\r\n    getMonster: (monsterName: string, groupName: string) => Monster | null;\r\n}\r\n\r\nexport default class DifficultyChartPanel extends React.Component<Props> {\r\n    public render() {\r\n        let monsterCount = 0;\r\n        let monsterXp = 0;\r\n        let slots: EncounterSlot[] = [];\r\n        slots = slots.concat(this.props.encounter.slots);\r\n        this.props.encounter.waves.forEach(wave => {\r\n            slots = slots.concat(wave.slots);\r\n        });\r\n        slots.forEach(slot => {\r\n            monsterCount += slot.count;\r\n            const monster = this.props.getMonster(slot.monsterName, slot.monsterGroupName);\r\n            if (monster) {\r\n                monsterXp += Utils.experience(monster.challenge) * slot.count;\r\n            }\r\n        });\r\n\r\n        const adjustedXp = monsterXp * Utils.experienceFactor(monsterCount);\r\n\r\n        let xpThresholds;\r\n        let diffSection;\r\n        if (this.props.party) {\r\n            let xpEasy = 0;\r\n            let xpMedium = 0;\r\n            let xpHard = 0;\r\n            let xpDeadly = 0;\r\n\r\n            const pcs = this.props.party.pcs.filter(pc => pc.active);\r\n            pcs.forEach(pc => {\r\n                xpEasy += Utils.pcExperience(pc.level, 'easy');\r\n                xpMedium += Utils.pcExperience(pc.level, 'medium');\r\n                xpHard += Utils.pcExperience(pc.level, 'hard');\r\n                xpDeadly += Utils.pcExperience(pc.level, 'deadly');\r\n            });\r\n\r\n            let difficulty = null;\r\n            let adjustedDifficulty = null;\r\n            if (adjustedXp > 0) {\r\n                difficulty = 'trivial';\r\n                if (adjustedXp >= xpEasy) {\r\n                    difficulty = 'easy';\r\n                }\r\n                if (adjustedXp >= xpMedium) {\r\n                    difficulty = 'medium';\r\n                }\r\n                if (adjustedXp >= xpHard) {\r\n                    difficulty = 'hard';\r\n                }\r\n                if (adjustedXp >= xpDeadly) {\r\n                    difficulty = 'deadly';\r\n                }\r\n                adjustedDifficulty = difficulty;\r\n\r\n                if ((pcs.length < 3) || (pcs.length > 5)) {\r\n                    const small = pcs.length < 3;\r\n                    switch (difficulty) {\r\n                        case 'trivial':\r\n                            adjustedDifficulty = small ? 'easy' : 'trivial';\r\n                            break;\r\n                        case 'easy':\r\n                            adjustedDifficulty = small ? 'medium' : 'trivial';\r\n                            break;\r\n                        case 'medium':\r\n                            adjustedDifficulty = small ? 'hard' : 'easy';\r\n                            break;\r\n                        case 'hard':\r\n                            adjustedDifficulty = small ? 'deadly' : 'medium';\r\n                            break;\r\n                        case 'deadly':\r\n                            adjustedDifficulty = small ? 'deadly' : 'hard';\r\n                            break;\r\n                        default:\r\n                            adjustedDifficulty = '';\r\n                            break;\r\n                    }\r\n                }\r\n            }\r\n\r\n            xpThresholds = (\r\n                <div className='table'>\r\n                    <div>\r\n                        <div className='cell four'><b>easy</b></div>\r\n                        <div className='cell four'><b>medium</b></div>\r\n                        <div className='cell four'><b>hard</b></div>\r\n                        <div className='cell four'><b>deadly</b></div>\r\n                    </div>\r\n                    <div>\r\n                        <div className='cell four'>{xpEasy} xp</div>\r\n                        <div className='cell four'>{xpMedium} xp</div>\r\n                        <div className='cell four'>{xpHard} xp</div>\r\n                        <div className='cell four'>{xpDeadly} xp</div>\r\n                    </div>\r\n                </div>\r\n            );\r\n\r\n            const getLeft = (xp: number) => {\r\n                const max = Math.max(adjustedXp, (xpDeadly * 1.2));\r\n                return (100 * xp) / max;\r\n            };\r\n\r\n            const getRight = (xp: number) => {\r\n                return 100 - getLeft(xp);\r\n            };\r\n\r\n            diffSection = (\r\n                <div>\r\n                    <div className='difficulty-gauge'>\r\n                        <div className='bar-container'>\r\n                            <div className='bar trivial' style={{ left: '0', right: getRight(xpEasy) + '%' }} />\r\n                        </div>\r\n                        <div className='bar-container'>\r\n                            <div className='bar easy' style={{ left: getLeft(xpEasy) + '%', right: getRight(xpMedium) + '%' }} />\r\n                        </div>\r\n                        <div className='bar-container'>\r\n                            <div className='bar medium' style={{ left: getLeft(xpMedium) + '%', right: getRight(xpHard) + '%' }} />\r\n                        </div>\r\n                        <div className='bar-container'>\r\n                            <div className='bar hard' style={{ left: getLeft(xpHard) + '%', right: getRight(xpDeadly) + '%' }} />\r\n                        </div>\r\n                        <div className='bar-container'>\r\n                            <div className='bar deadly' style={{ left: getLeft(xpDeadly) + '%', right: '0' }} />\r\n                        </div>\r\n                        <div className='encounter-container'>\r\n                            <div className='encounter' style={{ left: (getLeft(adjustedXp) - 0.5) + '%' }} />\r\n                        </div>\r\n                    </div>\r\n                    <div className='subheading'>difficulty</div>\r\n                    <div className='section'>\r\n                        difficulty for this party\r\n                        <div className='right'>{difficulty}</div>\r\n                    </div>\r\n                    <div className='section' style={{ display: (adjustedDifficulty === difficulty) ? 'none' : ''}}>\r\n                        effective difficulty for {pcs.length} pc(s)\r\n                        <div className='right'><b>{adjustedDifficulty}</b></div>\r\n                    </div>\r\n                </div>\r\n            );\r\n        }\r\n\r\n        return (\r\n            <div>\r\n                <div className='subheading'>xp value</div>\r\n                <div className='section'>\r\n                    xp for this encounter\r\n                    <div className='right'>{monsterXp} xp</div>\r\n                </div>\r\n                <div className='section' style={{ display: (adjustedXp === monsterXp) ? 'none' : ''}}>\r\n                    effective xp for {monsterCount} monster(s)\r\n                    <div className='right'>{adjustedXp} xp</div>\r\n                </div>\r\n                {xpThresholds}\r\n                {diffSection}\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport { Encounter } from '../../models/encounter';\r\nimport { Monster } from '../../models/monster-group';\r\nimport { Party } from '../../models/party';\r\n\r\nimport ConfirmButton from '../controls/confirm-button';\r\nimport Dropdown from '../controls/dropdown';\r\nimport DifficultyChartPanel from '../panels/difficulty-chart-panel';\r\nimport InfoCard from './info-card';\r\n\r\nimport arrow from '../../resources/images/down-arrow.svg';\r\n\r\ninterface Props {\r\n    selection: Encounter;\r\n    parties: Party[];\r\n    changeValue: (field: string, value: string) => void;\r\n    addWave: () => void;\r\n    removeEncounter: () => void;\r\n    getMonster: (monsterName: string, groupName: string) => Monster | null;\r\n}\r\n\r\ninterface State {\r\n    showDetails: boolean;\r\n    party: Party | null;\r\n}\r\n\r\nexport default class EncounterCard extends React.Component<Props, State> {\r\n    constructor(props: Props) {\r\n        super(props);\r\n        this.state = {\r\n            showDetails: false,\r\n            party: null\r\n        };\r\n    }\r\n\r\n    private toggleDetails() {\r\n        this.setState({\r\n            showDetails: !this.state.showDetails\r\n        });\r\n    }\r\n\r\n    private selectParty(partyID: string) {\r\n        const party = this.props.parties.find(p => p.id === partyID);\r\n        this.setState({\r\n            party: party as Party\r\n        });\r\n    }\r\n\r\n    public render() {\r\n        try {\r\n            const partyOptions = [];\r\n            if (this.props.parties) {\r\n                for (let n = 0; n !== this.props.parties.length; ++n) {\r\n                    const party = this.props.parties[n];\r\n                    partyOptions.push({\r\n                        id: party.id,\r\n                        text: party.name\r\n                    });\r\n                }\r\n            }\r\n\r\n            const difficultySection = (\r\n                <div>\r\n                    <Dropdown\r\n                        options={partyOptions}\r\n                        placeholder='select party...'\r\n                        selectedID={this.state.party ? this.state.party.id : undefined}\r\n                        select={optionID => this.selectParty(optionID)}\r\n                    />\r\n                    <DifficultyChartPanel\r\n                        encounter={this.props.selection}\r\n                        party={this.state.party}\r\n                        getMonster={(monsterName, monsterGroupName) => this.props.getMonster(monsterName, monsterGroupName)}\r\n                    />\r\n                </div>\r\n            );\r\n\r\n            const imageStyle = this.state.showDetails ? 'image rotate' : 'image';\r\n\r\n            const heading = (\r\n                <div className='heading'>\r\n                    <div className='title'>encounter</div>\r\n                    <img className={imageStyle} src={arrow} alt='arrow' onClick={() => this.toggleDetails()} />\r\n                </div>\r\n            );\r\n\r\n            const content = (\r\n                <div>\r\n                    <div className='section'>\r\n                        <input\r\n                            type='text'\r\n                            placeholder='encounter name'\r\n                            value={this.props.selection.name}\r\n                            onChange={event => this.props.changeValue('name', event.target.value)}\r\n                        />\r\n                    </div>\r\n                    <div style={{ display: this.state.showDetails ? '' : 'none' }}>\r\n                        <div className='divider' />\r\n                        {difficultySection}\r\n                    </div>\r\n                    <div className='divider' />\r\n                    <div className='section'>\r\n                        <button onClick={() => this.props.addWave()}>add a new wave</button>\r\n                        <ConfirmButton text='delete encounter' callback={() => this.props.removeEncounter()} />\r\n                    </div>\r\n                </div>\r\n            );\r\n\r\n            return (\r\n                <InfoCard getHeading={() => heading} getContent={() => content} />\r\n            );\r\n        } catch (e) {\r\n            console.error(e);\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\ninterface Props {\r\n    title: string;\r\n    getContent: () => (string | JSX.Element);\r\n}\r\n\r\nexport default class ErrorCard extends React.Component<Props> {\r\n    public static defaultProps = {\r\n        title: null\r\n    };\r\n\r\n    public render() {\r\n        try {\r\n            let heading = null;\r\n            if (this.props.title) {\r\n                heading = <div className='heading'><div className='title'>{this.props.title}</div></div>;\r\n            }\r\n\r\n            const content = this.props.getContent();\r\n\r\n            return (\r\n                <div className='card error'>\r\n                    {heading}\r\n                    <div className='card-content'>\r\n                        {content}\r\n                    </div>\r\n                </div>\r\n            );\r\n        } catch (ex) {\r\n            console.error(ex);\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport Utils from '../../utils/utils';\r\n\r\nimport { CATEGORY_TYPES, SIZE_TYPES } from '../../models/monster-group';\r\n\r\nimport Dropdown from '../controls/dropdown';\r\nimport Spin from '../controls/spin';\r\n\r\nimport arrow from '../../resources/images/down-arrow.svg';\r\n\r\ninterface Props {\r\n    filter: {\r\n        name: string,\r\n        challengeMin: number;\r\n        challengeMax: number;\r\n        category: string;\r\n        size: string;\r\n    };\r\n    changeValue: (type: 'name' | 'challengeMin' | 'challengeMax' | 'category' | 'size', value: any) => void;\r\n    nudgeValue: (type: 'challengeMin' | 'challengeMax', delta: number) => void;\r\n    resetFilter: () => void;\r\n}\r\n\r\ninterface State {\r\n    showAll: boolean;\r\n}\r\n\r\nexport default class FilterCard extends React.Component<Props, State> {\r\n    constructor(props: Props) {\r\n        super(props);\r\n        this.state = {\r\n            showAll: false\r\n        };\r\n    }\r\n\r\n    private toggleAll() {\r\n        this.setState({\r\n            showAll: !this.state.showAll\r\n        });\r\n    }\r\n\r\n    public render() {\r\n        try {\r\n            const sizes = ['all sizes'].concat(SIZE_TYPES);\r\n            const sizeOptions = sizes.map(size => ({ id: size, text: size }));\r\n\r\n            const categories = ['all types'].concat(CATEGORY_TYPES);\r\n            const catOptions = categories.map(cat => ({ id: cat, text: cat }));\r\n\r\n            let content = null;\r\n            if (this.state.showAll) {\r\n                content = (\r\n                    <div>\r\n                        <div className='section'>\r\n                            <input\r\n                                type='text'\r\n                                placeholder='name'\r\n                                value={this.props.filter.name}\r\n                                onChange={event => this.props.changeValue('name', event.target.value)}\r\n                            />\r\n                        </div>\r\n                        <Spin\r\n                            source={this.props.filter}\r\n                            name='challengeMin'\r\n                            label='min cr'\r\n                            display={value => Utils.challenge(value)}\r\n                            nudgeValue={delta => this.props.nudgeValue('challengeMin', delta)}\r\n                        />\r\n                        <Spin\r\n                            source={this.props.filter}\r\n                            name='challengeMax'\r\n                            label='max cr'\r\n                            display={value => Utils.challenge(value)}\r\n                            nudgeValue={delta => this.props.nudgeValue('challengeMax', delta)}\r\n                        />\r\n                        <Dropdown\r\n                            options={sizeOptions}\r\n                            placeholder='filter by size...'\r\n                            selectedID={this.props.filter.size}\r\n                            select={optionID => this.props.changeValue('size', optionID)}\r\n                        />\r\n                        <Dropdown\r\n                            options={catOptions}\r\n                            placeholder='filter by type...'\r\n                            selectedID={this.props.filter.category}\r\n                            select={optionID => this.props.changeValue('category', optionID)}\r\n                        />\r\n                        <div className='divider' />\r\n                        <div className='section'>\r\n                            <button onClick={() => this.props.resetFilter()}>clear filter</button>\r\n                        </div>\r\n                    </div>\r\n                );\r\n            } else {\r\n                let summary = '';\r\n                if (this.props.filter.size !== 'all sizes') {\r\n                    summary += summary ? ' ' + this.props.filter.size : this.props.filter.size;\r\n                }\r\n                if (this.props.filter.category !== 'all types') {\r\n                    summary += summary ? ' ' + this.props.filter.category : this.props.filter.category;\r\n                }\r\n                summary += ' monsters of cr ' + Utils.challenge(this.props.filter.challengeMin) + ' to ' + Utils.challenge(this.props.filter.challengeMax);\r\n\r\n                content = (\r\n                    <div>\r\n                        <div className='section'>\r\n                            <input\r\n                                type='text'\r\n                                placeholder='name'\r\n                                value={this.props.filter.name}\r\n                                onChange={event => this.props.changeValue('name', event.target.value)}\r\n                            />\r\n                        </div>\r\n                        <div className='section'>showing {summary}</div>\r\n                    </div>\r\n                );\r\n            }\r\n\r\n            return (\r\n                <div className='card'>\r\n                    <div className='heading'>\r\n                        <div className='title'>filter</div>\r\n                        <img className={this.state.showAll ? 'image rotate' : 'image'} src={arrow} alt='arrow' onClick={() => this.toggleAll()} />\r\n                    </div>\r\n                    <div className='card-content'>\r\n                        {content}\r\n                    </div>\r\n                </div>\r\n            );\r\n        } catch (e) {\r\n            console.error(e);\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport { Encounter } from '../../../models/encounter';\r\n\r\nimport InfoCard from '../info-card';\r\n\r\ninterface Props {\r\n    encounters: Encounter[];\r\n}\r\n\r\nexport default class EncounterBuilderCard extends React.Component<Props> {\r\n    private getContent() {\r\n        let action: JSX.Element | null = null;\r\n        if (this.props.encounters.length === 0) {\r\n            action = (\r\n                <div className='section'>to start building an encounter, press the button below</div>\r\n            );\r\n        } else {\r\n            action = (\r\n                <div className='section'>select an encounter from the list to add monsters to it</div>\r\n            );\r\n        }\r\n\r\n        return (\r\n            <div>\r\n                <div className='section'>on this page you can set up encounters</div>\r\n                <div className='section'>when you have created an encounter you can add monsters to it, then gauge its difficulty for a party of pcs</div>\r\n                <div className='divider'/>\r\n                {action}\r\n            </div>\r\n        );\r\n    }\r\n\r\n    public render() {\r\n        try {\r\n            return (\r\n                <InfoCard getContent={() => this.getContent()} />\r\n            );\r\n        } catch (ex) {\r\n            console.error(ex);\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport { EncounterWave } from '../../models/encounter';\r\n\r\nimport ConfirmButton from '../controls/confirm-button';\r\nimport InfoCard from './info-card';\r\n\r\ninterface Props {\r\n    wave: EncounterWave;\r\n    changeValue: (wave: EncounterWave, field: string, value: string) => void;\r\n    removeWave: (wave: EncounterWave) => void;\r\n}\r\n\r\nexport default class WaveCard extends React.Component<Props> {\r\n    public render() {\r\n        try {\r\n            const heading = (\r\n                <div className='heading'>\r\n                    <div className='title'>wave</div>\r\n                </div>\r\n            );\r\n\r\n            const content = (\r\n                <div>\r\n                    <div className='section'>\r\n                        <input\r\n                            type='text'\r\n                            placeholder='wave name'\r\n                            value={this.props.wave.name}\r\n                            onChange={event => this.props.changeValue(this.props.wave, 'name', event.target.value)}\r\n                        />\r\n                    </div>\r\n                    <div className='divider' />\r\n                    <div className='section'>\r\n                        <ConfirmButton text='delete wave' callback={() => this.props.removeWave(this.props.wave)} />\r\n                    </div>\r\n                </div>\r\n            );\r\n\r\n            return (\r\n                <InfoCard getHeading={() => heading} getContent={() => content} />\r\n            );\r\n        } catch (e) {\r\n            console.error(e);\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport { Encounter } from '../../models/encounter';\r\n\r\ninterface Props {\r\n    encounter: Encounter;\r\n    selected: boolean;\r\n    setSelection: (encounter: Encounter) => void;\r\n}\r\n\r\nexport default class EncounterListItem extends React.Component<Props> {\r\n    public render() {\r\n        try {\r\n            const slots = [];\r\n\r\n            this.props.encounter.slots.forEach(slot => {\r\n                let text = slot.monsterName || 'unnamed monster';\r\n                if (slot.count > 1) {\r\n                    text += ' x' + slot.count;\r\n                }\r\n                slots.push(<div key={slot.id} className='text'>{text}</div>);\r\n            });\r\n\r\n            if (slots.length === 0) {\r\n                slots.push(<div key='empty' className='text'>no monsters</div>);\r\n            }\r\n\r\n            this.props.encounter.waves.forEach(wave => {\r\n                slots.push(<div key={'name ' + wave.id} className='text subheading'>{wave.name || 'unnamed wave'}</div>);\r\n                wave.slots.forEach(slot => {\r\n                    let text = slot.monsterName || 'unnamed monster';\r\n                    if (slot.count > 1) {\r\n                        text += ' x' + slot.count;\r\n                    }\r\n                    slots.push(<div key={slot.id} className='text'>{text}</div>);\r\n                });\r\n                if (slots.length === 0) {\r\n                    slots.push(<div key={'empty ' + wave.id} className='text'>no monsters</div>);\r\n                }\r\n            });\r\n\r\n            return (\r\n                <div className={this.props.selected ? 'list-item selected' : 'list-item'} onClick={() => this.props.setSelection(this.props.encounter)}>\r\n                    <div className='heading'>{this.props.encounter.name || 'unnamed encounter'}</div>\r\n                    {slots}\r\n                </div>\r\n            );\r\n        } catch (e) {\r\n            console.error(e);\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport Utils from '../../utils/utils';\r\n\r\nimport { Encounter, EncounterSlot, EncounterWave } from '../../models/encounter';\r\nimport { Monster, MonsterGroup } from '../../models/monster-group';\r\nimport { Party } from '../../models/party';\r\n\r\nimport EncounterCard from '../cards/encounter-card';\r\nimport ErrorCard from '../cards/error-card';\r\nimport FilterCard from '../cards/filter-card';\r\nimport InfoCard from '../cards/info-card';\r\nimport EncounterBuilderCard from '../cards/information/encounter-builder-card';\r\nimport MonsterCard from '../cards/monster-card';\r\nimport WaveCard from '../cards/wave-card';\r\nimport EncounterListItem from '../list-items/encounter-list-item';\r\nimport CardGroup from '../panels/card-group';\r\n\r\ninterface Props {\r\n    encounters: Encounter[];\r\n    selection: Encounter | null;\r\n    parties: Party[];\r\n    library: MonsterGroup[];\r\n    showHelp: boolean;\r\n    selectEncounter: (encounter: Encounter | null) => void;\r\n    addEncounter: () => void;\r\n    removeEncounter: () => void;\r\n    addEncounterSlot: (monster: Monster, waveID: string | null) => void;\r\n    removeEncounterSlot: (encounterSlot: EncounterSlot, waveID: string | null) => void;\r\n    addWave: () => void;\r\n    removeWave: (wave: EncounterWave) => void;\r\n    changeValue: (source: any, field: string, value: any) => void;\r\n    nudgeValue: (source: any, field: string, value: number) => void;\r\n    getMonster: (monsterName: string, groupName: string) => Monster | null;\r\n}\r\n\r\ninterface State {\r\n    filter: {\r\n        name: string,\r\n        challengeMin: number;\r\n        challengeMax: number;\r\n        category: string;\r\n        size: string;\r\n    };\r\n}\r\n\r\nexport default class EncounterBuilderScreen extends React.Component<Props, State> {\r\n    constructor(props: Props) {\r\n        super(props);\r\n        this.state = {\r\n            filter: {\r\n                name: '',\r\n                challengeMin: 0,\r\n                challengeMax: 5,\r\n                category: 'all types',\r\n                size: 'all sizes'\r\n            }\r\n        };\r\n    }\r\n\r\n    private inEncounter(monster: Monster) {\r\n        let result = false;\r\n\r\n        if (this.props.selection) {\r\n            const group = Utils.getMonsterGroup(monster, this.props.library);\r\n\r\n            this.props.selection.slots.forEach(slot => {\r\n                if ((slot.monsterGroupName === group.name) && (slot.monsterName === monster.name)) {\r\n                    result = true;\r\n                }\r\n            });\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    private matchMonster(monster: Monster) {\r\n        if (monster.challenge < this.state.filter.challengeMin) {\r\n            return false;\r\n        }\r\n\r\n        if (monster.challenge > this.state.filter.challengeMax) {\r\n            return false;\r\n        }\r\n\r\n        if (this.state.filter.name !== '') {\r\n            if (!Utils.match(this.state.filter.name, monster.name)) {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        if (this.state.filter.category !== 'all types') {\r\n            if (monster.category !== this.state.filter.category) {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        if (this.state.filter.size !== 'all sizes') {\r\n            if (monster.size !== this.state.filter.size) {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    private changeFilterValue(type: 'name' | 'challengeMin' | 'challengeMax' | 'category' | 'size', value: any) {\r\n        // eslint-disable-next-line\r\n        this.state.filter[type] = value;\r\n        this.setState({\r\n            filter: this.state.filter\r\n        });\r\n    }\r\n\r\n    private nudgeFilterValue(type: 'challengeMin' | 'challengeMax', delta: number) {\r\n        const value = Utils.nudgeChallenge(this.state.filter[type], delta);\r\n        this.changeFilterValue(type, value);\r\n    }\r\n\r\n    private resetFilter() {\r\n        this.setState({\r\n            filter: {\r\n                name: '',\r\n                challengeMin: 0,\r\n                challengeMax: 5,\r\n                category: 'all types',\r\n                size: 'all sizes'\r\n            }\r\n        });\r\n    }\r\n\r\n    private getMonsterCards(slots: EncounterSlot[], waveID: string | null) {\r\n        const cards = [];\r\n\r\n        slots.forEach(slot => {\r\n            const monster = this.props.getMonster(slot.monsterName, slot.monsterGroupName);\r\n            if (monster) {\r\n                cards.push(\r\n                    <div className='column' key={monster.id}>\r\n                        <MonsterCard\r\n                            combatant={monster}\r\n                            slot={slot}\r\n                            encounter={this.props.selection as Encounter}\r\n                            mode={'view encounter'}\r\n                            nudgeValue={(source, type, delta) => this.props.nudgeValue(source, type, delta)}\r\n                            removeEncounterSlot={source => this.props.removeEncounterSlot(source, waveID)}\r\n                        />\r\n                    </div>\r\n                );\r\n            } else {\r\n                const index = slots.indexOf(slot);\r\n                const error = 'unknown monster: ' + slot.monsterName + ' in group ' + slot.monsterGroupName;\r\n                cards.push(\r\n                    <div className='column' key={index}>\r\n                        <ErrorCard\r\n                            getContent={() => <div className='section'>{error}</div>}\r\n                        />\r\n                    </div>\r\n                );\r\n            }\r\n        });\r\n\r\n        if (slots.length === 0) {\r\n            cards.push(\r\n                <div className='column' key='empty'>\r\n                    <InfoCard getContent={() => <div className='section'>no monsters</div>} />\r\n                </div>\r\n            );\r\n        }\r\n\r\n        return cards;\r\n    }\r\n\r\n    private getLibrarySection() {\r\n        if (!this.props.selection) {\r\n            return null;\r\n        }\r\n\r\n        const libraryCards = [];\r\n        libraryCards.push(\r\n            <div className='column' key='filter'>\r\n                <FilterCard\r\n                    filter={this.state.filter}\r\n                    changeValue={(type, value) => this.changeFilterValue(type, value)}\r\n                    nudgeValue={(type, delta) => this.nudgeFilterValue(type, delta)}\r\n                    resetFilter={() => this.resetFilter()}\r\n                />\r\n            </div>\r\n        );\r\n\r\n        const monsters: Monster[] = [];\r\n        if (this.props.selection) {\r\n            this.props.library.forEach(group => {\r\n                group.monsters.forEach(monster => {\r\n                    if (this.matchMonster(monster)) {\r\n                        monsters.push(monster);\r\n                    }\r\n                });\r\n            });\r\n            monsters.sort((a, b) => {\r\n                if (a.name < b.name) { return -1; }\r\n                if (a.name > b.name) { return 1; }\r\n                return 0;\r\n            });\r\n        }\r\n        monsters.forEach(monster => {\r\n            libraryCards.push(\r\n                <div className='column' key={monster.id}>\r\n                    <MonsterCard\r\n                        key={monster.id}\r\n                        combatant={monster}\r\n                        encounter={this.props.selection as Encounter}\r\n                        library={this.props.library}\r\n                        mode={'view encounter'}\r\n                        addEncounterSlot={(combatant, waveID) => this.props.addEncounterSlot(combatant, waveID)}\r\n                    />\r\n                </div>\r\n            );\r\n        });\r\n\r\n        return (\r\n            <CardGroup\r\n                heading='monster library'\r\n                content={libraryCards}\r\n                showToggle={true}\r\n            />\r\n        );\r\n    }\r\n\r\n    public render() {\r\n        try {\r\n            let help = null;\r\n            if (this.props.showHelp) {\r\n                help = (\r\n                    <EncounterBuilderCard encounters={this.props.encounters} />\r\n                );\r\n            }\r\n\r\n            const encounters = [];\r\n            for (let n = 0; n !== this.props.encounters.length; ++n) {\r\n                const e = this.props.encounters[n];\r\n                encounters.push(\r\n                    <EncounterListItem\r\n                        key={e.id}\r\n                        encounter={e}\r\n                        selected={e === this.props.selection}\r\n                        setSelection={encounter => this.props.selectEncounter(encounter)}\r\n                    />\r\n                );\r\n            }\r\n\r\n            let encounterName;\r\n            const encounterCards = [];\r\n            let waves: JSX.Element[] = [];\r\n\r\n            if (this.props.selection) {\r\n                encounterName = this.props.selection.name || 'unnamed encounter';\r\n\r\n                encounterCards.push(\r\n                    <div className='column' key='info'>\r\n                        <EncounterCard\r\n                            selection={this.props.selection}\r\n                            parties={this.props.parties}\r\n                            changeValue={(type, value) => this.props.changeValue(this.props.selection, type, value)}\r\n                            addWave={() => this.props.addWave()}\r\n                            removeEncounter={() => this.props.removeEncounter()}\r\n                            getMonster={(monsterName, monsterGroupName) => this.props.getMonster(monsterName, monsterGroupName)}\r\n                        />\r\n                    </div>\r\n                );\r\n\r\n                this.getMonsterCards(this.props.selection.slots, null)\r\n                    .forEach(card => encounterCards.push(card));\r\n\r\n                waves = this.props.selection.waves.map(w => {\r\n                    const waveCards = [];\r\n                    waveCards.push(\r\n                        <div className='column' key='info'>\r\n                            <WaveCard\r\n                                wave={w}\r\n                                removeWave={wave => this.props.removeWave(wave)}\r\n                                changeValue={(source, field, value) => this.props.changeValue(source, field, value)}\r\n                            />\r\n                        </div>\r\n                    );\r\n\r\n                    this.getMonsterCards(w.slots, w.id)\r\n                        .forEach(card => waveCards.push(card));\r\n\r\n                    return (\r\n                        <CardGroup\r\n                            key={w.id}\r\n                            heading={w.name || 'unnamed wave'}\r\n                            content={waveCards}\r\n                            showToggle={true}\r\n                        />\r\n                    );\r\n                });\r\n            }\r\n\r\n            return (\r\n                <div className='encounter-builder row collapse'>\r\n                    <div className='columns small-4 medium-4 large-3 scrollable list-column'>\r\n                        {help}\r\n                        <button onClick={() => this.props.addEncounter()}>add a new encounter</button>\r\n                        {encounters}\r\n                    </div>\r\n                    <div className='columns small-8 medium-8 large-9 scrollable'>\r\n                        <CardGroup\r\n                            content={encounterCards}\r\n                            heading={encounterName}\r\n                            showClose={this.props.selection !== null}\r\n                            close={() => this.props.selectEncounter(null)}\r\n                        />\r\n                        {waves}\r\n                        {this.getLibrarySection()}\r\n                    </div>\r\n                </div>\r\n            );\r\n        } catch (e) {\r\n            console.error(e);\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport { MonsterGroup } from '../../models/monster-group';\r\n\r\ninterface Props {\r\n    library: MonsterGroup[];\r\n    addOpenGameContent: () => void;\r\n}\r\n\r\nexport default class HomeScreen extends React.Component<Props> {\r\n    public render() {\r\n        try {\r\n            let monsters = null;\r\n            if (this.props.library.length === 0) {\r\n                monsters = (\r\n                    <div>\r\n                        <div className='divider' />\r\n                        <div className='text'>\r\n                            <div>\r\n                                since your collection of monsters is empty, you might want to start by pressing the button below to add monsters from the&nbsp;\r\n                                <a href='http://dnd.wizards.com/articles/features/systems-reference-document-srd' target='_blank' rel='noopener noreferrer'>\r\n                                    system reference document\r\n                                </a>\r\n                            </div>\r\n                        </div>\r\n                        <div className='text'>\r\n                            <button onClick={() => this.props.addOpenGameContent()}>add monsters</button>\r\n                        </div>\r\n                    </div>\r\n                );\r\n            }\r\n\r\n            return (\r\n                <div className='home scrollable'>\r\n                    <div className='vertical-center-outer'>\r\n                        <div className='vertical-center-middle'>\r\n                            <div className='vertical-center-inner'>\r\n                                <div className='welcome-panel'>\r\n                                    <div className='heading'>welcome to <b>dojo</b></div>\r\n                                    <div className='text'>\r\n                                        <div><b>dojo</b> is an app for dms of dungeons and dragons fifth edition</div>\r\n                                    </div>\r\n                                    <div className='text'>\r\n                                        <div>\r\n                                            with <b>dojo</b> you can:\r\n                                            <ul>\r\n                                                <li>build unique, challenging monsters</li>\r\n                                                <li>create encounters of just the right difficulty for your players</li>\r\n                                                <li>design intricate tactical maps</li>\r\n                                                <li>run combat without the book-keeping</li>\r\n                                            </ul>\r\n                                        </div>\r\n                                    </div>\r\n                                    {monsters}\r\n                                    <div className='divider' />\r\n                                    <div className='text'>\r\n                                        <div>use the buttons at the bottom of the screen to access the app's features</div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            );\r\n        } catch (ex) {\r\n            console.error(ex);\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport { MapFolio } from '../../../models/map-folio';\r\n\r\nimport InfoCard from '../info-card';\r\n\r\ninterface Props {\r\n    mapFolios: MapFolio[];\r\n}\r\n\r\nexport default class MapFoliosCard extends React.Component<Props> {\r\n    private getContent() {\r\n        let action: JSX.Element | null = null;\r\n        if (this.props.mapFolios.length === 0) {\r\n            action = (\r\n                <div className='section'>to start a new folio, press the button below</div>\r\n            );\r\n        } else {\r\n            action = (\r\n                <div className='section'>select a map folio from the list to see the maps it contains</div>\r\n            );\r\n        }\r\n\r\n        return (\r\n            <div>\r\n                <div className='section'>on this page you can set up folios containing tactical maps</div>\r\n                <div className='section'>when you have created a map you can use it in encounters</div>\r\n                <div className='divider'/>\r\n                {action}\r\n            </div>\r\n        );\r\n    }\r\n\r\n    public render() {\r\n        try {\r\n            return (\r\n                <InfoCard getContent={() => this.getContent()} />\r\n            );\r\n        } catch (ex) {\r\n            console.error(ex);\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport { Map } from '../../models/map-folio';\r\n\r\nimport ConfirmButton from '../controls/confirm-button';\r\nimport MapPanel from '../panels/map-panel';\r\n\r\ninterface Props {\r\n    map: Map;\r\n    changeValue: (map: Map, field: string, value: string) => void;\r\n    editMap: (map: Map) => void;\r\n    removeMap: (map: Map) => void;\r\n}\r\n\r\nexport default class MapCard extends React.Component<Props> {\r\n    public render() {\r\n        try {\r\n            return (\r\n                <div className='card map'>\r\n                    <div className='heading'>\r\n                        <div className='title'>{this.props.map.name || 'unnamed map'}</div>\r\n                    </div>\r\n                    <div className='card-content'>\r\n                        <div className='section'>\r\n                            <input\r\n                                type='text'\r\n                                placeholder='map name'\r\n                                value={this.props.map.name}\r\n                                onChange={event => this.props.changeValue(this.props.map, 'name', event.target.value)}\r\n                            />\r\n                        </div>\r\n                        <div className='divider' />\r\n                        <div className='section centered'>\r\n                            <MapPanel\r\n                                map={this.props.map}\r\n                                mode='thumbnail'\r\n                            />\r\n                        </div>\r\n                        <div className='divider' />\r\n                        <div className='section'>\r\n                            <button onClick={() => this.props.editMap(this.props.map)}>edit map</button>\r\n                            <ConfirmButton text='delete map' callback={() => this.props.removeMap(this.props.map)} />\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            );\r\n        } catch (e) {\r\n            console.error(e);\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport { MapFolio } from '../../models/map-folio';\r\n\r\nimport ConfirmButton from '../controls/confirm-button';\r\nimport InfoCard from './info-card';\r\n\r\ninterface Props {\r\n    selection: MapFolio;\r\n    changeValue: (source: MapFolio, field: string, value: string) => void;\r\n    addMap: () => void;\r\n    removeMapFolio: () => void;\r\n}\r\n\r\nexport default class MapFolioCard extends React.Component<Props> {\r\n    public render() {\r\n        try {\r\n            const heading = (\r\n                <div className='heading'>\r\n                    <div className='title'>map folio</div>\r\n                </div>\r\n            );\r\n\r\n            const content = (\r\n                <div>\r\n                    <div className='section'>\r\n                        <input\r\n                            type='text'\r\n                            placeholder='folio name'\r\n                            value={this.props.selection.name}\r\n                            onChange={event => this.props.changeValue(this.props.selection, 'name', event.target.value)}\r\n                        />\r\n                    </div>\r\n                    <div className='divider' />\r\n                    <div className='section'>\r\n                        <button onClick={() => this.props.addMap()}>add a new map</button>\r\n                        <ConfirmButton text='delete folio' callback={() => this.props.removeMapFolio()} />\r\n                    </div>\r\n                </div>\r\n            );\r\n\r\n            return (\r\n                <InfoCard getHeading={() => heading} getContent={() => content} />\r\n            );\r\n        } catch (e) {\r\n            console.error(e);\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport { MapFolio } from '../../models/map-folio';\r\n\r\ninterface Props {\r\n    mapFolio: MapFolio;\r\n    selected: boolean;\r\n    setSelection: (mapFolio: MapFolio) => void;\r\n}\r\n\r\nexport default class MapFolioListItem extends React.Component<Props> {\r\n    public render() {\r\n        try {\r\n            const maps = [];\r\n            for (let n = 0; n !== this.props.mapFolio.maps.length; ++n) {\r\n                const map = this.props.mapFolio.maps[n];\r\n                const name = map.name || 'unnamed map';\r\n                maps.push(<div key={map.id} className='text'>{name}</div>);\r\n            }\r\n            if (maps.length === 0) {\r\n                maps.push(<div key='empty' className='text'>no maps</div>);\r\n            }\r\n\r\n            return (\r\n                <div className={this.props.selected ? 'list-item selected' : 'list-item'} onClick={() => this.props.setSelection(this.props.mapFolio)}>\r\n                    <div className='heading'>{this.props.mapFolio.name || 'unnamed folio'}</div>\r\n                    {maps}\r\n                </div>\r\n            );\r\n        } catch (e) {\r\n            console.error(e);\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport { Map, MapFolio } from '../../models/map-folio';\r\n\r\nimport InfoCard from '../cards/info-card';\r\nimport MapFoliosCard from '../cards/information/map-folios-card';\r\nimport MapCard from '../cards/map-card';\r\nimport MapFolioCard from '../cards/map-folio-card';\r\nimport MapFolioListItem from '../list-items/map-folio-list-item';\r\nimport CardGroup from '../panels/card-group';\r\n\r\ninterface Props {\r\n    mapFolios: MapFolio[];\r\n    selection: MapFolio | null;\r\n    showHelp: boolean;\r\n    selectMapFolio: (mapFolio: MapFolio | null) => void;\r\n    addMapFolio: () => void;\r\n    removeMapFolio: () => void;\r\n    addMap: () => void;\r\n    editMap: (map: Map) => void;\r\n    removeMap: (map: Map) => void;\r\n    changeValue: (source: {}, field: string, value: any) => void;\r\n}\r\n\r\nexport default class MapFoliosScreen extends React.Component<Props> {\r\n    public render() {\r\n        try {\r\n            let help = null;\r\n            if (this.props.showHelp) {\r\n                help = (\r\n                    <MapFoliosCard mapFolios={this.props.mapFolios} />\r\n                );\r\n            }\r\n\r\n            const folios = [];\r\n            for (let n = 0; n !== this.props.mapFolios.length; ++n) {\r\n                const mapFolio = this.props.mapFolios[n];\r\n                folios.push(\r\n                    <MapFolioListItem\r\n                        key={mapFolio.id}\r\n                        mapFolio={mapFolio}\r\n                        selected={mapFolio === this.props.selection}\r\n                        setSelection={f => this.props.selectMapFolio(f)}\r\n                    />\r\n                );\r\n            }\r\n\r\n            let folio = null;\r\n            if (this.props.selection) {\r\n                const folioCards = [];\r\n\r\n                folioCards.push(\r\n                    <div className='column' key='info'>\r\n                        <MapFolioCard\r\n                            selection={this.props.selection}\r\n                            addMap={() => this.props.addMap()}\r\n                            removeMapFolio={() => this.props.removeMapFolio()}\r\n                            changeValue={(source, field, value) => this.props.changeValue(source, field, value)}\r\n                        />\r\n                    </div>\r\n                );\r\n\r\n                this.props.selection.maps.forEach(m => {\r\n                    folioCards.push(\r\n                        <div className='column' key={m.id}>\r\n                            <MapCard\r\n                                map={m}\r\n                                editMap={map => this.props.editMap(map)}\r\n                                removeMap={map => this.props.removeMap(map)}\r\n                                changeValue={(source, type, value) => this.props.changeValue(source, type, value)}\r\n                            />\r\n                        </div>\r\n                    );\r\n                });\r\n\r\n                if (this.props.selection.maps.length === 0) {\r\n                    folioCards.push(\r\n                        <div className='column' key='empty'>\r\n                            <InfoCard getContent={() => <div className='section'>no maps</div>} />\r\n                        </div>\r\n                    );\r\n                }\r\n\r\n                folio = (\r\n                    <div>\r\n                        <CardGroup\r\n                            content={folioCards}\r\n                            heading={this.props.selection.name || 'unnamed folio'}\r\n                            showClose={this.props.selection !== null}\r\n                            close={() => this.props.selectMapFolio(null)}\r\n                        />\r\n                    </div>\r\n                );\r\n            }\r\n\r\n            return (\r\n                <div className='map-builder row collapse'>\r\n                    <div className='columns small-4 medium-4 large-3 scrollable list-column'>\r\n                        {help}\r\n                        <button onClick={() => this.props.addMapFolio()}>add a new map folio</button>\r\n                        {folios}\r\n                    </div>\r\n                    <div className='columns small-8 medium-8 large-9 scrollable'>\r\n                        {folio}\r\n                    </div>\r\n                </div>\r\n            );\r\n        } catch (e) {\r\n            console.error(e);\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport InfoCard from '../info-card';\r\n\r\nexport default class MonsterLibraryCard extends React.Component {\r\n    private getContent() {\r\n        return (\r\n            <div>\r\n                <div className='section'>you can maintain your menagerie of monsters here</div>\r\n                <div className='divider'/>\r\n                <div className='section'>select a monster group from the list to see stat blocks for monsters in that group</div>\r\n                <div className='section'>to quickly find a monster, type its name into the filter box</div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    public render() {\r\n        return (\r\n            <InfoCard getContent={() => this.getContent()} />\r\n        );\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport { MonsterGroup } from '../../models/monster-group';\r\n\r\nimport ConfirmButton from '../controls/confirm-button';\r\nimport InfoCard from './info-card';\r\n\r\ninterface Props {\r\n    selection: MonsterGroup;\r\n    filter: string | null;\r\n    changeValue: (field: string, value: string) => void;\r\n    addMonster: () => void;\r\n    sortMonsters: () => void;\r\n    removeMonsterGroup: () => void;\r\n}\r\n\r\nexport default class MonsterGroupCard extends React.Component<Props> {\r\n    public render() {\r\n        try {\r\n            const heading = (\r\n                <div className='heading'>\r\n                    <div className='title'>monster group</div>\r\n                </div>\r\n            );\r\n\r\n            const content = (\r\n                <div>\r\n                    <div className='section'>\r\n                        <input\r\n                            type='text'\r\n                            placeholder='group name'\r\n                            value={this.props.selection.name}\r\n                            disabled={!!this.props.filter}\r\n                            onChange={event => this.props.changeValue('name', event.target.value)}\r\n                        />\r\n                    </div>\r\n                    <div className='divider' />\r\n                    <div className='section'>\r\n                        <button className={this.props.filter ? 'disabled' : ''} onClick={() => this.props.addMonster()}>add a new monster</button>\r\n                        <button className={this.props.filter ? 'disabled' : ''} onClick={() => this.props.sortMonsters()}>sort monsters</button>\r\n                        <ConfirmButton text='delete group' callback={() => this.props.removeMonsterGroup()} />\r\n                    </div>\r\n                </div>\r\n            );\r\n\r\n            return (\r\n                <InfoCard getHeading={() => heading} getContent={() => content} />\r\n            );\r\n        } catch (e) {\r\n            console.error(e);\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport Utils from '../../utils/utils';\r\n\r\nimport { MonsterGroup } from '../../models/monster-group';\r\n\r\ninterface Props {\r\n    group: MonsterGroup;\r\n    selected: boolean;\r\n    filter: string;\r\n    setSelection: (group: MonsterGroup) => void;\r\n}\r\n\r\nexport default class MonsterGroupListItem extends React.Component<Props> {\r\n    public render() {\r\n        try {\r\n            const matchGroup = Utils.match(this.props.filter, this.props.group.name);\r\n\r\n            const monsters = [];\r\n            for (let n = 0; n !== this.props.group.monsters.length; ++n) {\r\n                const monster = this.props.group.monsters[n];\r\n                const matchMonster = Utils.match(this.props.filter, monster.name);\r\n                if (matchGroup || matchMonster) {\r\n                    let name = monster.name;\r\n                    if (!name) {\r\n                        name = 'unnamed monster';\r\n                    }\r\n                    monsters.push(<div key={monster.id} className='text'>{name}</div>);\r\n                }\r\n            }\r\n            if (monsters.length === 0) {\r\n                monsters.push(<div key='empty' className='text'>no monsters</div>);\r\n            }\r\n\r\n            return (\r\n                <div className={this.props.selected ? 'list-item selected' : 'list-item'} onClick={() => this.props.setSelection(this.props.group)}>\r\n                    <div className='heading'>{this.props.group.name || 'unnamed group'}</div>\r\n                    {monsters}\r\n                </div>\r\n            );\r\n        } catch (e) {\r\n            console.error(e);\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport Utils from '../../utils/utils';\r\n\r\nimport { Monster, MonsterGroup } from '../../models/monster-group';\r\n\r\nimport InfoCard from '../cards/info-card';\r\nimport MonsterLibraryCard from '../cards/information/monster-library-card';\r\nimport MonsterCard from '../cards/monster-card';\r\nimport MonsterGroupCard from '../cards/monster-group-card';\r\nimport MonsterGroupListItem from '../list-items/monster-group-list-item';\r\nimport CardGroup from '../panels/card-group';\r\n\r\ninterface Props {\r\n    library: MonsterGroup[];\r\n    selection: MonsterGroup | null;\r\n    showHelp: boolean;\r\n    filter: string;\r\n    selectMonsterGroup: (group: MonsterGroup | null) => void;\r\n    addMonsterGroup: () => void;\r\n    removeMonsterGroup: () => void;\r\n    addMonster: () => void;\r\n    removeMonster: (monster: Monster) => void;\r\n    editMonster: (monster: Monster) => void;\r\n    cloneMonster: (monster: Monster, name: string) => void;\r\n    sortMonsters: () => void;\r\n    moveToGroup: (monster: Monster, groupID: string) => void;\r\n    changeValue: (source: any, field: string, value: any) => void;\r\n    nudgeValue: (source: any, field: string, value: number) => void;\r\n}\r\n\r\nexport default class MonsterLibraryScreen extends React.Component<Props> {\r\n    private showMonsterGroup(group: MonsterGroup) {\r\n        let result = Utils.match(this.props.filter, group.name);\r\n\r\n        if (!result) {\r\n            group.monsters.forEach(monster => {\r\n                result = Utils.match(this.props.filter, monster.name) || result;\r\n            });\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    public render() {\r\n        try {\r\n            let help = null;\r\n            if (this.props.showHelp) {\r\n                help = (\r\n                    <MonsterLibraryCard />\r\n                );\r\n            }\r\n\r\n            const listItems = [];\r\n            for (let n = 0; n !== this.props.library.length; ++n) {\r\n                const group = this.props.library[n];\r\n                if (this.showMonsterGroup(group)) {\r\n                    listItems.push(\r\n                        <MonsterGroupListItem\r\n                            key={group.id}\r\n                            group={group}\r\n                            filter={this.props.filter}\r\n                            selected={group === this.props.selection}\r\n                            setSelection={grp => this.props.selectMonsterGroup(grp)}\r\n                        />\r\n                    );\r\n                }\r\n            }\r\n\r\n            const cards = [];\r\n\r\n            if (this.props.selection) {\r\n                cards.push(\r\n                    <div className='column' key='info'>\r\n                        <MonsterGroupCard\r\n                            selection={this.props.selection}\r\n                            filter={this.props.filter}\r\n                            addMonster={() => this.props.addMonster()}\r\n                            sortMonsters={() => this.props.sortMonsters()}\r\n                            changeValue={(type, value) => this.props.changeValue(this.props.selection, type, value)}\r\n                            removeMonsterGroup={() => this.props.removeMonsterGroup()}\r\n                        />\r\n                    </div>\r\n                );\r\n\r\n                const monsters = this.props.selection.monsters.filter(monster => {\r\n                    return Utils.match(this.props.filter, monster.name);\r\n                });\r\n\r\n                if (monsters.length !== 0) {\r\n                    monsters.forEach(m => {\r\n                        cards.push(\r\n                            <div className='column' key={m.id}>\r\n                                <MonsterCard\r\n                                    combatant={m}\r\n                                    mode={'view editable'}\r\n                                    library={this.props.library}\r\n                                    changeValue={(source, type, value) => this.props.changeValue(source, type, value)}\r\n                                    nudgeValue={(source, type, delta) => this.props.nudgeValue(source, type, delta)}\r\n                                    moveToGroup={(monster, groupID) => this.props.moveToGroup(monster, groupID)}\r\n                                    removeMonster={monster => this.props.removeMonster(monster)}\r\n                                    editMonster={monster => this.props.editMonster(monster)}\r\n                                    cloneMonster={(monster, monsterName) => this.props.cloneMonster(monster, monsterName)}\r\n                                />\r\n                            </div>\r\n                        );\r\n                    });\r\n                } else {\r\n                    cards.push(\r\n                        <div className='column' key='empty'>\r\n                            <InfoCard getContent={() => <div className='section'>no monsters</div>} />\r\n                        </div>\r\n                    );\r\n                }\r\n            }\r\n\r\n            let name;\r\n            if (this.props.selection) {\r\n                name = this.props.selection.name;\r\n                if (!name) {\r\n                    name = 'unnamed group';\r\n                }\r\n            }\r\n\r\n            return (\r\n                <div className='monster-library row collapse'>\r\n                    <div className='columns small-4 medium-4 large-3 scrollable list-column'>\r\n                        {help}\r\n                        <button onClick={() => this.props.addMonsterGroup()}>add a new monster group</button>\r\n                        {listItems}\r\n                    </div>\r\n                    <div className='columns small-8 medium-8 large-9 scrollable'>\r\n                        <CardGroup\r\n                            content={cards}\r\n                            heading={name}\r\n                            showClose={this.props.selection !== null}\r\n                            close={() => this.props.selectMonsterGroup(null)}\r\n                        />\r\n                    </div>\r\n                </div>\r\n            );\r\n        } catch (e) {\r\n            console.error(e);\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport { Party } from '../../../models/party';\r\n\r\nimport InfoCard from '../info-card';\r\n\r\ninterface Props {\r\n    parties: Party[];\r\n}\r\n\r\nexport default class PartiesCard extends React.Component<Props> {\r\n    private getContent() {\r\n        let action: JSX.Element | null = null;\r\n        if (this.props.parties.length === 0) {\r\n            action = (\r\n                <div className='section'>to start adding a party, press the button below</div>\r\n            );\r\n        } else {\r\n            action = (\r\n                <div className='section'>select a party from the list to see pc details</div>\r\n            );\r\n        }\r\n\r\n        return (\r\n            <div>\r\n                <div className='section'>this page is where you can tell dojo all about your pcs</div>\r\n                <div className='section'>you can add a party for each of your gaming groups</div>\r\n                <div className='divider'/>\r\n                {action}\r\n            </div>\r\n        );\r\n    }\r\n\r\n    public render() {\r\n        try {\r\n            return (\r\n                <InfoCard getContent={() => this.getContent()} />\r\n            );\r\n        } catch (ex) {\r\n            console.error(ex);\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport { Party } from '../../models/party';\r\n\r\nimport ConfirmButton from '../controls/confirm-button';\r\nimport InfoCard from './info-card';\r\n\r\ninterface Props {\r\n    selection: Party;\r\n    changeValue: (field: string, value: string) => void;\r\n    addPC: () => void;\r\n    sortPCs: () => void;\r\n    removeParty: () => void;\r\n}\r\n\r\nexport default class PartyCard extends React.Component<Props> {\r\n    public render() {\r\n        try {\r\n            const activePCs = this.props.selection.pcs.filter(pc => pc.active);\r\n\r\n            const languages = activePCs\r\n                .map(pc => pc.languages)\r\n                .join(', ')\r\n                .split(/[ ,;]+/)\r\n                .reduce((array: string[], value) => {\r\n                    if (array.indexOf(value) === -1) {\r\n                        array.push(value);\r\n                    }\r\n                    return array;\r\n                }, [])\r\n                .sort((a, b) => {\r\n                    if (a === 'Common') {\r\n                        return -1;\r\n                    }\r\n                    if (b === 'Common') {\r\n                        return 1;\r\n                    }\r\n                    return a.localeCompare(b);\r\n                })\r\n                .join(', ');\r\n\r\n            let insightSummary = '-';\r\n            let investigationSummary = '-';\r\n            let perceptionSummary = '-';\r\n\r\n            if (activePCs.length !== 0) {\r\n                const insight: { min: number | null, max: number | null } = { min: null, max: null };\r\n                const invest: { min: number | null, max: number | null } = { min: null, max: null };\r\n                const percep: { min: number | null, max: number | null } = { min: null, max: null };\r\n\r\n                activePCs.forEach(pc => {\r\n                    insight.min = insight.min === null ? pc.passiveInsight : Math.min(insight.min, pc.passiveInsight);\r\n                    insight.max = insight.max === null ? pc.passiveInsight : Math.max(insight.max, pc.passiveInsight);\r\n                    invest.min = invest.min === null ? pc.passiveInvestigation : Math.min(invest.min, pc.passiveInvestigation);\r\n                    invest.max = invest.max === null ? pc.passiveInvestigation : Math.max(invest.max, pc.passiveInvestigation);\r\n                    percep.min = percep.min === null ? pc.passivePerception : Math.min(percep.min, pc.passivePerception);\r\n                    percep.max = percep.max === null ? pc.passivePerception : Math.max(percep.max, pc.passivePerception);\r\n                });\r\n\r\n                insightSummary = insight.min === insight.max ? (insight.min as number).toString() : insight.min + ' - ' + insight.max;\r\n                investigationSummary = invest.min === invest.max ? (invest.min as number).toString() : invest.min + ' - ' + invest.max;\r\n                perceptionSummary = percep.min === percep.max ? (percep.min as number).toString() : percep.min + ' - ' + percep.max;\r\n            }\r\n\r\n            const heading = (\r\n                <div className='heading'>\r\n                    <div className='title'>party</div>\r\n                </div>\r\n            );\r\n\r\n            const content = (\r\n                <div>\r\n                    <div className='section'>\r\n                        <input\r\n                            type='text'\r\n                            placeholder='party name'\r\n                            value={this.props.selection.name}\r\n                            onChange={event => this.props.changeValue('name', event.target.value)}\r\n                        />\r\n                    </div>\r\n                    <div className='divider' />\r\n                    <div className='section' style={{ display: languages !== '' ? 'block' : 'none' }}>\r\n                        <div className='subheading'>languages</div>\r\n                    </div>\r\n                    <div className='section'>\r\n                        {languages}\r\n                    </div>\r\n                    <div className='section'>\r\n                        <div className='subheading'>passive skills</div>\r\n                    </div>\r\n                    <div className='table'>\r\n                        <div>\r\n                            <div className='cell three'><b>insight</b></div>\r\n                            <div className='cell three'><b>invest.</b></div>\r\n                            <div className='cell three'><b>percep.</b></div>\r\n                        </div>\r\n                        <div>\r\n                            <div className='cell three'>{insightSummary}</div>\r\n                            <div className='cell three'>{investigationSummary}</div>\r\n                            <div className='cell three'>{perceptionSummary}</div>\r\n                        </div>\r\n                    </div>\r\n                    <div className='divider' />\r\n                    <div className='section'>\r\n                    <button onClick={() => this.props.addPC()}>add a new pc</button>\r\n                        <button onClick={() => this.props.sortPCs()}>sort pcs</button>\r\n                        <ConfirmButton text='delete party' callback={() => this.props.removeParty()} />\r\n                    </div>\r\n                </div>\r\n            );\r\n\r\n            return (\r\n                <InfoCard getHeading={() => heading} getContent={() => content} />\r\n            );\r\n        } catch (e) {\r\n            console.error(e);\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport { Party } from '../../models/party';\r\n\r\ninterface Props {\r\n    party: Party;\r\n    selected: boolean;\r\n    setSelection: (party: Party) => void;\r\n}\r\n\r\nexport default class PartyListItem extends React.Component<Props> {\r\n    public render() {\r\n        try {\r\n            const pcs = [];\r\n            for (let n = 0; n !== this.props.party.pcs.length; ++n) {\r\n                const pc = this.props.party.pcs[n];\r\n                let name = pc.name;\r\n                if (pc.player) {\r\n                    name += ' (' + pc.player + ')';\r\n                }\r\n                if (!name) {\r\n                    name = 'unnamed pc';\r\n                }\r\n                pcs.push(<div key={pc.id} className='text'>{name}</div>);\r\n            }\r\n            if (pcs.length === 0) {\r\n                pcs.push(<div key='empty' className='text'>no pcs</div>);\r\n            }\r\n\r\n            return (\r\n                <div className={this.props.selected ? 'list-item selected' : 'list-item'} onClick={() => this.props.setSelection(this.props.party)}>\r\n                    <div className='heading'>{this.props.party.name || 'unnamed party'}</div>\r\n                    {pcs}\r\n                </div>\r\n            );\r\n        } catch (e) {\r\n            console.error(e);\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport { Party, PC } from '../../models/party';\r\n\r\nimport InfoCard from '../cards/info-card';\r\nimport PartiesCard from '../cards/information/parties-card';\r\nimport PartyCard from '../cards/party-card';\r\nimport PCCard from '../cards/pc-card';\r\nimport PartyListItem from '../list-items/party-list-item';\r\nimport CardGroup from '../panels/card-group';\r\n\r\ninterface Props {\r\n    parties: Party[];\r\n    selection: Party | null;\r\n    showHelp: boolean;\r\n    selectParty: (party: Party | null) => void;\r\n    addParty: () => void;\r\n    removeParty: () => void;\r\n    addPC: () => void;\r\n    removePC: (pc: PC) => void;\r\n    sortPCs: () => void;\r\n    changeValue: (source: any, field: string, value: any) => void;\r\n    nudgeValue: (source: any, field: string, value: number) => void;\r\n}\r\n\r\nexport default class PartiesScreen extends React.Component<Props> {\r\n    public render() {\r\n        try {\r\n            let help = null;\r\n            if (this.props.showHelp) {\r\n                help = (\r\n                    <PartiesCard parties={this.props.parties}/>\r\n                );\r\n            }\r\n\r\n            const parties = [];\r\n            for (let n = 0; n !== this.props.parties.length; ++n) {\r\n                const p = this.props.parties[n];\r\n                parties.push(\r\n                    <PartyListItem\r\n                        key={p.id}\r\n                        party={p}\r\n                        selected={p === this.props.selection}\r\n                        setSelection={party => this.props.selectParty(party)}\r\n                    />\r\n                );\r\n            }\r\n\r\n            const activeCards: JSX.Element[] = [];\r\n            const inactiveCards: JSX.Element[] = [];\r\n\r\n            if (this.props.selection) {\r\n                activeCards.push(\r\n                    <div className='column' key='info'>\r\n                        <PartyCard\r\n                            selection={this.props.selection}\r\n                            addPC={() => this.props.addPC()}\r\n                            sortPCs={() => this.props.sortPCs()}\r\n                            changeValue={(type, value) => this.props.changeValue(this.props.selection, type, value)}\r\n                            removeParty={() => this.props.removeParty()}\r\n                        />\r\n                    </div>\r\n                );\r\n\r\n                const activePCs = this.props.selection.pcs.filter(pc => pc.active);\r\n                activePCs.forEach(activePC => {\r\n                    activeCards.push(\r\n                        <div className='column' key={activePC.id}>\r\n                            <PCCard\r\n                                combatant={activePC}\r\n                                mode={'edit'}\r\n                                changeValue={(pc, type, value) => this.props.changeValue(pc, type, value)}\r\n                                nudgeValue={(pc, type, delta) => this.props.nudgeValue(pc, type, delta)}\r\n                                removePC={pc => this.props.removePC(pc)}\r\n                            />\r\n                        </div>\r\n                    );\r\n                });\r\n\r\n                const inactivePCs = this.props.selection.pcs.filter(pc => !pc.active);\r\n                inactivePCs.forEach(inactivePC => {\r\n                    inactiveCards.push(\r\n                        <div className='column' key={inactivePC.id}>\r\n                            <PCCard\r\n                                combatant={inactivePC}\r\n                                mode={'edit'}\r\n                                changeValue={(pc, type, value) => this.props.changeValue(pc, type, value)}\r\n                                nudgeValue={(pc, type, delta) => this.props.nudgeValue(pc, type, delta)}\r\n                                removePC={pc => this.props.removePC(pc)}\r\n                            />\r\n                        </div>\r\n                    );\r\n                });\r\n\r\n                if (activePCs.length === 0) {\r\n                    activeCards.push(\r\n                        <div className='column' key='empty'>\r\n                            <InfoCard getContent={() => <div className='section'>no pcs</div>} />\r\n                        </div>\r\n                    );\r\n                }\r\n            }\r\n\r\n            let name;\r\n            if (this.props.selection) {\r\n                name = this.props.selection.name || 'unnamed party';\r\n            }\r\n\r\n            return (\r\n                <div className='parties row collapse'>\r\n                    <div className='columns small-4 medium-4 large-3 scrollable list-column'>\r\n                        {help}\r\n                        <button onClick={() => this.props.addParty()}>add a new party</button>\r\n                        {parties}\r\n                    </div>\r\n                    <div className='columns small-8 medium-8 large-9 scrollable'>\r\n                        <CardGroup\r\n                            content={activeCards}\r\n                            heading={name}\r\n                            showClose={this.props.selection !== null}\r\n                            close={() => this.props.selectParty(null)}\r\n                            hidden={!this.props.selection}\r\n                        />\r\n                        <CardGroup\r\n                            content={inactiveCards}\r\n                            heading='inactive pcs'\r\n                            showClose={false}\r\n                            hidden={inactiveCards.length === 0}\r\n                        />\r\n                    </div>\r\n                </div>\r\n            );\r\n        } catch (e) {\r\n            console.error(e);\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport Checkbox from '../controls/checkbox';\r\nimport ConfirmButton from '../controls/confirm-button';\r\n\r\nimport pkg from '../../../package.json';\r\n\r\ninterface Props {\r\n    options: {\r\n        showHelp: boolean;\r\n    };\r\n    resetAll: () => void;\r\n    changeValue: (source: {}, field: string, value: any) => void;\r\n}\r\n\r\nexport default class AboutModal extends React.Component<Props> {\r\n    public render() {\r\n        try {\r\n            /* tslint:disable:max-line-length */\r\n            return (\r\n                <div className='about'>\r\n                    <div className='row'>\r\n                        <div className='columns small-6 medium-6 large-6 list-column'>\r\n                            <div className='heading'>about</div>\r\n                            <div className='section'>dojo by <a href='mailto:andy.aiken@live.co.uk'>andy aiken</a></div>\r\n                            <div className='section'>version <b>{pkg.version}</b></div>\r\n                            <div className='section'>if you would like to contribut to this project, you can do so <a href='https://github.com/andyaiken/dojo' target='_blank' rel='noopener noreferrer'>here</a></div>\r\n                            <div className='section'>dungeons and dragons copyright wizards of the coast</div>\r\n                        </div>\r\n                        <div className='columns small-6 medium-6 large-6 list-column'>\r\n                            <div className='heading'>options</div>\r\n                            <ConfirmButton text='clear all data' callback={() => this.props.resetAll()} />\r\n                            <Checkbox\r\n                                label='show help cards'\r\n                                checked={this.props.options.showHelp}\r\n                                changeValue={value => this.props.changeValue(this.props.options, 'showHelp', value)}\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                    <div className='row'>\r\n                        <div className='columns small-12 medium-12 large-12 list-column'>\r\n                            <div className='heading'>open game license</div>\r\n                            <div className='section'>The following text is the property of Wizards of the Coast, Inc. and is Copyright 2000 Wizards of the Coast, Inc ('Wizards'). All Rights Reserved.</div>\r\n                            <ol>\r\n                                <li>Definitions: (a)'Contributors' means the copyright and/or trademark owners who have contributed Open Game Content; (b)'Derivative Material' means copyrighted material including derivative works and translations (including into other computer languages), potation, modification, correction, addition, extension, upgrade, improvement, compilation, abridgment or other form in which an existing work may be recast, transformed or adapted; (c) 'Distribute' means to reproduce, license, rent, lease, sell, broadcast, publicly display, transmit or otherwise distribute; (d)'Open Game Content' means the game mechanic and includes the methods, procedures, processes and routines to the extent such content does not embody the Product Identity and is an enhancement over the prior art and any additional content clearly identified as Open Game Content by the Contributor, and means any work covered by this License, including translations and derivative works under copyright law, but specifically excludes Product Identity. (e) 'Product Identity' means product and product line names, logos and identifying marks including trade dress; artifacts; creatures characters; stories, storylines, plots, thematic elements, dialogue, incidents, language, artwork, symbols, designs, depictions, likenesses, formats, poses, concepts, themes and graphic, photographic and other visual or audio representations; names and descriptions of characters, spells, enchantments, personalities, teams, personas, likenesses and special abilities; places, locations, environments, creatures, equipment, magical or supernatural abilities or effects, logos, symbols, or graphic designs; and any other trademark or registered trademark clearly identified as Product identity by the owner of the Product Identity, and which specifically excludes the Open Game Content; (f) 'Trademark' means the logos, names, mark, sign, motto, designs that are used by a Contributor to identify itself or its products or the associated products contributed to the Open Game License by the Contributor (g) 'Use', 'Used' or 'Using' means to use, Distribute, copy, edit, format, modify, translate and otherwise create Derivative Material of Open Game Content. (h) 'You' or 'Your' means the licensee in terms of this agreement.</li>\r\n                                <li>The License: This License applies to any Open Game Content that contains a notice indicating that the Open Game Content may only be Used under and in terms of this License. You must affix such a notice to any Open Game Content that you Use. No terms may be added to or subtracted from this License except as described by the License itself. No other terms or conditions may be applied to any Open Game Content distributed using this License.</li>\r\n                                <li>Offer and Acceptance: By Using the Open Game Content You indicate Your acceptance of the terms of this License.</li>\r\n                                <li>Grant and Consideration: In consideration for agreeing to use this License, the Contributors grant You a perpetual, worldwide, royalty-free, non-exclusive license with the exact terms of this License to Use, the Open Game Content.</li>\r\n                                <li>Representation of Authority to Contribute: If You are contributing original material as Open Game Content, You represent that Your Contributions are Your original creation and/or You have sufficient rights to grant the rights conveyed by this License.</li>\r\n                                <li>Notice of License Copyright: You must update the COPYRIGHT NOTICE portion of this License to include the exact text of the COPYRIGHT NOTICE of any Open Game Content You are copying, modifying or distributing, and You must add the title, the copyright date, and the copyright holder's name to the COPYRIGHT NOTICE of any original Open Game Content you Distribute.</li>\r\n                                <li>Use of Product Identity: You agree not to Use any Product Identity, including as an indication as to compatibility, except as expressly licensed in another, independent Agreement with the owner of each element of that Product Identity. You agree not to indicate compatibility or co-adaptability with any Trademark or Registered Trademark in conjunction with a work containing Open Game Content except as expressly licensed in another, independent Agreement with the owner of such Trademark or Registered Trademark. The use of any Product Identity in Open Game Content does not constitute a challenge to the ownership of that Product Identity. The owner of any Product Identity used in Open Game Content shall retain all rights, title and interest in and to that Product Identity.</li>\r\n                                <li>Identification: If you distribute Open Game Content You must clearly indicate which portions of the work that you are distributing are Open Game Content.</li>\r\n                                <li>Updating the License: Wizards or its designated Agents may publish updated versions of this License. You may use any authorized version of this License to copy, modify and distribute any Open Game Content originally distributed under any version of this License.</li>\r\n                                <li>Copy of this License: You MUST include a copy of this License with every copy of the Open Game Content You Distribute.</li>\r\n                                <li>Use of Contributor Credits: You may not market or advertise the Open Game Content using the name of any Contributor unless You have written permission from the Contributor to do so.</li>\r\n                                <li>Inability to Comply: If it is impossible for You to comply with any of the terms of this License with respect to some or all of the Open Game Content due to statute, judicial order, or governmental regulation then You may not Use any Open Game Material so affected.</li>\r\n                                <li>Termination: This License will terminate automatically if You fail to comply with all terms herein and fail to cure such breach within 30 days of becoming aware of the breach. All sublicenses shall survive the termination of this License.</li>\r\n                                <li>Reformation: If any provision of this License is held to be unenforceable, such provision shall be reformed only to the extent necessary to make it enforceable.</li>\r\n                                <li>COPYRIGHT NOTICE Open Game License v 1.0 Copyright 2000, Wizards of the Coast, Inc.</li>\r\n                            </ol>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            );\r\n            /* tslint:enable:max-line-length */\r\n        } catch (e) {\r\n            console.error(e);\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport Utils from '../../utils/utils';\r\n\r\nimport { CombatSetup } from '../../models/combat';\r\nimport { Encounter, EncounterSlot } from '../../models/encounter';\r\nimport { MapFolio } from '../../models/map-folio';\r\nimport { Monster } from '../../models/monster-group';\r\nimport { Party } from '../../models/party';\r\n\r\nimport Dropdown from '../controls/dropdown';\r\nimport Selector from '../controls/selector';\r\nimport DifficultyChartPanel from '../panels/difficulty-chart-panel';\r\nimport MapPanel from '../panels/map-panel';\r\n\r\ninterface Props {\r\n    combatSetup: CombatSetup;\r\n    parties: Party[];\r\n    encounters: Encounter[];\r\n    mapFolios: MapFolio[];\r\n    getMonster: (monsterName: string, groupName: string) => Monster | null;\r\n    notify: () => void;\r\n}\r\n\r\ninterface State {\r\n    combatSetup: CombatSetup;\r\n}\r\n\r\nexport default class CombatStartModal extends React.Component<Props, State> {\r\n    public static defaultProps = {\r\n        parties: null,\r\n        mapFolios: null\r\n    };\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            combatSetup: props.combatSetup\r\n        };\r\n    }\r\n\r\n    private setParty(partyID: string) {\r\n        // eslint-disable-next-line\r\n        this.state.combatSetup.partyID = partyID;\r\n        this.setState({\r\n            combatSetup: this.state.combatSetup\r\n        }, () => this.props.notify());\r\n    }\r\n\r\n    private setEncounter(encounterID: string) {\r\n        // eslint-disable-next-line\r\n        this.state.combatSetup.encounterID = encounterID;\r\n        const enc = this.props.encounters.find(e => e.id === encounterID);\r\n        if (enc) {\r\n            // eslint-disable-next-line\r\n            this.state.combatSetup.monsterNames = Utils.getMonsterNames(enc);\r\n        }\r\n        this.setState({\r\n            combatSetup: this.state.combatSetup\r\n        }, () => this.props.notify());\r\n    }\r\n\r\n    private setFolioID(id: string) {\r\n        if (id && (id !== '')) {\r\n            const folio = this.props.mapFolios.find(f => f.id === id);\r\n            if (folio) {\r\n                // eslint-disable-next-line\r\n                this.state.combatSetup.folioID = folio.id;\r\n                // eslint-disable-next-line\r\n                this.state.combatSetup.mapID = folio.maps.length === 1 ? folio.maps[0].id : null;\r\n            }\r\n        } else {\r\n            // eslint-disable-next-line\r\n            this.state.combatSetup.folioID = null;\r\n            // eslint-disable-next-line\r\n            this.state.combatSetup.mapID = null;\r\n        }\r\n        this.setState({\r\n            combatSetup: this.state.combatSetup\r\n        });\r\n    }\r\n\r\n    private setMapID(id: string) {\r\n        // eslint-disable-next-line\r\n        this.state.combatSetup.mapID = id;\r\n        this.setState({\r\n            combatSetup: this.state.combatSetup\r\n        });\r\n    }\r\n\r\n    private setWave(waveID: string) {\r\n        // eslint-disable-next-line\r\n        this.state.combatSetup.waveID = waveID;\r\n        const enc = this.props.encounters.find(e => e.id === this.state.combatSetup.encounterID);\r\n        if (enc) {\r\n            const wave = enc.waves.find(w => w.id === waveID);\r\n            if (wave) {\r\n                // eslint-disable-next-line\r\n                this.state.combatSetup.monsterNames = Utils.getMonsterNames(wave);\r\n            }\r\n        }\r\n        this.setState({\r\n            combatSetup: this.state.combatSetup\r\n        }, () => this.props.notify());\r\n    }\r\n\r\n    private setEncounterInitMode(mode: 'manual' | 'individual' | 'group') {\r\n        // eslint-disable-next-line\r\n        this.state.combatSetup.encounterInitMode = mode;\r\n        this.setState({\r\n            combatSetup: this.state.combatSetup\r\n        });\r\n    }\r\n\r\n    private changeName(slotID: string, index: number, name: string) {\r\n        const slot = this.state.combatSetup.monsterNames.find(s => s.id === slotID);\r\n        if (slot) {\r\n            slot.names[index] = name;\r\n            this.setState({\r\n                combatSetup: this.state.combatSetup\r\n            });\r\n        }\r\n    }\r\n\r\n    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n\r\n    private getPartySection() {\r\n        if (this.props.parties.length === 0) {\r\n            return (\r\n                <div className='section'>you have not defined any parties</div>\r\n            );\r\n        }\r\n\r\n        const partyOptions = this.props.parties.map(party => {\r\n            return {\r\n                id: party.id,\r\n                text: party.name || 'unnamed party'\r\n            };\r\n        });\r\n\r\n        let partyContent = null;\r\n        if (this.state.combatSetup.partyID) {\r\n            const selectedParty = this.props.parties.find(p => p.id === this.state.combatSetup.partyID);\r\n            if (selectedParty) {\r\n                const pcs = selectedParty.pcs.filter(pc => pc.active);\r\n\r\n                const pcSections = pcs.map(pc =>\r\n                    (\r\n                        <li key={pc.id}>\r\n                            {pc.name || 'unnamed pc'} (level {pc.level})\r\n                        </li>\r\n                    )\r\n                );\r\n\r\n                if (pcSections.length === 0) {\r\n                    pcSections.push(\r\n                        <li key={'empty'}>no pcs</li>\r\n                    );\r\n                }\r\n\r\n                partyContent = (\r\n                    <div>\r\n                        <div className='subheading'>pcs</div>\r\n                        <ul>{pcSections}</ul>\r\n                    </div>\r\n                );\r\n            }\r\n        }\r\n\r\n        return (\r\n            <div>\r\n                <div className='heading'>party</div>\r\n                <Dropdown\r\n                    options={partyOptions}\r\n                    placeholder='select party...'\r\n                    selectedID={this.state.combatSetup.partyID ? this.state.combatSetup.partyID : undefined}\r\n                    select={optionID => this.setParty(optionID)}\r\n                />\r\n                {partyContent}\r\n            </div>\r\n        );\r\n    }\r\n\r\n    private getEncounterSection() {\r\n        if (this.props.encounters.length === 0) {\r\n            return (\r\n                <div className='section'>you have not built any encounters</div>\r\n            );\r\n        }\r\n\r\n        const encounterOptions = this.props.encounters.map(encounter => {\r\n            return {\r\n                id: encounter.id,\r\n                text: encounter.name || 'unnamed encounter'\r\n            };\r\n        });\r\n\r\n        let encounterContent = null;\r\n        if (this.state.combatSetup.encounterID) {\r\n            const selectedEncounter = this.props.encounters.find(e => e.id === this.state.combatSetup.encounterID);\r\n            if (selectedEncounter) {\r\n                const monsterSections = selectedEncounter.slots.map(slot => {\r\n                    let name = slot.monsterName || 'unnamed monster';\r\n                    if (slot.count > 1) {\r\n                        name += ' (x' + slot.count + ')';\r\n                    }\r\n                    return (\r\n                        <li key={slot.id}>{name}</li>\r\n                    );\r\n                });\r\n\r\n                if (monsterSections.length === 0) {\r\n                    monsterSections.push(\r\n                        <li key={'empty'}>no monsters</li>\r\n                    );\r\n                }\r\n\r\n                const waves = selectedEncounter.waves.map(wave => {\r\n                    if (wave.slots.length === 0) {\r\n                        return null;\r\n                    }\r\n\r\n                    const waveMonsters = wave.slots.map(slot => {\r\n                        let name = slot.monsterName || 'unnamed monster';\r\n                        if (slot.count > 1) {\r\n                            name += ' x' + slot.count;\r\n                        }\r\n                        return (\r\n                            <li key={slot.id}>{name}</li>\r\n                        );\r\n                    });\r\n\r\n                    return (\r\n                        <div key={wave.id}>\r\n                            <div className='subheading'>{wave.name || 'unnamed wave'}</div>\r\n                            <ul>{waveMonsters}</ul>\r\n                        </div>\r\n                    );\r\n                });\r\n\r\n                encounterContent = (\r\n                    <div>\r\n                        <div className='subheading'>monsters</div>\r\n                        <ul>{monsterSections}</ul>\r\n                        {waves}\r\n                    </div>\r\n                );\r\n            }\r\n        }\r\n\r\n        return (\r\n            <div>\r\n                <div className='heading'>encounter</div>\r\n                <Dropdown\r\n                    options={encounterOptions}\r\n                    placeholder='select encounter...'\r\n                    selectedID={this.state.combatSetup.encounterID ? this.state.combatSetup.encounterID : undefined}\r\n                    select={optionID => this.setEncounter(optionID)}\r\n                />\r\n                {encounterContent}\r\n            </div>\r\n        );\r\n    }\r\n\r\n    private getMapSection() {\r\n        const folios = this.props.mapFolios.filter(folio => folio.maps.length > 0);\r\n        if (folios.length === 0) {\r\n            return null;\r\n        }\r\n\r\n        const folioOptions = [{\r\n            id: '',\r\n            text: 'none'\r\n        }].concat(folios.map(folio => {\r\n            return {\r\n                id: folio.id,\r\n                text: folio.name || 'unnamed folio'\r\n            };\r\n        }));\r\n\r\n        let selectMapSection = null;\r\n        let thumbnailSection = null;\r\n\r\n        if (this.state.combatSetup.folioID) {\r\n            const folio = this.props.mapFolios.find(f => f.id === this.state.combatSetup.folioID);\r\n            if (folio) {\r\n                const mapOptions = folio.maps.map(m => {\r\n                    return {\r\n                        id: m.id,\r\n                        text: m.name || 'unnamed map'\r\n                    };\r\n                });\r\n\r\n                if (mapOptions.length !== 1) {\r\n                    selectMapSection = (\r\n                        <Selector\r\n                            options={mapOptions}\r\n                            selectedID={this.state.combatSetup.mapID}\r\n                            select={optionID => this.setMapID(optionID)}\r\n                        />\r\n                    );\r\n                }\r\n\r\n                if (this.state.combatSetup.mapID) {\r\n                    const map = folio.maps.find(m => m.id === this.state.combatSetup.mapID);\r\n                    if (map) {\r\n                        thumbnailSection = (\r\n                            <MapPanel\r\n                                map={map}\r\n                                mode='thumbnail'\r\n                            />\r\n                        );\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return (\r\n            <div>\r\n                <div className='heading'>map</div>\r\n                <Dropdown\r\n                    options={folioOptions}\r\n                    placeholder='select map folio...'\r\n                    selectedID={this.state.combatSetup.folioID ? this.state.combatSetup.folioID : undefined}\r\n                    select={optionID => this.setFolioID(optionID)}\r\n                />\r\n                {selectMapSection}\r\n                {thumbnailSection}\r\n            </div>\r\n        );\r\n    }\r\n\r\n    private getWaveSection() {\r\n        if (this.state.combatSetup.encounterID === null) {\r\n            return (\r\n                <div className='section'>you have not selected an encounter</div>\r\n            );\r\n        }\r\n\r\n        const selectedEncounter = this.props.encounters.find(e => e.id === this.state.combatSetup.encounterID);\r\n        if (selectedEncounter) {\r\n            if (selectedEncounter.waves.length === 0) {\r\n                return (\r\n                    <div className='section'>you have not defined any waves</div>\r\n                );\r\n            }\r\n\r\n            const waveOptions = selectedEncounter.waves.map(wave => {\r\n                return {\r\n                    id: wave.id,\r\n                    text: wave.name || 'unnamed wave'\r\n                };\r\n            });\r\n\r\n            let waveContent = null;\r\n            if (this.state.combatSetup.waveID) {\r\n                const selectedWave = selectedEncounter.waves.find(w => w.id === this.state.combatSetup.waveID);\r\n                if (selectedWave) {\r\n                    const monsterSections = selectedWave.slots.map(slot => {\r\n                        let name = slot.monsterName || 'unnamed monster';\r\n                        if (slot.count > 1) {\r\n                            name += ' (x' + slot.count + ')';\r\n                        }\r\n                        return (\r\n                            <li key={slot.id}>{name}</li>\r\n                        );\r\n                    });\r\n\r\n                    if (monsterSections.length === 0) {\r\n                        monsterSections.push(\r\n                            <li key={'empty'}>no monsters</li>\r\n                        );\r\n                    }\r\n\r\n                    waveContent = (\r\n                        <div>\r\n                            <div className='subheading'>monsters</div>\r\n                            <ul>{monsterSections}</ul>\r\n                        </div>\r\n                    );\r\n                }\r\n            }\r\n\r\n            return (\r\n                <div>\r\n                    <div className='heading'>wave</div>\r\n                    <Dropdown\r\n                        options={waveOptions}\r\n                        placeholder='select wave...'\r\n                        selectedID={this.state.combatSetup.waveID ? this.state.combatSetup.waveID : undefined}\r\n                        select={optionID => this.setWave(optionID)}\r\n                    />\r\n                    {waveContent}\r\n                </div>\r\n            );\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    private getDifficultySection() {\r\n        const party = this.props.parties.find(p => p.id === this.state.combatSetup.partyID);\r\n        const encounter = this.props.encounters.find(enc => enc.id === this.state.combatSetup.encounterID);\r\n\r\n        if (party && encounter) {\r\n            return (\r\n                <div>\r\n                    <div className='heading'>encounter difficulty</div>\r\n                    <DifficultyChartPanel\r\n                        party={party}\r\n                        encounter={encounter}\r\n                        getMonster={(monsterName, monsterGroupName) => this.props.getMonster(monsterName, monsterGroupName)}\r\n                    />\r\n                </div>\r\n            );\r\n        }\r\n\r\n        return (\r\n            <div>\r\n                <div className='heading'>encounter difficulty</div>\r\n                <div className='section'>select a party and an encounter on the left to see difficulty information.</div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    private getMonsterSection() {\r\n        if (this.state.combatSetup.encounterID === null) {\r\n            return (\r\n                <div>\r\n                    <div className='heading'>monsters</div>\r\n                    <div className='section'>select an encounter to see monster options here.</div>\r\n                </div>\r\n            );\r\n        }\r\n\r\n        if (!this.props.parties && this.state.combatSetup.waveID === null) {\r\n            return (\r\n                <div>\r\n                    <div className='heading'>monsters</div>\r\n                    <div className='section'>select a wave to see monster options here.</div>\r\n                </div>\r\n            );\r\n        }\r\n\r\n        const selectedEncounter = this.props.encounters.find(e => e.id === this.state.combatSetup.encounterID);\r\n        if (selectedEncounter) {\r\n            let slotsContainer: { slots: EncounterSlot[] } = selectedEncounter;\r\n            if (this.state.combatSetup.waveID) {\r\n                const selectedWave = selectedEncounter.waves.find(w => w.id === this.state.combatSetup.waveID);\r\n                if (selectedWave) {\r\n                    slotsContainer = selectedWave;\r\n                }\r\n            }\r\n\r\n            if (slotsContainer.slots.length === 0) {\r\n                return null;\r\n            }\r\n\r\n            const initOptions = [\r\n                {\r\n                    id: 'manual',\r\n                    text: 'enter manually'\r\n                },\r\n                {\r\n                    id: 'individual',\r\n                    text: 'roll individually'\r\n                },\r\n                {\r\n                    id: 'group',\r\n                    text: 'roll in groups'\r\n                }\r\n            ];\r\n\r\n            const names = this.state.combatSetup.monsterNames.map(slotNames => {\r\n                const slot = slotsContainer.slots.find(s => s.id === slotNames.id);\r\n                if (slot) {\r\n                    const inputs = [];\r\n                    for (let n = 0; n !== slotNames.names.length; ++n) {\r\n                        inputs.push(\r\n                            <div key={n}>\r\n                                <MonsterName\r\n                                    value={slotNames.names[n]}\r\n                                    slotID={slot.id}\r\n                                    index={n}\r\n                                    changeName={(slotID, index, value) => this.changeName(slotID, index, value)}\r\n                                />\r\n                            </div>\r\n                        );\r\n                    }\r\n                    return (\r\n                        <div key={slotNames.id} className='name-row'>\r\n                            <div className='name-label'>\r\n                                {slot.monsterName}\r\n                            </div>\r\n                            <div className='name-inputs'>\r\n                                {inputs}\r\n                            </div>\r\n                        </div>\r\n                    );\r\n                }\r\n            });\r\n\r\n            return (\r\n                <div>\r\n                    <div className='heading'>monsters</div>\r\n                    <div className='subheading'>initiative</div>\r\n                    <Selector\r\n                        options={initOptions}\r\n                        selectedID={this.state.combatSetup.encounterInitMode}\r\n                        select={optionID => this.setEncounterInitMode(optionID as 'manual' | 'individual' | 'group')}\r\n                    />\r\n                    <div className='subheading'>names</div>\r\n                    <div>{names}</div>\r\n                </div>\r\n            );\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n\r\n    public render() {\r\n        try {\r\n            let leftSection = null;\r\n            let rightSection = null;\r\n\r\n            if (this.props.parties) {\r\n                leftSection = (\r\n                    <div>\r\n                        {this.getPartySection()}\r\n                        {this.getEncounterSection()}\r\n                        {this.getMapSection()}\r\n                    </div>\r\n                );\r\n\r\n                rightSection = (\r\n                    <div>\r\n                        {this.getDifficultySection()}\r\n                        {this.getMonsterSection()}\r\n                    </div>\r\n                );\r\n            } else {\r\n                leftSection = (\r\n                    <div>\r\n                        {this.getWaveSection()}\r\n                    </div>\r\n                );\r\n\r\n                rightSection = (\r\n                    <div>\r\n                        {this.getMonsterSection()}\r\n                    </div>\r\n                );\r\n            }\r\n\r\n            return (\r\n                <div className='row' style={{ height: '100%', margin: '0 -15px' }}>\r\n                    <div className='column small-6 medium-6 large-6 scrollable'>\r\n                        {leftSection}\r\n                    </div>\r\n                    <div className='column small-6 medium-6 large-6 scrollable'>\r\n                        {rightSection}\r\n                    </div>\r\n                </div>\r\n            );\r\n        } catch (e) {\r\n            console.error(e);\r\n        }\r\n    }\r\n}\r\n\r\ninterface MonsterNameProps {\r\n    slotID: string;\r\n    index: number;\r\n    value: string;\r\n    changeName: (slotID: string, index: number, value: string) => void;\r\n}\r\n\r\nclass MonsterName extends React.Component<MonsterNameProps> {\r\n    public render() {\r\n        return (\r\n            <input type='text' value={this.props.value} onChange={event => this.props.changeName(this.props.slotID, this.props.index, event.target.value)} />\r\n        );\r\n    }\r\n}\r\n","export interface Condition {\r\n    id: string;\r\n    name: string;\r\n    level: number;\r\n    text: string | null;\r\n    duration: ConditionDurationSaves | ConditionDurationCombatant | ConditionDurationRounds | null;\r\n}\r\n\r\nexport interface ConditionDurationSaves {\r\n    type: 'saves';\r\n    count: number;\r\n    saveType: 'str' | 'dex' | 'con' | 'int' | 'wis' | 'cha' | 'death';\r\n    saveDC: number;\r\n    point: 'start' | 'end';\r\n}\r\n\r\nexport interface ConditionDurationCombatant {\r\n    type: 'combatant';\r\n    point: 'start' | 'end';\r\n    combatantID: string | null;\r\n}\r\n\r\nexport interface ConditionDurationRounds {\r\n    type: 'rounds';\r\n    count: number;\r\n}\r\n\r\nexport const CONDITION_TYPES = [\r\n    'blinded',\r\n    'charmed',\r\n    'deafened',\r\n    'exhaustion',\r\n    'frightened',\r\n    'grappled',\r\n    'incapacitated',\r\n    'invisible',\r\n    'paralyzed',\r\n    'petrified',\r\n    'poisoned',\r\n    'prone',\r\n    'restrained',\r\n    'stunned',\r\n    'unconscious',\r\n    'custom'\r\n];\r\n","import React from 'react';\r\n\r\ninterface Props {\r\n    items: { id: string; text: string; details: JSX.Element | string; disabled?: boolean }[];\r\n    selectedItemID: string | null;\r\n    select: (itemID: string) => void;\r\n}\r\n\r\nexport default class RadioGroup extends React.Component<Props> {\r\n    public static defaultProps = {\r\n        // No default property values\r\n    };\r\n\r\n    public render() {\r\n        try {\r\n            const content = this.props.items.map(item => {\r\n                return (\r\n                    <RadioGroupItem\r\n                        key={item.id}\r\n                        item={item}\r\n                        selected={this.props.selectedItemID === item.id}\r\n                        select={(itemID: string) => this.props.select(itemID)}\r\n                    />\r\n                );\r\n            });\r\n\r\n            return (\r\n                <div className='radio-group'>\r\n                    {content}\r\n                </div>\r\n            );\r\n        } catch (ex) {\r\n            console.error(ex);\r\n            return null;\r\n        }\r\n    }\r\n}\r\n\r\ninterface RadioGroupItemProps {\r\n    item: { id: string; text: string; details: JSX.Element | string; disabled?: boolean };\r\n    selected: boolean;\r\n    select: (itemID: string) => void;\r\n}\r\n\r\nclass RadioGroupItem extends React.Component<RadioGroupItemProps> {\r\n    public render() {\r\n        let style = 'radio-item';\r\n        let details = null;\r\n\r\n        if (this.props.selected) {\r\n            style += ' selected';\r\n            details = (\r\n                <div className='radio-item-details'>\r\n                    {this.props.item.details}\r\n                </div>\r\n            );\r\n        }\r\n\r\n        if (this.props.item.disabled) {\r\n            style += ' disabled';\r\n        }\r\n\r\n        return (\r\n            <div className={style} onClick={() => this.props.select(this.props.item.id)}>\r\n                <div className='radio-item-text'>{this.props.item.text}</div>\r\n                {details}\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport Factory from '../../utils/factory';\r\nimport Utils from '../../utils/utils';\r\n\r\nimport { Combat, Combatant } from '../../models/combat';\r\nimport { Condition, CONDITION_TYPES, ConditionDurationCombatant, ConditionDurationSaves } from '../../models/condition';\r\nimport { Monster } from '../../models/monster-group';\r\n\r\nimport Dropdown from '../controls/dropdown';\r\nimport RadioGroup from '../controls/radio-group';\r\nimport Selector from '../controls/selector';\r\nimport Spin from '../controls/spin';\r\n\r\ninterface Props {\r\n    condition: Condition;\r\n    combatant: Combatant & Monster;\r\n    combat: Combat;\r\n}\r\n\r\ninterface State {\r\n    condition: Condition;\r\n}\r\n\r\nexport default class ConditionModal extends React.Component<Props, State> {\r\n    constructor(props: Props) {\r\n        super(props);\r\n        this.state = {\r\n            condition: props.condition\r\n        };\r\n    }\r\n\r\n    private setCondition(conditionName: string) {\r\n        // eslint-disable-next-line\r\n        this.state.condition.name = conditionName;\r\n        // eslint-disable-next-line\r\n        this.state.condition.level = 1;\r\n        // eslint-disable-next-line\r\n        this.state.condition.text = conditionName === 'custom' ? 'custom condition' : null;\r\n\r\n        this.setState({\r\n            condition: this.state.condition\r\n        });\r\n    }\r\n\r\n    private setDuration(durationType: 'saves' | 'combatant' | 'rounds') {\r\n        let duration = null;\r\n\r\n        switch (durationType) {\r\n            case 'saves':\r\n                duration = Factory.createConditionDurationSaves();\r\n                break;\r\n            case 'combatant':\r\n                duration = Factory.createConditionDurationCombatant();\r\n                duration.combatantID = this.props.combatant.id;\r\n                break;\r\n            case 'rounds':\r\n                duration = Factory.createConditionDurationRounds();\r\n                break;\r\n            default:\r\n                // Do nothing\r\n                break;\r\n        }\r\n\r\n        // eslint-disable-next-line\r\n        this.state.condition.duration = duration;\r\n        this.setState({\r\n            condition: this.state.condition\r\n        });\r\n    }\r\n\r\n    private changeValue(object: any, field: string, value: any) {\r\n        object[field] = value;\r\n\r\n        this.setState({\r\n            condition: this.state.condition\r\n        });\r\n    }\r\n\r\n    private nudgeValue(object: any, field: string, delta: number) {\r\n        let value = object[field] + delta;\r\n        if (field === 'level') {\r\n            value = Math.max(value, 1);\r\n            value = Math.min(value, 6);\r\n        }\r\n        if (field === 'count') {\r\n            value = Math.max(value, 1);\r\n        }\r\n        if (field === 'saveDC') {\r\n            value = Math.max(value, 0);\r\n        }\r\n        object[field] = value;\r\n\r\n        this.setState({\r\n            condition: this.state.condition\r\n        });\r\n    }\r\n\r\n    public render() {\r\n        try {\r\n            const conditions = CONDITION_TYPES.map(condition => {\r\n                const controls = [];\r\n                const description = [];\r\n                if (condition === this.state.condition.name) {\r\n                    if (condition === 'custom') {\r\n                        controls.push(\r\n                            <input\r\n                                type='text'\r\n                                placeholder='custom condition'\r\n                                value={this.state.condition.text ? this.state.condition.text : ''}\r\n                                onChange={event => this.changeValue(this.state.condition, 'text', event.target.value)}\r\n                            />\r\n                        );\r\n                    }\r\n                    if (condition === 'exhaustion') {\r\n                        controls.push(\r\n                            <Spin\r\n                                key='exhaustion-spin'\r\n                                source={this.props.condition}\r\n                                name='level'\r\n                                label='exhaustion'\r\n                                nudgeValue={delta => this.nudgeValue(this.props.condition, 'level', delta)}\r\n                            />\r\n                        );\r\n                    }\r\n                    const text = Utils.conditionText(this.state.condition);\r\n                    for (let n = 0; n !== text.length; ++n) {\r\n                        description.push(<li key={n} className='section'>{text[n]}</li>);\r\n                    }\r\n                }\r\n\r\n                return {\r\n                    id: condition,\r\n                    text: condition,\r\n                    details: (\r\n                        <div key={condition}>\r\n                            {controls}\r\n                            <ul>\r\n                                {description}\r\n                            </ul>\r\n                        </div>\r\n                    ),\r\n                    disabled: this.props.combatant.conditionImmunities ? this.props.combatant.conditionImmunities.indexOf(condition) !== -1 : false\r\n                };\r\n            });\r\n\r\n            const saveOptions = ['str', 'dex', 'con', 'int', 'wis', 'cha', 'death'].map(c => ({ id: c, text: c }));\r\n            const pointOptions = [\r\n                {\r\n                    id: 'start',\r\n                    text: 'start of turn'\r\n                },\r\n                {\r\n                    id: 'end',\r\n                    text: 'end of turn'\r\n                }\r\n            ];\r\n            const combatantOptions = this.props.combat.combatants.map(c => ({ id: c.id, text: (c.displayName || c.name || 'unnamed monster') }));\r\n\r\n            const durations = [\r\n                {\r\n                    id: 'none',\r\n                    text: 'until removed (default)',\r\n                    details: (\r\n                        <div className='section'>\r\n                            <div>the condition persists until it is manually removed</div>\r\n                        </div>\r\n                    )\r\n                },\r\n                {\r\n                    id: 'saves',\r\n                    text: 'until a successful save',\r\n                    details: (\r\n                        <div>\r\n                            <div className='section'>\r\n                                <div className='subheading'>number of saves required</div>\r\n                                <Spin\r\n                                    source={this.props.condition.duration}\r\n                                    name='count'\r\n                                    nudgeValue={delta => this.nudgeValue(this.props.condition.duration, 'count', delta)}\r\n                                />\r\n                            </div>\r\n                            <div className='section'>\r\n                                <div className='subheading'>save dc</div>\r\n                                <Spin\r\n                                    source={this.props.condition.duration}\r\n                                    name='saveDC'\r\n                                    nudgeValue={delta => this.nudgeValue(this.props.condition.duration, 'saveDC', delta)}\r\n                                />\r\n                            </div>\r\n                            <div className='section'>\r\n                                <div className='subheading'>type of save</div>\r\n                                <Selector\r\n                                    options={saveOptions}\r\n                                    selectedID={\r\n                                        (this.props.condition.duration as ConditionDurationSaves)\r\n                                        ? (this.props.condition.duration as ConditionDurationSaves).saveType\r\n                                        : null\r\n                                    }\r\n                                    select={optionID => this.changeValue(this.props.condition.duration, 'saveType', optionID)}\r\n                                />\r\n                            </div>\r\n                            <div className='section'>\r\n                                <div className='subheading'>make the save at the start or end of the turn</div>\r\n                                <Selector\r\n                                    options={pointOptions}\r\n                                    selectedID={\r\n                                        (this.props.condition.duration as ConditionDurationSaves)\r\n                                        ? (this.props.condition.duration as ConditionDurationSaves).point\r\n                                        : null\r\n                                    }\r\n                                    select={optionID => this.changeValue(this.props.condition.duration, 'point', optionID)}\r\n                                />\r\n                            </div>\r\n                        </div>\r\n                    )\r\n                },\r\n                {\r\n                    id: 'combatant',\r\n                    text: 'until someone\\'s next turn',\r\n                    details: (\r\n                        <div>\r\n                            <div className='section'>\r\n                                <div className='subheading'>combatant</div>\r\n                                <Dropdown\r\n                                    options={combatantOptions}\r\n                                    selectedID={\r\n                                        (this.props.condition.duration as ConditionDurationCombatant)\r\n                                        ? (this.props.condition.duration as ConditionDurationCombatant).combatantID || undefined\r\n                                        : undefined\r\n                                    }\r\n                                    select={optionID => this.changeValue(this.props.condition.duration, 'combatantID', optionID)}\r\n                                />\r\n                            </div>\r\n                            <div className='section'>\r\n                                <div className='subheading'>start or end of the turn</div>\r\n                                <Selector\r\n                                    options={pointOptions}\r\n                                    selectedID={\r\n                                        (this.props.condition.duration as ConditionDurationCombatant)\r\n                                        ? (this.props.condition.duration as ConditionDurationCombatant).point\r\n                                        : null\r\n                                    }\r\n                                    select={optionID => this.changeValue(this.props.condition.duration, 'point', optionID)}\r\n                                />\r\n                            </div>\r\n                        </div>\r\n                    )\r\n                },\r\n                {\r\n                    id: 'rounds',\r\n                    text: 'for a number of rounds',\r\n                    details: (\r\n                        <div>\r\n                            <div className='section'>\r\n                                <div className='subheading'>number of rounds</div>\r\n                                <Spin\r\n                                    source={this.props.condition.duration}\r\n                                    name='count'\r\n                                    nudgeValue={delta => this.nudgeValue(this.props.condition.duration, 'count', delta)}\r\n                                />\r\n                            </div>\r\n                        </div>\r\n                    )\r\n                }\r\n            ];\r\n\r\n            return (\r\n                <div className='condition-modal'>\r\n                    <div className='row' style={{ height: '100%' }}>\r\n                        <div className='columns small-6 medium-6 large-6 scrollable'>\r\n                            <div className='heading'>condition</div>\r\n                            <RadioGroup\r\n                                items={conditions}\r\n                                selectedItemID={this.state.condition.name}\r\n                                select={itemID => this.setCondition(itemID)}\r\n                            />\r\n                        </div>\r\n                        <div className='columns small-6 medium-6 large-6 scrollable'>\r\n                            <div className='heading'>duration</div>\r\n                            <RadioGroup\r\n                                items={durations}\r\n                                selectedItemID={this.state.condition.duration ? this.state.condition.duration.type : 'none'}\r\n                                select={itemID => this.setDuration(itemID as 'saves' | 'combatant' | 'rounds')}\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            );\r\n        } catch (e) {\r\n            console.error(e);\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport Utils from '../../utils/utils';\r\n\r\nimport { CATEGORY_TYPES, Monster, MonsterGroup, SIZE_TYPES } from '../../models/monster-group';\r\n\r\nimport Selector from '../controls/selector';\r\n\r\ninterface Props {\r\n    library: MonsterGroup[];\r\n}\r\n\r\ninterface State {\r\n    chart: string;\r\n}\r\n\r\nexport default class DemographicsModal extends React.Component<Props, State> {\r\n    constructor(props: Props) {\r\n        super(props);\r\n        this.state = {\r\n            chart: 'challenge'\r\n        };\r\n    }\r\n\r\n    private selectChart(chart: string) {\r\n        this.setState({\r\n            chart: chart\r\n        });\r\n    }\r\n\r\n    public render() {\r\n        try {\r\n            let demographics = null;\r\n\r\n            const allMonsters: Monster[] = [];\r\n            this.props.library.forEach(group => group.monsters.forEach(monster => allMonsters.push(monster)));\r\n            if (allMonsters.length !== 0) {\r\n                const buckets: { value: any, title: string }[] = [];\r\n                let maxBucketSize = 0;\r\n                const monsters: { [key: string]: Monster[] } = {};\r\n\r\n                switch (this.state.chart) {\r\n                    case 'challenge':\r\n                        const challenges = [\r\n                            0, 0.125, 0.25, 0.5, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30\r\n                        ];\r\n                        challenges.forEach(cr => {\r\n                            buckets.push({\r\n                                value: cr,\r\n                                title: 'challenge ' + Utils.challenge(cr)\r\n                            });\r\n                        });\r\n\r\n                        buckets.forEach(bucket => {\r\n                            const cr = bucket.value;\r\n                            monsters[cr.toString()] = allMonsters.filter(monster => monster.challenge === cr);\r\n                        });\r\n\r\n                        buckets.forEach(bucket => {\r\n                            const cr = bucket.value;\r\n                            maxBucketSize = Math.max(monsters[cr].length, maxBucketSize);\r\n                        });\r\n                        break;\r\n                    case 'size':\r\n                        SIZE_TYPES.forEach(size => {\r\n                            buckets.push({\r\n                                value: size,\r\n                                title: size\r\n                            });\r\n                        });\r\n\r\n                        buckets.forEach(bucket => {\r\n                            const size = bucket.value;\r\n                            monsters[size.toString()] = allMonsters.filter(monster => monster.size === size);\r\n                        });\r\n\r\n                        buckets.forEach(bucket => {\r\n                            const size = bucket.value;\r\n                            maxBucketSize = Math.max(monsters[size].length, maxBucketSize);\r\n                        });\r\n                        break;\r\n                    case 'type':\r\n                        CATEGORY_TYPES.forEach(type => {\r\n                            buckets.push({\r\n                                value: type,\r\n                                title: type\r\n                            });\r\n                        });\r\n\r\n                        buckets.forEach(bucket => {\r\n                            const type = bucket.value;\r\n                            monsters[type.toString()] = allMonsters.filter(monster => monster.category === type);\r\n                        });\r\n\r\n                        buckets.forEach(bucket => {\r\n                            const type = bucket.value;\r\n                            maxBucketSize = Math.max(monsters[type].length, maxBucketSize);\r\n                        });\r\n                        break;\r\n                    default:\r\n                        // Do nothing\r\n                        break;\r\n                }\r\n\r\n                const bars = [];\r\n                for (let index = 0; index !== buckets.length; ++index) {\r\n                    const bucket = buckets[index];\r\n                    const set = monsters[bucket.value];\r\n                    const count = set ? set.length : 0;\r\n                    bars.push(\r\n                        <div\r\n                            key={bucket.title}\r\n                            className='bar-container'\r\n                            style={{\r\n                                width: 'calc((100% - 1px) / ' + buckets.length + ')',\r\n                                left: 'calc((100% - 1px) * ' + index + ' / ' + buckets.length + ')'\r\n                            }}\r\n                            title={bucket.title + ': ' + set.length + ' monsters'}\r\n                        >\r\n                            <div\r\n                                className='bar-space'\r\n                                style={{\r\n                                    height: 'calc((100% - 1px) * ' + (maxBucketSize - count) + ' / ' + maxBucketSize + ')'\r\n                                }}\r\n                            />\r\n                            <div\r\n                                className='bar'\r\n                                style={{\r\n                                    height: 'calc((100% - 1px) * ' + count + ' / ' + maxBucketSize + ')'\r\n                                }}\r\n                            />\r\n                        </div>\r\n                    );\r\n                }\r\n\r\n                const chartOptions = [\r\n                    {\r\n                        id: 'challenge',\r\n                        text: 'challenge rating'\r\n                    },\r\n                    {\r\n                        id: 'size',\r\n                        text: 'size'\r\n                    },\r\n                    {\r\n                        id: 'type',\r\n                        text: 'type'\r\n                    }\r\n                ];\r\n\r\n                demographics = (\r\n                    <div>\r\n                        <Selector\r\n                            options={chartOptions}\r\n                            selectedID={this.state.chart}\r\n                            select={optionID => this.selectChart(optionID)}\r\n                        />\r\n                        <div className='chart'>\r\n                            <div className='plot'>{bars}</div>\r\n                        </div>\r\n                    </div>\r\n                );\r\n            }\r\n\r\n            return demographics;\r\n        } catch (e) {\r\n            console.error(e);\r\n        }\r\n    }\r\n}\r\n","export interface MapFolio {\r\n    id: string;\r\n    name: string;\r\n    maps: Map[];\r\n}\r\n\r\nexport interface Map {\r\n    id: string;\r\n    name: string;\r\n    items: MapItem[];\r\n}\r\n\r\nexport interface MapItem {\r\n    id: string;\r\n    type: 'tile' | 'pc' | 'monster';\r\n    x: number;\r\n    y: number;\r\n    width: number;\r\n    height: number;\r\n    terrain: string | null;\r\n}\r\n\r\nexport const TERRAIN_TYPES = [\r\n    'cavern',\r\n    'dirt',\r\n    'flagstone',\r\n    'floorboard',\r\n    'grassland',\r\n    'pit',\r\n    'sand',\r\n    'snow',\r\n    'water'\r\n];\r\n","import React from 'react';\r\n\r\nimport { MapItem, TERRAIN_TYPES } from '../../models/map-folio';\r\n\r\nimport Dropdown from '../controls/dropdown';\r\nimport Radial from '../controls/radial';\r\n\r\ninterface Props {\r\n    tile: MapItem;\r\n    changeValue: (tile: MapItem, field: string, value: string) => void;\r\n    moveMapItem: (tile: MapItem, dir: string) => void;\r\n    resizeMapItem: (tile: MapItem, dir: string, dir2: 'in' | 'out' | null) => void;\r\n    cloneMapItem: (tile: MapItem) => void;\r\n    removeMapItem: (tile: MapItem) => void;\r\n}\r\n\r\nexport default class MapTileCard extends React.Component<Props> {\r\n    public render() {\r\n        try {\r\n            const terrainOptions = TERRAIN_TYPES.map(t => {\r\n                return { id: t, text: t };\r\n            });\r\n\r\n            return (\r\n                <div className='card map-tile'>\r\n                    <div className='heading'>\r\n                        <div className='title'>map tile</div>\r\n                    </div>\r\n                    <div className='card-content'>\r\n                        <div className='subheading'>size</div>\r\n                        <div className='section'>{this.props.tile.width} sq x {this.props.tile.height} sq</div>\r\n                        <div className='section'>{this.props.tile.width * 5} ft x {this.props.tile.height * 5} ft</div>\r\n                        <div className='divider' />\r\n                        <div className='subheading'>terrain</div>\r\n                        <Dropdown\r\n                            options={terrainOptions}\r\n                            placeholder='select terrain'\r\n                            selectedID={this.props.tile.terrain ? this.props.tile.terrain : undefined}\r\n                            select={optionID => this.props.changeValue(this.props.tile, 'terrain', optionID)}\r\n                        />\r\n                        <div className='divider' />\r\n                        <div className='subheading'>move</div>\r\n                        <div className='section centered'>\r\n                            <Radial direction='out' click={dir => this.props.moveMapItem(this.props.tile, dir)} />\r\n                        </div>\r\n                        <div className='divider' />\r\n                        <div className='subheading'>resize</div>\r\n                        <div className='section centered'>\r\n                            <Radial direction='both' click={(dir, dir2) => this.props.resizeMapItem(this.props.tile, dir, dir2)} />\r\n                        </div>\r\n                        <div className='divider' />\r\n                        <div className='section'>\r\n                            <button onClick={() => this.props.cloneMapItem(this.props.tile)}>clone tile</button>\r\n                            <button onClick={() => this.props.removeMapItem(this.props.tile)}>remove tile</button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            );\r\n        } catch (e) {\r\n            console.error(e);\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport Factory from '../../utils/factory';\r\nimport Utils from '../../utils/utils';\r\n\r\nimport { Map, MapItem } from '../../models/map-folio';\r\n\r\nimport MapTileCard from '../cards/map-tile-card';\r\nimport MapPanel from '../panels/map-panel';\r\n\r\ninterface Props {\r\n    map: Map;\r\n}\r\n\r\ninterface State {\r\n    map: Map;\r\n    selectedTileID: string | null;\r\n}\r\n\r\nexport default class MapEditorModal extends React.Component<Props, State> {\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            map: props.map,\r\n            selectedTileID: null\r\n        };\r\n    }\r\n\r\n    private setSelectedTileID(id: string | null) {\r\n        this.setState({\r\n            selectedTileID: id\r\n        });\r\n    }\r\n\r\n    private addMapTile(x: number, y: number) {\r\n        const tile = Factory.createMapItem();\r\n        tile.x = x;\r\n        tile.y = y;\r\n        tile.terrain = 'flagstone';\r\n        this.state.map.items.push(tile);\r\n\r\n        this.setState({\r\n            map: this.state.map,\r\n            selectedTileID: tile.id\r\n        });\r\n    }\r\n\r\n    private moveMapItem(item: MapItem, dir: string) {\r\n        switch (dir) {\r\n            case 'N':\r\n                item.y -= 1;\r\n                break;\r\n            case 'E':\r\n                item.x += 1;\r\n                break;\r\n            case 'S':\r\n                item.y += 1;\r\n                break;\r\n            case 'W':\r\n                item.x -= 1;\r\n                break;\r\n            default:\r\n                // Do nothing\r\n                break;\r\n        }\r\n\r\n        this.setState({\r\n            map: this.state.map\r\n        });\r\n    }\r\n\r\n    private bigMapItem(item: MapItem, dir: string) {\r\n        switch (dir) {\r\n            case 'N':\r\n                item.y -= 1;\r\n                item.height += 1;\r\n                break;\r\n            case 'E':\r\n                item.width += 1;\r\n                break;\r\n            case 'S':\r\n                item.height += 1;\r\n                break;\r\n            case 'W':\r\n                item.x -= 1;\r\n                item.width += 1;\r\n                break;\r\n            default:\r\n                // Do nothing\r\n                break;\r\n        }\r\n\r\n        this.setState({\r\n            map: this.state.map\r\n        });\r\n    }\r\n\r\n    private smallMapItem(item: MapItem, dir: string) {\r\n        switch (dir) {\r\n            case 'N':\r\n                if (item.height > 1) {\r\n                    item.y += 1;\r\n                    item.height -= 1;\r\n                }\r\n                break;\r\n            case 'E':\r\n                if (item.width > 1) {\r\n                    item.width -= 1;\r\n                }\r\n                break;\r\n            case 'S':\r\n                if (item.height > 1) {\r\n                    item.height -= 1;\r\n                }\r\n                break;\r\n            case 'W':\r\n                if (item.width > 1) {\r\n                    item.x += 1;\r\n                    item.width -= 1;\r\n                }\r\n                break;\r\n            default:\r\n                // Do nothing\r\n                break;\r\n        }\r\n\r\n        this.setState({\r\n            map: this.state.map\r\n        });\r\n    }\r\n\r\n    private resizeMapItem(item: MapItem, dir: string, dir2: 'in' | 'out') {\r\n        switch (dir2) {\r\n            case 'in':\r\n                this.smallMapItem(item, dir);\r\n                break;\r\n            case 'out':\r\n                this.bigMapItem(item, dir);\r\n                break;\r\n            default:\r\n                // Do nothing\r\n                break;\r\n        }\r\n    }\r\n\r\n    private cloneMapItem(item: MapItem) {\r\n        const copy = JSON.parse(JSON.stringify(item));\r\n        copy.id = Utils.guid();\r\n        copy.x += 1;\r\n        copy.y += 1;\r\n        this.state.map.items.push(copy);\r\n\r\n        this.setState({\r\n            map: this.state.map,\r\n            selectedTileID: copy.id\r\n        });\r\n    }\r\n\r\n    private removeMapItem(item: MapItem) {\r\n        const index = this.state.map.items.indexOf(item);\r\n        this.state.map.items.splice(index, 1);\r\n\r\n        this.setState({\r\n            map: this.state.map,\r\n            selectedTileID: null\r\n        });\r\n    }\r\n\r\n    private changeValue(source: any, field: string, value: any) {\r\n        source[field] = value;\r\n\r\n        this.setState({\r\n            map: this.state.map\r\n        });\r\n    }\r\n\r\n    public render() {\r\n        try {\r\n            let tools = null;\r\n            if (this.state.selectedTileID) {\r\n                const item = this.state.map.items.find(i => i.id === this.state.selectedTileID);\r\n                if (item) {\r\n                    tools = (\r\n                        <div className='tools'>\r\n                            <MapTileCard\r\n                                tile={item}\r\n                                moveMapItem={(mapItem, dir) => this.moveMapItem(mapItem, dir)}\r\n                                resizeMapItem={(mapItem, dir, dir2) => this.resizeMapItem(mapItem, dir, dir2 as 'in' | 'out')}\r\n                                cloneMapItem={mapItem => this.cloneMapItem(mapItem)}\r\n                                removeMapItem={mapItem => this.removeMapItem(mapItem)}\r\n                                changeValue={(source, field, value) => this.changeValue(source, field, value)}\r\n                            />\r\n                        </div>\r\n                    );\r\n                }\r\n            } else {\r\n                tools = (\r\n                    <div className='tools'>\r\n                        <p>to add a new tile to the map, double-click on an empty grid square</p>\r\n                        <p>to edit an existing tile, click on it once to select it</p>\r\n                    </div>\r\n                );\r\n            }\r\n\r\n            return (\r\n                <div className='map-editor'>\r\n                    {tools}\r\n                    <MapPanel\r\n                        map={this.state.map}\r\n                        mode='edit'\r\n                        selectedItemID={this.state.selectedTileID ? this.state.selectedTileID : undefined}\r\n                        setSelectedItemID={id => this.setSelectedTileID(id)}\r\n                        addMapTile={(x, y) => this.addMapTile(x, y)}\r\n                    />\r\n                </div>\r\n            );\r\n        } catch (e) {\r\n            console.error(e);\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport Factory from '../../utils/factory';\r\nimport Utils from '../../utils/utils';\r\n\r\nimport { CATEGORY_TYPES, Monster, MonsterGroup, SIZE_TYPES, Trait, TRAIT_TYPES } from '../../models/monster-group';\r\n\r\nimport MonsterCard from '../cards/monster-card';\r\nimport Checkbox from '../controls/checkbox';\r\nimport Dropdown from '../controls/dropdown';\r\nimport Selector from '../controls/selector';\r\nimport Spin from '../controls/spin';\r\nimport AbilityScorePanel from '../panels/ability-score-panel';\r\nimport TraitsPanel from '../panels/traits-panel';\r\n\r\nimport arrow from '../../resources/images/down-arrow.svg';\r\n\r\ninterface Props {\r\n    monster: Monster;\r\n    library: MonsterGroup[];\r\n    showMonsters: boolean;\r\n}\r\n\r\ninterface State {\r\n    monster: Monster;\r\n    page: 'overview' | 'abilities' | 'cbt-stats' | 'actions';\r\n    showFilter: boolean;\r\n    helpSection: string;\r\n    filter: {\r\n        size: boolean,\r\n        type: boolean,\r\n        subtype: boolean,\r\n        alignment: boolean,\r\n        challenge: boolean\r\n    };\r\n}\r\n\r\nexport default class MonsterEditorModal extends React.Component<Props, State> {\r\n    constructor(props: Props) {\r\n        super(props);\r\n        this.state = {\r\n            monster: props.monster,\r\n            page: 'overview',\r\n            showFilter: false,\r\n            helpSection: 'speed',\r\n            filter: {\r\n                size: true,\r\n                type: true,\r\n                subtype: false,\r\n                alignment: false,\r\n                challenge: true\r\n            }\r\n        };\r\n    }\r\n\r\n    private setPage(page: 'overview' | 'abilities' | 'cbt-stats' | 'actions') {\r\n        const sections = this.getHelpOptionsForPage(page);\r\n        this.setState({\r\n            page: page,\r\n            helpSection: sections[0]\r\n        });\r\n    }\r\n\r\n    private toggleFilter() {\r\n        this.setState({\r\n            showFilter: !this.state.showFilter\r\n        });\r\n    }\r\n\r\n    private setHelpSection(section: string) {\r\n        this.setState({\r\n            helpSection: section\r\n        });\r\n    }\r\n\r\n    private toggleMatch(type: 'size' | 'type' | 'subtype' | 'alignment' | 'challenge') {\r\n        // eslint-disable-next-line\r\n        this.state.filter[type] = !this.state.filter[type];\r\n        this.setState({\r\n            filter: this.state.filter\r\n        });\r\n    }\r\n\r\n    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n    // Helper methods\r\n\r\n    private getHelpOptionsForPage(page: 'overview' | 'abilities' | 'cbt-stats' | 'actions') {\r\n        switch (page) {\r\n            case 'overview':\r\n                return ['speed', 'senses', 'languages', 'equipment'];\r\n            case 'abilities':\r\n                return ['str', 'dex', 'con', 'int', 'wis', 'cha', 'saves', 'skills'];\r\n            case 'cbt-stats':\r\n                return ['armor class', 'hit dice', 'resistances', 'vulnerabilities', 'immunities', 'conditions'];\r\n            case 'actions':\r\n                return ['actions'];\r\n            default:\r\n                return [];\r\n        }\r\n    }\r\n\r\n    private getMonsters() {\r\n        const monsters: Monster[] = [];\r\n        this.props.library.forEach(group => {\r\n            group.monsters.forEach(monster => {\r\n                let match = true;\r\n\r\n                if (this.state.monster.id === monster.id) {\r\n                    match = false;\r\n                }\r\n\r\n                if (this.state.filter.size && (this.state.monster.size !== monster.size)) {\r\n                    match = false;\r\n                }\r\n\r\n                if (this.state.filter.type && (this.state.monster.category !== monster.category)) {\r\n                    match = false;\r\n                }\r\n\r\n                if (this.state.filter.subtype && (this.state.monster.tag !== monster.tag)) {\r\n                    match = false;\r\n                }\r\n\r\n                if (this.state.filter.alignment && (this.state.monster.alignment !== monster.alignment)) {\r\n                    match = false;\r\n                }\r\n\r\n                if (this.state.filter.challenge && (this.state.monster.challenge !== monster.challenge)) {\r\n                    match = false;\r\n                }\r\n\r\n                if (match) {\r\n                    monsters.push(monster);\r\n                }\r\n            });\r\n        });\r\n\r\n        return monsters;\r\n    }\r\n\r\n    private setRandomValue(field: string, monsters: Monster[], notify: boolean) {\r\n        const index = Math.floor(Math.random() * monsters.length);\r\n        const m = monsters[index];\r\n\r\n        let source: any = m;\r\n        let value = null;\r\n        const tokens = field.split('.');\r\n        tokens.forEach(token => {\r\n            if (token === tokens[tokens.length - 1]) {\r\n                value = source[token];\r\n            } else {\r\n                source = source[token];\r\n            }\r\n        });\r\n\r\n        this.changeValue(field, value, notify);\r\n    }\r\n\r\n    private geneSplice(monsters: Monster[]) {\r\n        [\r\n            'speed',\r\n            'senses',\r\n            'languages',\r\n            'equipment',\r\n            'abilityScores.str',\r\n            'abilityScores.dex',\r\n            'abilityScores.con',\r\n            'abilityScores.int',\r\n            'abilityScores.wis',\r\n            'abilityScores.cha',\r\n            'savingThrows',\r\n            'skills',\r\n            'ac',\r\n            'hitDice',\r\n            'damage.resist',\r\n            'damage.vulnerable',\r\n            'damage.immune',\r\n            'conditionImmunities'\r\n        ].forEach(field => {\r\n            this.setRandomValue(field, monsters, false);\r\n        });\r\n\r\n        TRAIT_TYPES.forEach(type => {\r\n            // Clear current traits of this type\r\n            const currentTraits = this.state.monster.traits.filter(t => t.type === type);\r\n            currentTraits.forEach(c => {\r\n                const index = this.state.monster.traits.findIndex(t => t === c);\r\n                this.state.monster.traits.splice(index, 1);\r\n            });\r\n\r\n            // Get all traits of this type\r\n            const traits: Trait[] = [];\r\n            monsters.forEach(m => {\r\n                m.traits.filter(t => t.type === type)\r\n                    .forEach(t => traits.push(t));\r\n            });\r\n\r\n            // Collate by name\r\n            const distinct: { trait: Trait, count: number }[] = [];\r\n            traits.forEach(t => {\r\n                const current = distinct.find(d => d.trait.name === t.name);\r\n                if (current) {\r\n                    current.count += 1;\r\n                } else {\r\n                    distinct.push({\r\n                        trait: t,\r\n                        count: 1\r\n                    });\r\n                }\r\n            });\r\n\r\n            // If any are common to all monsters, copy them and remove from the candidates\r\n            const addedIDs: string[] = [];\r\n            distinct.filter(d => d.count === monsters.length)\r\n                .forEach(d => {\r\n                    this.copyTrait(d.trait);\r\n                    addedIDs.push(d.trait.id);\r\n                });\r\n            addedIDs.forEach(id => {\r\n                const index = distinct.findIndex(d => d.trait.id === id);\r\n                distinct.splice(index, 1);\r\n            });\r\n\r\n            const avg = traits.length / monsters.length;\r\n            while (this.state.monster.traits.filter(t => t.type === type).length < avg) {\r\n                const index = Math.floor(Math.random() * distinct.length);\r\n                const t = distinct[index].trait;\r\n                this.copyTrait(t);\r\n                distinct.splice(index, 1);\r\n            }\r\n        });\r\n\r\n        this.setState({\r\n            monster: this.state.monster\r\n        });\r\n    }\r\n\r\n    private addTrait(type: 'trait' | 'action' | 'legendary' | 'lair' | 'regional') {\r\n        const trait = Factory.createTrait();\r\n        trait.type = type;\r\n        trait.name = 'New ' + this.getActionTypeName(type, false).toLowerCase();\r\n        this.state.monster.traits.push(trait);\r\n        this.setState({\r\n            monster: this.state.monster\r\n        });\r\n    }\r\n\r\n    private addRandomTrait(type: string, monsters: Monster[]) {\r\n        const traits: Trait[] = [];\r\n        monsters.forEach(m => {\r\n            m.traits.filter(t => t.type === type)\r\n                .forEach(t => {\r\n                    traits.push(t);\r\n                });\r\n        });\r\n\r\n        const index = Math.floor(Math.random() * traits.length);\r\n        const trait = traits[index];\r\n\r\n        this.copyTrait(trait);\r\n    }\r\n\r\n    private removeTrait(trait: Trait) {\r\n        const index = this.state.monster.traits.indexOf(trait);\r\n        this.state.monster.traits.splice(index, 1);\r\n        this.setState({\r\n            monster: this.state.monster\r\n        });\r\n    }\r\n\r\n    private swapTraits(t1: Trait, t2: Trait) {\r\n        const index1 = this.state.monster.traits.indexOf(t1);\r\n        const index2 = this.state.monster.traits.indexOf(t2);\r\n        this.state.monster.traits[index2] = t1;\r\n        this.state.monster.traits[index1] = t2;\r\n        this.setState({\r\n            monster: this.state.monster\r\n        });\r\n    }\r\n\r\n    private getActionTypeName(type: string, plural: boolean) {\r\n        let name = Utils.traitType(type);\r\n        if (plural) {\r\n            name += 's';\r\n        }\r\n        return name;\r\n    }\r\n\r\n    private copyTrait(trait: Trait) {\r\n        const copy = JSON.parse(JSON.stringify(trait));\r\n        copy.id = Utils.guid();\r\n        this.state.monster.traits.push(copy);\r\n        this.setState({\r\n            monster: this.state.monster\r\n        });\r\n    }\r\n\r\n    private changeTrait(trait: Trait, field: string, value: any) {\r\n        (trait as any)[field] = value;\r\n        this.setState({\r\n            monster: this.state.monster\r\n        });\r\n    }\r\n\r\n    private nudgeValue(field: string, delta: number) {\r\n        let source: any = this.state.monster;\r\n        let value: any = null;\r\n        const tokens = field.split('.');\r\n        tokens.forEach(token => {\r\n            if (token === tokens[tokens.length - 1]) {\r\n                value = source[token];\r\n            } else {\r\n                source = source[token];\r\n            }\r\n        });\r\n\r\n        const newValue = (field === 'challenge') ? Utils.nudgeChallenge(value, delta) : (value ? value : 0) + delta;\r\n        this.changeValue(field, newValue);\r\n    }\r\n\r\n    private changeValue(field: string, value: any, notify = true) {\r\n        let source: any = this.state.monster;\r\n        const tokens = field.split('.');\r\n        tokens.forEach(token => {\r\n            if (token === tokens[tokens.length - 1]) {\r\n                source[token] = value;\r\n\r\n                if ((field === 'abilityScores.con') || (field === 'size') || (field === 'hitDice')) {\r\n                    const sides = Utils.hitDieType(this.state.monster.size);\r\n                    const conMod = Math.floor((this.state.monster.abilityScores.con - 10) / 2);\r\n                    const hpPerDie = ((sides + 1) / 2) + conMod;\r\n                    const hp = Math.floor(this.state.monster.hitDice * hpPerDie);\r\n                    // eslint-disable-next-line\r\n                    this.state.monster.hpMax = hp;\r\n                }\r\n\r\n                if (notify) {\r\n                    this.setState({\r\n                        monster: this.state.monster\r\n                    });\r\n                }\r\n            } else {\r\n                source = source[token];\r\n            }\r\n        });\r\n    }\r\n\r\n    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n    // HTML render methods\r\n\r\n    private getHelpSection(monsters: Monster[]) {\r\n        switch (this.state.helpSection) {\r\n            case 'speed':\r\n                return this.getValueSection('speed', 'text', monsters);\r\n            case 'senses':\r\n                return this.getValueSection('senses', 'text', monsters);\r\n            case 'languages':\r\n                return this.getValueSection('languages', 'text', monsters);\r\n            case 'equipment':\r\n                return this.getValueSection('equipment', 'text', monsters);\r\n            case 'str':\r\n                return this.getValueSection('abilityScores.str', 'number', monsters);\r\n            case 'dex':\r\n                return this.getValueSection('abilityScores.dex', 'number', monsters);\r\n            case 'con':\r\n                return this.getValueSection('abilityScores.con', 'number', monsters);\r\n            case 'int':\r\n                return this.getValueSection('abilityScores.int', 'number', monsters);\r\n            case 'wis':\r\n                return this.getValueSection('abilityScores.wis', 'number', monsters);\r\n            case 'cha':\r\n                return this.getValueSection('abilityScores.cha', 'number', monsters);\r\n            case 'saves':\r\n                return this.getValueSection('savingThrows', 'text', monsters);\r\n            case 'skills':\r\n                return this.getValueSection('skills', 'text', monsters);\r\n            case 'armor class':\r\n                return this.getValueSection('ac', 'number', monsters);\r\n            case 'hit dice':\r\n                return this.getValueSection('hitDice', 'number', monsters);\r\n            case 'resistances':\r\n                return this.getValueSection('damage.resist', 'text', monsters);\r\n            case 'vulnerabilities':\r\n                return this.getValueSection('damage.vulnerable', 'text', monsters);\r\n            case 'immunities':\r\n                return this.getValueSection('damage.immune', 'text', monsters);\r\n            case 'conditions':\r\n                return this.getValueSection('conditionImmunities', 'text', monsters);\r\n            case 'actions':\r\n                return this.getActionsSection(monsters);\r\n            default:\r\n                return null;\r\n        }\r\n    }\r\n\r\n    private getValueSection(field: string, dataType: 'text' | 'number', monsters: Monster[]) {\r\n        const values: any[] = monsters\r\n            .map(m => {\r\n                const tokens = field.split('.');\r\n                let source: any = m;\r\n                let value = null;\r\n                tokens.forEach(token => {\r\n                    if (token === tokens[tokens.length - 1]) {\r\n                        value = source[token];\r\n                    } else {\r\n                        source = source[token];\r\n                    }\r\n                });\r\n                if ((dataType === 'text') && (value === '')) {\r\n                    value = null;\r\n                }\r\n                return value;\r\n            })\r\n            .filter(v => v !== null);\r\n\r\n        const distinct: { value: any, count: number }[] = [];\r\n        if (dataType === 'number') {\r\n            let min: number | null = null;\r\n            let max: number | null = null;\r\n            values.forEach(v => {\r\n                if ((min === null) || (v < min)) {\r\n                    min = v;\r\n                }\r\n                if ((max === null) || (v > max)) {\r\n                    max = v;\r\n                }\r\n            });\r\n            if ((min !== null) && (max !== null)) {\r\n                for (let n = min; n <= max; ++n) {\r\n                    distinct.push({\r\n                        value: n,\r\n                        count: 0\r\n                    });\r\n                }\r\n            }\r\n        }\r\n        values.forEach(v => {\r\n            const current = distinct.find(d => d.value === v);\r\n            if (current) {\r\n                current.count += 1;\r\n            } else {\r\n                distinct.push({\r\n                    value: v,\r\n                    count: 1\r\n                });\r\n            }\r\n        });\r\n\r\n        switch (dataType) {\r\n            case 'number':\r\n                Utils.sortByValue(distinct);\r\n                break;\r\n            case 'text':\r\n                Utils.sortByCount(distinct);\r\n                break;\r\n            default:\r\n                // Do nothing\r\n                break;\r\n        }\r\n\r\n        if (dataType === 'text') {\r\n            const count = monsters.length - values.length;\r\n            if (count !== 0) {\r\n                distinct.push({\r\n                    value: '',\r\n                    count: monsters.length - values.length\r\n                });\r\n            }\r\n        }\r\n\r\n        const valueSections = distinct.map(d => {\r\n            const width = 100 * d.count / monsters.length;\r\n            return (\r\n                <div className='row small-up-3 medium-up-3 large-up-3 value-list' key={distinct.indexOf(d)}>\r\n                    <div className='column'>\r\n                        <div className='text-container'>\r\n                            {d.value || '(none specified)'}\r\n                        </div>\r\n                    </div>\r\n                    <div className='column'>\r\n                        <div className='bar-container'>\r\n                            <div className='bar' style={{ width: width + '%' }} />\r\n                        </div>\r\n                    </div>\r\n                    <div className='column'>\r\n                        <button onClick={() => this.changeValue(field, d.value)}>use this value</button>\r\n                    </div>\r\n                </div>\r\n            );\r\n        });\r\n\r\n        return (\r\n            <div>\r\n                {valueSections}\r\n                <button onClick={() => this.setRandomValue(field, monsters, true)}>select random value</button>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    private getActionsSection(monsters: Monster[]) {\r\n        const rows = [];\r\n        rows.push(\r\n            <div className='row small-up-4 medium-up-4 large-up-4 value-list' key='header'>\r\n                <div className='column'>\r\n                    <div className='text-container'>\r\n                        <b>type</b>\r\n                    </div>\r\n                </div>\r\n                <div className='column'>\r\n                    <div className='text-container number'>\r\n                        <b>average number</b>\r\n                    </div>\r\n                </div>\r\n                <div className='column'>\r\n                    <div className='text-container number'>\r\n                        <b>min - max</b>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n\r\n        TRAIT_TYPES.forEach(type => {\r\n            let min: number | null = null;\r\n            let max: number | null = null;\r\n            let count = 0;\r\n            monsters.forEach(m => {\r\n                const n = m.traits.filter(t => t.type === type).length;\r\n                if ((min === null) || (n < min)) {\r\n                    min = n;\r\n                }\r\n                if ((max === null) || (n > max)) {\r\n                    max = n;\r\n                }\r\n                count += n;\r\n            });\r\n            const avg = Math.round(count / monsters.length);\r\n\r\n            rows.push(\r\n                <div className='row small-up-4 medium-up-4 large-up-4 value-list' key={type}>\r\n                    <div className='column'>\r\n                        <div className={count === 0 ? 'text-container disabled' : 'text-container'}>\r\n                            {this.getActionTypeName(type, true)}\r\n                        </div>\r\n                    </div>\r\n                    <div className='column'>\r\n                        <div className={count === 0 ? 'text-container number disabled' : 'text-container number'}>\r\n                            {avg}\r\n                        </div>\r\n                    </div>\r\n                    <div className='column'>\r\n                        <div className={count === 0 ? 'text-container number disabled' : 'text-container number'}>\r\n                            {min} - {max}\r\n                        </div>\r\n                    </div>\r\n                    <div className='column'>\r\n                        <button className={count === 0 ? 'disabled' : ''} onClick={() => this.addRandomTrait(type, monsters)}>add random</button>\r\n                    </div>\r\n                </div>\r\n            );\r\n        });\r\n\r\n        return (\r\n            <div>\r\n                {rows}\r\n            </div>\r\n        );\r\n    }\r\n\r\n    private getFilterCard(monsters: Monster[]) {\r\n        const criteria: string[] = [];\r\n        if (this.state.filter.size) {\r\n            criteria.push('size');\r\n        }\r\n        if (this.state.filter.type) {\r\n            criteria.push('type');\r\n        }\r\n        if (this.state.filter.subtype) {\r\n            criteria.push('subtype');\r\n        }\r\n        if (this.state.filter.alignment) {\r\n            criteria.push('alignment');\r\n        }\r\n        if (this.state.filter.challenge) {\r\n            criteria.push('challenge rating');\r\n        }\r\n        const criteriaText = (criteria.length > 0) ? 'based on ' + criteria.join(', ') : 'no criteria specified';\r\n        const similar = (\r\n            <div className='section'>\r\n                {monsters.length} similar monsters ({criteriaText})\r\n            </div>\r\n        );\r\n\r\n        let filterContent = null;\r\n        if (this.state.showFilter) {\r\n            filterContent = (\r\n                <div>\r\n                    <Checkbox\r\n                        label={'size ' + this.state.monster.size}\r\n                        checked={this.state.filter.size}\r\n                        changeValue={value => this.toggleMatch('size')}\r\n                    />\r\n                    <Checkbox\r\n                        label={'type ' + this.state.monster.category}\r\n                        checked={this.state.filter.type}\r\n                        changeValue={value => this.toggleMatch('type')}\r\n                    />\r\n                    <Checkbox\r\n                        label={this.state.monster.tag ? 'subtype ' + this.state.monster.tag : 'subtype'}\r\n                        checked={this.state.filter.subtype}\r\n                        disabled={!this.state.monster.tag}\r\n                        changeValue={value => this.toggleMatch('subtype')}\r\n                    />\r\n                    <Checkbox\r\n                        label={this.state.monster.alignment ? 'alignment ' + this.state.monster.alignment : 'alignment'}\r\n                        checked={this.state.filter.alignment}\r\n                        disabled={!this.state.monster.alignment}\r\n                        changeValue={value => this.toggleMatch('alignment')}\r\n                    />\r\n                    <Checkbox\r\n                        label={'challenge rating ' + Utils.challenge(this.state.monster.challenge)}\r\n                        checked={this.state.filter.challenge}\r\n                        changeValue={value => this.toggleMatch('challenge')}\r\n                    />\r\n                    <div className='divider' />\r\n                    <button className={monsters.length < 2 ? 'disabled' : ''} onClick={() => this.geneSplice(monsters)}>build random monster</button>\r\n                    <div className='divider' />\r\n                    {similar}\r\n                </div>\r\n            );\r\n        } else {\r\n            filterContent = (\r\n                <div>\r\n                    {similar}\r\n                </div>\r\n            );\r\n        }\r\n\r\n        return (\r\n            <div className='section'>\r\n                <div className='card'>\r\n                    <div className='heading'>\r\n                        <div className='title'>similar monsters</div>\r\n                        <img className={this.state.showFilter ? 'image rotate' : 'image'} src={arrow} alt='arrow' onClick={() => this.toggleFilter()} />\r\n                    </div>\r\n                    <div className='card-content'>\r\n                        {filterContent}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    private getMonsterCards(monsters: Monster[]) {\r\n        const sorted = Utils.sort(monsters);\r\n        const monsterCards = sorted.map(m => (\r\n            <div className='section' key={m.id}>\r\n                <MonsterCard\r\n                    combatant={m}\r\n                    mode={'template ' + this.state.page}\r\n                    copyTrait={trait => this.copyTrait(trait)}\r\n                />\r\n            </div>\r\n        ));\r\n\r\n        return monsterCards;\r\n    }\r\n\r\n    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n\r\n    public render() {\r\n        try {\r\n            const pages = [\r\n                {\r\n                    id: 'overview',\r\n                    text: 'overview'\r\n                },\r\n                {\r\n                    id: 'abilities',\r\n                    text: 'abilities'\r\n                },\r\n                {\r\n                    id: 'cbt-stats',\r\n                    text: 'combat'\r\n                },\r\n                {\r\n                    id: 'actions',\r\n                    text: 'actions'\r\n                }\r\n            ];\r\n\r\n            let monsters: Monster[] = [];\r\n            if (this.props.showMonsters) {\r\n                monsters = this.getMonsters();\r\n            }\r\n\r\n            let content = null;\r\n            switch (this.state.page) {\r\n                case 'overview':\r\n                    const catOptions = CATEGORY_TYPES.map(cat => ({ id: cat, text: cat }));\r\n                    const sizeOptions = SIZE_TYPES.map(size => ({ id: size, text: size }));\r\n\r\n                    content = (\r\n                        <div className='row'>\r\n                            <div className='columns small-6 medium-6 large-6'>\r\n                                <div className='subheading'>name</div>\r\n                                <input type='text' value={this.state.monster.name} onChange={event => this.changeValue('name', event.target.value)} />\r\n                                <div className='subheading'>size</div>\r\n                                <Dropdown\r\n                                    options={sizeOptions}\r\n                                    selectedID={this.state.monster.size}\r\n                                    select={optionID => this.changeValue('size', optionID)}\r\n                                />\r\n                                <div className='subheading'>type</div>\r\n                                <Dropdown\r\n                                    options={catOptions}\r\n                                    selectedID={this.state.monster.category}\r\n                                    select={optionID => this.changeValue('category', optionID)}\r\n                                />\r\n                                <div className='subheading'>subtype</div>\r\n                                <input type='text' value={this.state.monster.tag} onChange={event => this.changeValue('tag', event.target.value)} />\r\n                                <div className='subheading'>alignment</div>\r\n                                <input type='text' value={this.state.monster.alignment} onChange={event => this.changeValue('alignment', event.target.value)} />\r\n                            </div>\r\n                            <div className='columns small-6 medium-6 large-6'>\r\n                                <div className='subheading'>challenge rating</div>\r\n                                <Spin\r\n                                    source={this.state.monster}\r\n                                    name='challenge'\r\n                                    display={value => Utils.challenge(value)}\r\n                                    nudgeValue={delta => this.nudgeValue('challenge', delta)}\r\n                                />\r\n                                <div className='subheading'>speed</div>\r\n                                <input type='text' value={this.state.monster.speed} onChange={event => this.changeValue('speed', event.target.value)} />\r\n                                <div className='subheading'>senses</div>\r\n                                <input type='text' value={this.state.monster.senses} onChange={event => this.changeValue('senses', event.target.value)} />\r\n                                <div className='subheading'>languages</div>\r\n                                <input type='text' value={this.state.monster.languages} onChange={event => this.changeValue('languages', event.target.value)} />\r\n                                <div className='subheading'>equipment</div>\r\n                                <input type='text' value={this.state.monster.equipment} onChange={event => this.changeValue('equipment', event.target.value)} />\r\n                            </div>\r\n                        </div>\r\n                    );\r\n                    break;\r\n                case 'abilities':\r\n                    content = (\r\n                        <div className='row'>\r\n                            <div className='columns small-6 medium-6 large-6'>\r\n                                <div className='subheading'>ability scores</div>\r\n                                <AbilityScorePanel\r\n                                    edit={true}\r\n                                    combatant={this.state.monster}\r\n                                    nudgeValue={(source, type, delta) => this.nudgeValue(type, delta)}\r\n                                />\r\n                            </div>\r\n                            <div className='columns small-6 medium-6 large-6'>\r\n                                <div className='subheading'>saving throws</div>\r\n                                <input\r\n                                    type='text'\r\n                                    value={this.state.monster.savingThrows}\r\n                                    onChange={event => this.changeValue('savingThrows', event.target.value)}\r\n                                />\r\n                                <div className='subheading'>skills</div>\r\n                                <input\r\n                                    type='text'\r\n                                    value={this.state.monster.skills}\r\n                                    onChange={event => this.changeValue('skills', event.target.value)}\r\n                                />\r\n                            </div>\r\n                        </div>\r\n                    );\r\n                    break;\r\n                case 'cbt-stats':\r\n                    content = (\r\n                        <div className='row'>\r\n                            <div className='columns small-6 medium-6 large-6'>\r\n                                <div className='subheading'>armor class</div>\r\n                                <Spin\r\n                                    source={this.state.monster}\r\n                                    name='ac'\r\n                                    nudgeValue={delta => this.nudgeValue('ac', delta)}\r\n                                />\r\n                                <div className='subheading'>hit dice</div>\r\n                                <Spin\r\n                                    source={this.state.monster}\r\n                                    name='hitDice'\r\n                                    display={value => value + 'd' + Utils.hitDieType(this.state.monster.size)}\r\n                                    nudgeValue={delta => this.nudgeValue('hitDice', delta)}\r\n                                />\r\n                                <div className='subheading'>hit points</div>\r\n                                <div className='hp-value'>{this.state.monster.hpMax} hp</div>\r\n                            </div>\r\n                            <div className='columns small-6 medium-6 large-6'>\r\n                                <div className='subheading'>damage resistances</div>\r\n                                <input\r\n                                    type='text'\r\n                                    value={this.state.monster.damage.resist}\r\n                                    onChange={event => this.changeValue('damage.resist', event.target.value)}\r\n                                />\r\n                                <div className='subheading'>damage vulnerabilities</div>\r\n                                <input\r\n                                    type='text'\r\n                                    value={this.state.monster.damage.vulnerable}\r\n                                    onChange={event => this.changeValue('damage.vulnerable', event.target.value)}\r\n                                />\r\n                                <div className='subheading'>damage immunities</div>\r\n                                <input\r\n                                    type='text'\r\n                                    value={this.state.monster.damage.immune}\r\n                                    onChange={event => this.changeValue('damage.immune', event.target.value)}\r\n                                />\r\n                                <div className='subheading'>condition immunities</div>\r\n                                <input\r\n                                    type='text'\r\n                                    value={this.state.monster.conditionImmunities}\r\n                                    onChange={event => this.changeValue('conditionImmunities', event.target.value)}\r\n                                />\r\n                            </div>\r\n                        </div>\r\n                    );\r\n                    break;\r\n                case 'actions':\r\n                    content = (\r\n                        <TraitsPanel\r\n                            combatant={this.state.monster}\r\n                            mode='edit'\r\n                            addTrait={type => this.addTrait(type)}\r\n                            removeTrait={trait => this.removeTrait(trait)}\r\n                            swapTraits={(t1, t2) => this.swapTraits(t1, t2)}\r\n                            changeValue={(trait, type, value) => this.changeTrait(trait, type, value)}\r\n                        />\r\n                    );\r\n                    break;\r\n                default:\r\n                    // Do nothing\r\n                    break;\r\n            }\r\n\r\n            let help = null;\r\n            if (this.props.showMonsters && (monsters.length > 1)) {\r\n                let selector = null;\r\n                if (this.getHelpOptionsForPage(this.state.page).length > 1) {\r\n                    const options = this.getHelpOptionsForPage(this.state.page).map(s => {\r\n                        return {\r\n                            id: s,\r\n                            text: s\r\n                        };\r\n                    });\r\n                    selector = (\r\n                        <Selector\r\n                            tabs={false}\r\n                            options={options}\r\n                            selectedID={this.state.helpSection}\r\n                            select={optionID => this.setHelpSection(optionID)}\r\n                        />\r\n                    );\r\n                }\r\n\r\n                help = (\r\n                    <div className='monster-help'>\r\n                        <div className='subheading'>information from similar monsters</div>\r\n                        {selector}\r\n                        {this.getHelpSection(monsters)}\r\n                    </div>\r\n                );\r\n            }\r\n\r\n            let monsterList = null;\r\n            if (this.props.showMonsters) {\r\n                monsterList = (\r\n                    <div className='columns small-4 medium-4 large-4 scrollable list-column'>\r\n                        {this.getFilterCard(monsters)}\r\n                        {this.getMonsterCards(monsters)}\r\n                    </div>\r\n                );\r\n            }\r\n\r\n            return (\r\n                <div className='row' style={{ height: '100%', margin: '0 -15px' }}>\r\n                    <div\r\n                        className={\r\n                            this.props.showMonsters\r\n                            ? 'columns small-8 medium-8 large-8 scrollable'\r\n                            : 'columns small-12 medium-12 large-12 scrollable'\r\n                        }\r\n                        style={{ transition: 'none' }}\r\n                    >\r\n                        <div className='section'>\r\n                            <Selector\r\n                                tabs={true}\r\n                                options={pages}\r\n                                selectedID={this.state.page}\r\n                                select={optionID => this.setPage(optionID as 'overview' | 'abilities' | 'cbt-stats' | 'actions')}\r\n                            />\r\n                            {content}\r\n                            {help}\r\n                        </div>\r\n                    </div>\r\n                    {monsterList}\r\n                </div>\r\n            );\r\n        } catch (e) {\r\n            console.error(e);\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport { Encounter } from '../../models/encounter';\r\nimport { MonsterGroup } from '../../models/monster-group';\r\nimport { Party } from '../../models/party';\r\n\r\ninterface Props {\r\n    view: string;\r\n    blur: boolean;\r\n    library: MonsterGroup[];\r\n    parties: Party[];\r\n    encounters: Encounter[];\r\n    setView: (view: string) => void;\r\n}\r\n\r\nexport default class Navbar extends React.Component<Props> {\r\n    public render() {\r\n        try {\r\n            const dmStyle = this.props.view === 'dm' ? 'navigator-item selected' : 'navigator-item';\r\n            const partiesStyle = this.props.view === 'parties' ? 'navigator-item selected' : 'navigator-item';\r\n            const libraryStyle = this.props.view === 'library' ? 'navigator-item selected' : 'navigator-item';\r\n            let encounterStyle = this.props.view === 'encounter' ? 'navigator-item selected' : 'navigator-item';\r\n            const mapStyle = this.props.view === 'maps' ? 'navigator-item selected' : 'navigator-item';\r\n            let combatStyle = this.props.view === 'combat' ? 'navigator-item selected' : 'navigator-item';\r\n\r\n            const encountersEnabled = this.props.library.length !== 0;\r\n            const combatEnabled = (this.props.parties.length !== 0) && (this.props.encounters.length !== 0);\r\n            if (!encountersEnabled) {\r\n                encounterStyle += ' disabled';\r\n            }\r\n            if (!combatEnabled) {\r\n                combatStyle += ' disabled';\r\n            }\r\n\r\n            return (\r\n                <div className={this.props.blur ? 'navbar blur' : 'navbar'}>\r\n                    <div className={dmStyle} onClick={() => this.props.setView('dm')}>dm screen</div>\r\n                    <div className={partiesStyle} onClick={() => this.props.setView('parties')}>player characters</div>\r\n                    <div className={libraryStyle} onClick={() => this.props.setView('library')}>monster library</div>\r\n                    <div className={encounterStyle} onClick={() => encountersEnabled ? this.props.setView('encounter') : null}>encounter builder</div>\r\n                    <div className={mapStyle} onClick={() => this.props.setView('maps')}>map folios</div>\r\n                    <div className={combatStyle} onClick={() => combatEnabled ? this.props.setView('combat') : null}>combat manager</div>\r\n                </div>\r\n            );\r\n        } catch (e) {\r\n            console.error(e);\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport cog from '../../resources/images/settings.svg';\r\n\r\ninterface Props {\r\n    actions: JSX.Element | null;\r\n    blur: boolean;\r\n    openHome: () => void;\r\n    openAbout: () => void;\r\n}\r\n\r\nexport default class Titlebar extends React.Component<Props> {\r\n    public render() {\r\n        try {\r\n            return (\r\n                <div className={this.props.blur ? 'titlebar blur' : 'titlebar'}>\r\n                    <div className='app-name' onClick={() => this.props.openHome()}>dojo</div>\r\n                    {this.props.actions}\r\n                    <img className='settings-icon' src={cog} title='about' alt='about' onClick={() => this.props.openAbout()} />\r\n                </div>\r\n            );\r\n        } catch (e) {\r\n            console.error(e);\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport Factory from '../utils/factory';\r\nimport Utils from '../utils/utils';\r\n\r\nimport { Combat, Combatant, CombatSetup, Notification } from '../models/combat';\r\nimport { Condition } from '../models/condition';\r\nimport { DMModule } from '../models/dm-module';\r\nimport { Encounter, EncounterSlot, EncounterWave } from '../models/encounter';\r\nimport { Map, MapFolio } from '../models/map-folio';\r\nimport { Monster, MonsterGroup, Trait } from '../models/monster-group';\r\nimport { Party, PC } from '../models/party';\r\n\r\nimport CombatManagerScreen from './screens/combat-manager-screen';\r\nimport DMScreen from './screens/dm-screen';\r\nimport EncounterBuilderScreen from './screens/encounter-builder-screen';\r\nimport HomeScreen from './screens/home-screen';\r\nimport MapFoliosScreen from './screens/map-folios-screen';\r\nimport MonsterLibraryScreen from './screens/monster-library-screen';\r\nimport PartiesScreen from './screens/parties-screen';\r\n\r\nimport AboutModal from './modals/about-modal';\r\nimport CombatStartModal from './modals/combat-start-modal';\r\nimport ConditionModal from './modals/condition-modal';\r\nimport DemographicsModal from './modals/demographics-modal';\r\nimport MapEditorModal from './modals/map-editor-modal';\r\nimport MonsterEditorModal from './modals/monster-editor-modal';\r\n\r\nimport Navbar from './panels/navbar';\r\nimport Titlebar from './panels/titlebar';\r\n\r\nimport Checkbox from './controls/checkbox';\r\n\r\nimport close from '../resources/images/close-black.svg';\r\n\r\n// tslint:disable-next-line:no-empty-interface\r\ninterface Props {\r\n    // No props; this is the root component\r\n}\r\n\r\ninterface State {\r\n    view: string;\r\n    options: {\r\n        showHelp: boolean;\r\n    };\r\n\r\n    parties: Party[];\r\n    library: MonsterGroup[];\r\n    encounters: Encounter[];\r\n    mapFolios: MapFolio[];\r\n    combats: Combat[];\r\n\r\n    selectedPartyID: string | null;\r\n    selectedMonsterGroupID: string | null;\r\n    selectedEncounterID: string | null;\r\n    selectedMapFolioID: string | null;\r\n    selectedCombatID: string | null;\r\n    selectedDMModuleID: string | null;\r\n\r\n    modal: any;\r\n\r\n    libraryFilter: string;\r\n}\r\n\r\nexport default class Dojo extends React.Component<Props, State> {\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            view: 'home',\r\n            options: {\r\n                showHelp: true\r\n            },\r\n            parties: [],\r\n            library: [],\r\n            encounters: [],\r\n            mapFolios: [],\r\n            combats: [],\r\n            selectedPartyID: null,\r\n            selectedMonsterGroupID: null,\r\n            selectedEncounterID: null,\r\n            selectedMapFolioID: null,\r\n            selectedCombatID: null,\r\n            selectedDMModuleID: null,\r\n            modal: null,\r\n            libraryFilter: ''\r\n        };\r\n\r\n        try {\r\n            let data: State | null = null;\r\n\r\n            try {\r\n                const json = window.localStorage.getItem('data');\r\n                if (json) {\r\n                    data = JSON.parse(json);\r\n                }\r\n            } catch (ex) {\r\n                console.error('Could not parse JSON: ', ex);\r\n                data = null;\r\n            }\r\n\r\n            if (data !== null) {\r\n                data.library.forEach(g => {\r\n                    g.monsters.forEach(m => {\r\n                        m.traits.forEach(t => {\r\n                            t.uses = 0;\r\n                        });\r\n                    });\r\n                });\r\n\r\n                data.encounters.forEach(enc => {\r\n                    if (!enc.waves) {\r\n                        enc.waves = [];\r\n                    }\r\n                });\r\n\r\n                if (!data.mapFolios) {\r\n                    data.mapFolios = [];\r\n                    data.selectedMapFolioID = null;\r\n                }\r\n\r\n                data.combats.forEach(combat => {\r\n                    if (!combat.notifications) {\r\n                        combat.notifications = [];\r\n                    }\r\n                    combat.combatants.forEach(c => {\r\n                        if (c.altitude === undefined) {\r\n                            c.altitude = 0;\r\n                        }\r\n\r\n                        if (c.type === 'monster') {\r\n                            const m = c as Combatant & Monster;\r\n                            m.traits.forEach(t => {\r\n                                if (t.uses === undefined) {\r\n                                    t.uses = 0;\r\n                                }\r\n                            });\r\n                        }\r\n                    });\r\n                });\r\n\r\n                data.view = 'home';\r\n                data.modal = null;\r\n                data.libraryFilter = '';\r\n\r\n                this.state = data;\r\n            }\r\n        } catch (ex) {\r\n            console.error(ex);\r\n        }\r\n    }\r\n\r\n    public componentDidUpdate() {\r\n        let json = null;\r\n        try {\r\n            json = JSON.stringify(this.state);\r\n        } catch (ex) {\r\n            console.error('Could not stringify data: ', ex);\r\n            json = null;\r\n        }\r\n\r\n        if (json !== null) {\r\n            window.localStorage.setItem('data', json);\r\n        }\r\n    }\r\n\r\n    /////////////////////////////////////////////////////////////////////////////\r\n    // Party screen\r\n\r\n    private addParty() {\r\n        const party = Factory.createParty();\r\n        party.name = 'new party';\r\n        const parties: Party[] = ([] as Party[]).concat(this.state.parties, [party]);\r\n        Utils.sort(parties);\r\n        this.setState({\r\n            parties: parties,\r\n            selectedPartyID: party.id\r\n        });\r\n    }\r\n\r\n    private removeParty() {\r\n        const party = this.getParty(this.state.selectedPartyID);\r\n        if (party) {\r\n            const index = this.state.parties.indexOf(party);\r\n            this.state.parties.splice(index, 1);\r\n            this.setState({\r\n                parties: this.state.parties,\r\n                selectedPartyID: null\r\n            });\r\n        }\r\n    }\r\n\r\n    private addPC() {\r\n        const party = this.getParty(this.state.selectedPartyID);\r\n        if (party) {\r\n            const pc = Factory.createPC();\r\n            pc.name = 'new pc';\r\n            party.pcs.push(pc);\r\n            this.setState({\r\n                parties: this.state.parties\r\n            });\r\n        }\r\n    }\r\n\r\n    private removePC(pc: PC) {\r\n        const party = this.getParty(this.state.selectedPartyID);\r\n        if (party) {\r\n            const index = party.pcs.indexOf(pc);\r\n            party.pcs.splice(index, 1);\r\n            this.setState({\r\n                parties: this.state.parties\r\n            });\r\n        }\r\n    }\r\n\r\n    private sortPCs() {\r\n        const party = this.getParty(this.state.selectedPartyID);\r\n        if (party) {\r\n            Utils.sort(party.pcs);\r\n            this.setState({\r\n                parties: this.state.parties\r\n            });\r\n        }\r\n    }\r\n\r\n    /////////////////////////////////////////////////////////////////////////////\r\n    // Library screen\r\n\r\n    private addMonsterGroup() {\r\n        const group = Factory.createMonsterGroup();\r\n        group.name = 'new group';\r\n        const library = ([] as MonsterGroup[]).concat(this.state.library, [group]);\r\n        Utils.sort(library);\r\n        this.setState({\r\n            library: library,\r\n            selectedMonsterGroupID: group.id\r\n        });\r\n    }\r\n\r\n    private removeMonsterGroup() {\r\n        const group = this.getMonsterGroup(this.state.selectedMonsterGroupID);\r\n        if (group) {\r\n            const index = this.state.library.indexOf(group);\r\n            this.state.library.splice(index, 1);\r\n            this.setState({\r\n                library: this.state.library,\r\n                selectedMonsterGroupID: null\r\n            });\r\n        }\r\n    }\r\n\r\n    private addMonster() {\r\n        const monster = Factory.createMonster();\r\n        monster.name = 'new monster';\r\n        const group = this.getMonsterGroup(this.state.selectedMonsterGroupID);\r\n        if (group) {\r\n            group.monsters.push(monster);\r\n            this.setState({\r\n                library: this.state.library\r\n            });\r\n        }\r\n    }\r\n\r\n    private removeMonster(monster: Monster) {\r\n        const group = this.getMonsterGroup(this.state.selectedMonsterGroupID);\r\n        if (group) {\r\n            const index = group.monsters.indexOf(monster);\r\n            group.monsters.splice(index, 1);\r\n            this.setState({\r\n                library: this.state.library\r\n            });\r\n        }\r\n    }\r\n\r\n    private sortMonsters() {\r\n        const group = this.getMonsterGroup(this.state.selectedMonsterGroupID);\r\n        if (group) {\r\n            Utils.sort(group.monsters);\r\n            this.setState({\r\n                library: this.state.library\r\n            });\r\n        }\r\n    }\r\n\r\n    private moveToGroup(monster: Monster, groupID: string) {\r\n        const sourceGroup = this.findMonster(monster);\r\n        if (sourceGroup) {\r\n            const index = sourceGroup.monsters.indexOf(monster);\r\n\r\n            sourceGroup.monsters.splice(index, 1);\r\n            const group = this.getMonsterGroup(groupID);\r\n            if (group) {\r\n                group.monsters.push(monster);\r\n                Utils.sort(group.monsters);\r\n\r\n                this.setState({\r\n                    library: this.state.library\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    private editMonster(monster: Monster) {\r\n        const copy = JSON.parse(JSON.stringify(monster));\r\n        this.setState({\r\n            modal: {\r\n                type: 'monster',\r\n                monster: copy,\r\n                showMonsters: false\r\n            }\r\n        });\r\n    }\r\n\r\n    private saveMonster() {\r\n        const group = this.getMonsterGroup(this.state.selectedMonsterGroupID);\r\n        if (group) {\r\n            const original = group.monsters.find(m => m.id === this.state.modal.monster.id);\r\n            if (original) {\r\n                const index = group.monsters.indexOf(original);\r\n                group.monsters[index] = this.state.modal.monster;\r\n                this.setState({\r\n                    library: this.state.library,\r\n                    modal: null\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    private toggleShowSimilarMonsters() {\r\n        // eslint-disable-next-line\r\n        this.state.modal.showMonsters = !this.state.modal.showMonsters;\r\n        this.setState({\r\n            modal: this.state.modal\r\n        });\r\n    }\r\n\r\n    private openDemographics() {\r\n        this.setState({\r\n            modal: {\r\n                type: 'demographics'\r\n            }\r\n        });\r\n    }\r\n\r\n    private cloneMonster(monster: Monster, name: string) {\r\n        const group = this.findMonster(monster);\r\n        if (group) {\r\n            const clone = {\r\n                id: Utils.guid(),\r\n                type: 'monster',\r\n                name: name || monster.name + ' copy',\r\n                size: monster.size,\r\n                category: monster.category,\r\n                tag: monster.tag,\r\n                alignment: monster.alignment,\r\n                challenge: monster.challenge,\r\n                abilityScores: {\r\n                    str: monster.abilityScores.str,\r\n                    dex: monster.abilityScores.dex,\r\n                    con: monster.abilityScores.con,\r\n                    int: monster.abilityScores.int,\r\n                    wis: monster.abilityScores.wis,\r\n                    cha: monster.abilityScores.cha\r\n                },\r\n                ac: monster.ac,\r\n                hpMax: monster.hpMax,\r\n                hpTemp: monster.hpTemp,\r\n                hitDice: monster.hitDice,\r\n                damage: {\r\n                    resist: monster.damage.resist,\r\n                    vulnerable: monster.damage.vulnerable,\r\n                    immune: monster.damage.immune\r\n                },\r\n                savingThrows: monster.savingThrows,\r\n                speed: monster.speed,\r\n                skills: monster.skills,\r\n                senses: monster.senses,\r\n                languages: monster.languages,\r\n                equipment: monster.equipment,\r\n                traits: monster.traits.map(trait => {\r\n                    return {\r\n                        id: Utils.guid(),\r\n                        name: trait.name,\r\n                        usage: trait.usage,\r\n                        type: trait.type,\r\n                        text: trait.text,\r\n                        uses: 0\r\n                    };\r\n                }),\r\n                conditionImmunities: monster.conditionImmunities\r\n            };\r\n\r\n            group.monsters.push(clone);\r\n            Utils.sort(group.monsters);\r\n\r\n            this.setState({\r\n                library: this.state.library\r\n            });\r\n        }\r\n    }\r\n\r\n    private addOpenGameContent() {\r\n        fetch('./data/monsters.json')\r\n            .then(response => response.json())\r\n            .then(json => {\r\n                json.forEach((data: any) => {\r\n                    try {\r\n                        if (data.name) {\r\n                            const monster = Factory.createMonster();\r\n\r\n                            monster.type = 'monster';\r\n                            monster.name = data.name;\r\n                            monster.size = data.size.toLowerCase();\r\n                            monster.category = data.type;\r\n                            monster.tag = data.subtype;\r\n                            monster.alignment = data.alignment;\r\n                            monster.challenge = Utils.parseChallenge(data.challenge_rating);\r\n                            monster.ac = data.armor_class;\r\n                            monster.hpMax = data.hit_points;\r\n                            monster.speed = data.speed;\r\n                            monster.senses = data.senses;\r\n                            monster.languages = data.languages;\r\n\r\n                            const index = data.hit_dice.indexOf('d');\r\n                            monster.hitDice = parseInt(data.hit_dice.substring(0, index), 10);\r\n\r\n                            monster.abilityScores.str = data.strength;\r\n                            monster.abilityScores.dex = data.dexterity;\r\n                            monster.abilityScores.con = data.constitution;\r\n                            monster.abilityScores.int = data.intelligence;\r\n                            monster.abilityScores.wis = data.wisdom;\r\n                            monster.abilityScores.cha = data.charisma;\r\n\r\n                            monster.damage.resist = data.damage_resistances;\r\n                            monster.damage.vulnerable = data.damage_vulnerabilities;\r\n                            monster.damage.immune = data.damage_immunities;\r\n                            monster.conditionImmunities = data.condition_immunities;\r\n\r\n                            const saves = [\r\n                                {\r\n                                    field: 'strength_save',\r\n                                    text: 'Strength'\r\n                                },\r\n                                {\r\n                                    field: 'dexterity_save',\r\n                                    text: 'Dexterity'\r\n                                },\r\n                                {\r\n                                    field: 'constitution_save',\r\n                                    text: 'Constitution'\r\n                                },\r\n                                {\r\n                                    field: 'intelligence_save',\r\n                                    text: 'Intelligence'\r\n                                },\r\n                                {\r\n                                    field: 'wisdom_save',\r\n                                    text: 'Wisdom'\r\n                                },\r\n                                {\r\n                                    field: 'charisma_save',\r\n                                    text: 'Charisma'\r\n                                }\r\n                            ];\r\n                            saves.forEach(save => {\r\n                                if (data[save.field]) {\r\n                                    const str = save.text + ' ' + data[save.field];\r\n                                    monster.savingThrows += monster.savingThrows === '' ? str : ', ' + str;\r\n                                }\r\n                            });\r\n\r\n                            const skills = [\r\n                                {\r\n                                    field: 'acrobatics',\r\n                                    text: 'Acrobatics'\r\n                                },\r\n                                {\r\n                                    field: 'animal_handling',\r\n                                    text: 'Animal handling'\r\n                                },\r\n                                {\r\n                                    field: 'arcana',\r\n                                    text: 'Arcana'\r\n                                },\r\n                                {\r\n                                    field: 'athletics',\r\n                                    text: 'Athletics'\r\n                                },\r\n                                {\r\n                                    field: 'deception',\r\n                                    text: 'Deception'\r\n                                },\r\n                                {\r\n                                    field: 'history',\r\n                                    text: 'History'\r\n                                },\r\n                                {\r\n                                    field: 'insight',\r\n                                    text: 'Insight'\r\n                                },\r\n                                {\r\n                                    field: 'intimidation',\r\n                                    text: 'Intimidation'\r\n                                },\r\n                                {\r\n                                    field: 'investigation',\r\n                                    text: 'Investigation'\r\n                                },\r\n                                {\r\n                                    field: 'medicine',\r\n                                    text: 'Medicine'\r\n                                },\r\n                                {\r\n                                    field: 'nature',\r\n                                    text: 'Nature'\r\n                                },\r\n                                {\r\n                                    field: 'perception',\r\n                                    text: 'Perception'\r\n                                },\r\n                                {\r\n                                    field: 'performance',\r\n                                    text: 'Performance'\r\n                                },\r\n                                {\r\n                                    field: 'persuasion',\r\n                                    text: 'Persuasion'\r\n                                },\r\n                                {\r\n                                    field: 'religion',\r\n                                    text: 'Religion'\r\n                                },\r\n                                {\r\n                                    field: 'sleight_of_hand',\r\n                                    text: 'Sleight of hand'\r\n                                },\r\n                                {\r\n                                    field: 'stealth',\r\n                                    text: 'Stealth'\r\n                                },\r\n                                {\r\n                                    field: 'survival',\r\n                                    text: 'Survival'\r\n                                }\r\n                            ];\r\n                            skills.forEach(skill => {\r\n                                if (data[skill.field]) {\r\n                                    const str = skill.text + ' ' + data[skill.field];\r\n                                    monster.skills += monster.skills === '' ? str : ', ' + str;\r\n                                }\r\n                            });\r\n\r\n                            if (data.special_abilities) {\r\n                                data.special_abilities.forEach((rawTrait: any) => {\r\n                                    const trait = this.buildTrait(rawTrait, 'trait');\r\n                                    monster.traits.push(trait);\r\n                                });\r\n                            }\r\n                            if (data.actions) {\r\n                                data.actions.forEach((rawTrait: any) => {\r\n                                    const trait = this.buildTrait(rawTrait, 'action');\r\n                                    monster.traits.push(trait);\r\n                                });\r\n                            }\r\n                            if (data.legendary_actions) {\r\n                                data.legendary_actions.forEach((rawTrait: any) => {\r\n                                    const trait = this.buildTrait(rawTrait, 'legendary');\r\n                                    monster.traits.push(trait);\r\n                                });\r\n                            }\r\n\r\n                            let groupName = monster.tag;\r\n                            if (groupName === '') {\r\n                                groupName = monster.category;\r\n                            }\r\n                            if (groupName.indexOf('swarm') === 0) {\r\n                                groupName = 'swarm';\r\n                            }\r\n                            if (groupName === 'any race') {\r\n                                groupName = 'npc';\r\n                            }\r\n\r\n                            let group = this.getMonsterGroupByName(groupName);\r\n                            if (!group) {\r\n                                group = {\r\n                                    id: Utils.guid(),\r\n                                    name: groupName,\r\n                                    monsters: []\r\n                                };\r\n                                this.state.library.push(group);\r\n                            }\r\n                            group.monsters.push(monster);\r\n                        }\r\n                    } catch (e) {\r\n                        console.error(e);\r\n                    }\r\n                });\r\n\r\n                Utils.sort(this.state.library);\r\n\r\n                this.setState({\r\n                    view: 'library',\r\n                    library: this.state.library\r\n                });\r\n            });\r\n    }\r\n\r\n    private buildTrait(rawTrait: any, type: 'trait' | 'action' | 'legendary' | 'lair' | 'regional'): Trait {\r\n        let name = '';\r\n        let usage = '';\r\n\r\n        const openBracket = rawTrait.name.indexOf('(');\r\n        if (openBracket === -1) {\r\n            name = rawTrait.name;\r\n        } else {\r\n            const closeBracket = rawTrait.name.indexOf(')');\r\n            name = rawTrait.name.substring(0, openBracket - 1);\r\n            usage = rawTrait.name.substring(openBracket + 1, closeBracket).toLowerCase();\r\n        }\r\n\r\n        const text = rawTrait.desc.replace(//g, '*');\r\n\r\n        return {\r\n            id: Utils.guid(),\r\n            type: type,\r\n            name: name,\r\n            usage: usage,\r\n            text: text,\r\n            uses: 0\r\n        };\r\n    }\r\n\r\n    /////////////////////////////////////////////////////////////////////////////\r\n    // Encounter screen\r\n\r\n    private addEncounter() {\r\n        const encounter = Factory.createEncounter();\r\n        encounter.name = 'new encounter';\r\n        const encounters = ([] as Encounter[]).concat(this.state.encounters, [encounter]);\r\n        Utils.sort(encounters);\r\n\r\n        this.setState({\r\n            encounters: encounters,\r\n            selectedEncounterID: encounter.id\r\n        });\r\n    }\r\n\r\n    private removeEncounter() {\r\n        const encounter = this.getEncounter(this.state.selectedEncounterID);\r\n        if (encounter) {\r\n            const index = this.state.encounters.indexOf(encounter);\r\n            this.state.encounters.splice(index, 1);\r\n\r\n            this.setState({\r\n                encounters: this.state.encounters,\r\n                selectedEncounterID: null\r\n            });\r\n        }\r\n    }\r\n\r\n    private addEncounterSlot(monster: Monster, waveID: string | null) {\r\n        const group = this.findMonster(monster);\r\n        if (group) {\r\n            const slot = Factory.createEncounterSlot();\r\n            slot.monsterGroupName = group.name;\r\n            slot.monsterName = monster.name;\r\n            const encounter = this.getEncounter(this.state.selectedEncounterID);\r\n            if (encounter) {\r\n                if (waveID !== null) {\r\n                    const wave = encounter.waves.find(w => w.id === waveID);\r\n                    if (wave) {\r\n                        wave.slots.push(slot);\r\n                        this.sortEncounterSlots(wave);\r\n                    }\r\n                } else {\r\n                    encounter.slots.push(slot);\r\n                    this.sortEncounterSlots(encounter);\r\n                }\r\n\r\n                this.setState({\r\n                    encounters: this.state.encounters\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    private removeEncounterSlot(slot: EncounterSlot, waveID: string | null) {\r\n        const encounter = this.getEncounter(this.state.selectedEncounterID);\r\n        if (encounter) {\r\n            if (waveID) {\r\n                const wave = encounter.waves.find(w => w.id === waveID);\r\n                if (wave) {\r\n                    const index = wave.slots.indexOf(slot);\r\n                    wave.slots.splice(index, 1);\r\n                }\r\n            } else {\r\n                const n = encounter.slots.indexOf(slot);\r\n                encounter.slots.splice(n, 1);\r\n            }\r\n\r\n            this.setState({\r\n                encounters: this.state.encounters\r\n            });\r\n        }\r\n    }\r\n\r\n    private sortEncounterSlots(slotContainer: { slots: EncounterSlot[] }) {\r\n        slotContainer.slots.sort((a, b) => {\r\n            const aName = a.monsterName.toLowerCase();\r\n            const bName = b.monsterName.toLowerCase();\r\n            if (aName < bName) { return -1; }\r\n            if (aName > bName) { return 1; }\r\n            return 0;\r\n        });\r\n    }\r\n\r\n    private addWaveToEncounter() {\r\n        const encounter = this.getEncounter(this.state.selectedEncounterID);\r\n        if (encounter) {\r\n            const wave = Factory.createEncounterWave();\r\n            wave.name = 'wave ' + (encounter.waves.length + 2);\r\n            encounter.waves.push(wave);\r\n\r\n            this.setState({\r\n                encounters: this.state.encounters\r\n            });\r\n        }\r\n    }\r\n\r\n    private removeWave(wave: EncounterWave) {\r\n        const encounter = this.getEncounter(this.state.selectedEncounterID);\r\n        if (encounter) {\r\n            const index = encounter.waves.indexOf(wave);\r\n            encounter.waves.splice(index, 1);\r\n\r\n            this.setState({\r\n                encounters: this.state.encounters\r\n            });\r\n        }\r\n    }\r\n\r\n    /////////////////////////////////////////////////////////////////////////////\r\n    // Map screen\r\n\r\n    private addMapFolio() {\r\n        const folio = Factory.createMapFolio();\r\n        folio.name = 'new folio';\r\n        const folios = ([] as MapFolio[]).concat(this.state.mapFolios, [folio]);\r\n        Utils.sort(folios);\r\n\r\n        this.setState({\r\n            mapFolios: folios,\r\n            selectedMapFolioID: folio.id\r\n        });\r\n    }\r\n\r\n    private removeMapFolio() {\r\n        const folio = this.getMapFolio(this.state.selectedMapFolioID);\r\n        if (folio) {\r\n            const index = this.state.mapFolios.indexOf(folio);\r\n            this.state.mapFolios.splice(index, 1);\r\n\r\n            this.setState({\r\n                mapFolios: this.state.mapFolios,\r\n                selectedMapFolioID: null\r\n            });\r\n        }\r\n    }\r\n\r\n    private addMap() {\r\n        const folio = this.getMapFolio(this.state.selectedMapFolioID);\r\n        if (folio) {\r\n            const map = Factory.createMap();\r\n            map.name = 'new map';\r\n            folio.maps.push(map);\r\n\r\n            this.setState({\r\n                mapFolios: this.state.mapFolios\r\n            });\r\n        }\r\n    }\r\n\r\n    private editMap(map: Map) {\r\n        const copy = JSON.parse(JSON.stringify(map));\r\n        this.setState({\r\n            modal: {\r\n                type: 'map',\r\n                map: copy\r\n            }\r\n        });\r\n    }\r\n\r\n    private saveMap() {\r\n        const folio = this.getMapFolio(this.state.selectedMapFolioID);\r\n        if (folio) {\r\n            const original = folio.maps.find(m => m.id === this.state.modal.map.id);\r\n            if (original) {\r\n                const index = folio.maps.indexOf(original);\r\n                folio.maps[index] = this.state.modal.map;\r\n                this.setState({\r\n                    mapFolios: this.state.mapFolios,\r\n                    modal: null\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    private removeMap(map: Map) {\r\n        const folio = this.getMapFolio(this.state.selectedMapFolioID);\r\n        if (folio) {\r\n            const index = folio.maps.indexOf(map);\r\n            folio.maps.splice(index, 1);\r\n            this.setState({\r\n                mapFolios: this.state.mapFolios\r\n            });\r\n        }\r\n    }\r\n\r\n    /////////////////////////////////////////////////////////////////////////////\r\n    // Combat screen\r\n\r\n    private createCombat() {\r\n        const party = this.state.parties.length === 1 ? this.state.parties[0] : null;\r\n        const encounter = this.state.encounters.length === 1 ? this.state.encounters[0] : null;\r\n\r\n        const setup = Factory.createCombatSetup();\r\n        setup.partyID = party ? party.id : null;\r\n        setup.encounterID = encounter ? encounter.id : null;\r\n        if (encounter) {\r\n            setup.monsterNames = Utils.getMonsterNames(encounter);\r\n        }\r\n\r\n        this.setState({\r\n            modal: {\r\n                type: 'combat-start',\r\n                combatSetup: setup\r\n            }\r\n        });\r\n    }\r\n\r\n    private startCombat() {\r\n        const combatSetup: CombatSetup = this.state.modal.combatSetup;\r\n        const party = this.getParty(combatSetup.partyID);\r\n        const encounter = this.getEncounter(combatSetup.encounterID);\r\n        if (party && encounter) {\r\n            const partyName = party.name || 'unnamed party';\r\n            const encounterName = encounter.name || 'unnamed encounter';\r\n\r\n            const combat = Factory.createCombat();\r\n            combat.name = partyName + ' vs ' + encounterName;\r\n            combat.encounterID = encounter.id;\r\n\r\n            // Add a copy of each PC to the encounter\r\n            party.pcs.filter(pc => pc.active).forEach(pc => {\r\n                const combatant = JSON.parse(JSON.stringify(pc));\r\n\r\n                combatant.current = false;\r\n                combatant.pending = true;\r\n                combatant.active = false;\r\n                combatant.defeated = false;\r\n\r\n                combatant.displayName = pc.name;\r\n                combatant.initiative = 10;\r\n                combatant.hp = null;\r\n                combatant.conditions = [];\r\n                combatant.altitude = 0;\r\n\r\n                combat.combatants.push(combatant);\r\n            });\r\n\r\n            encounter.slots.forEach(slot => {\r\n                const monster = this.getMonster(slot.monsterName, slot.monsterGroupName);\r\n                if (monster) {\r\n                    const init = parseInt(Utils.modifier(monster.abilityScores.dex), 10);\r\n                    const groupRoll = Utils.dieRoll();\r\n\r\n                    for (let n = 0; n !== slot.count; ++n) {\r\n                        const singleRoll = Utils.dieRoll();\r\n\r\n                        const combatant = JSON.parse(JSON.stringify(monster));\r\n                        combatant.id = Utils.guid();\r\n\r\n                        combatant.displayName = null;\r\n                        if (combatSetup.monsterNames) {\r\n                            const slotNames = combatSetup.monsterNames.find(names => names.id === slot.id);\r\n                            if (slotNames) {\r\n                                combatant.displayName = slotNames.names[n];\r\n                            }\r\n                        }\r\n\r\n                        switch (combatSetup.encounterInitMode) {\r\n                            case 'manual':\r\n                                combatant.initiative = 10;\r\n                                break;\r\n                            case 'group':\r\n                                combatant.initiative = init + groupRoll;\r\n                                break;\r\n                            case 'individual':\r\n                                combatant.initiative = init + singleRoll;\r\n                                break;\r\n                            default:\r\n                                // Do nothing\r\n                                break;\r\n                        }\r\n\r\n                        combatant.current = false;\r\n                        combatant.pending = (combatSetup.encounterInitMode === 'manual');\r\n                        combatant.active = (combatSetup.encounterInitMode !== 'manual');\r\n                        combatant.defeated = false;\r\n\r\n                        combatant.hp = combatant.hpMax;\r\n                        combatant.conditions = [];\r\n                        combatant.altitude = 0;\r\n\r\n                        combat.combatants.push(combatant);\r\n                    }\r\n                } else {\r\n                    combat.issues.push('unknown monster: ' + slot.monsterName + ' in group ' + slot.monsterGroupName);\r\n                }\r\n            });\r\n\r\n            combat.combatants.forEach(c => c.altitude = 0);\r\n\r\n            this.sortCombatants(combat);\r\n\r\n            if (combatSetup.folioID && combatSetup.mapID) {\r\n                const folio = this.getMapFolio(combatSetup.folioID);\r\n                if (folio) {\r\n                    const map = folio.maps.find(m => m.id === combatSetup.mapID);\r\n                    if (map) {\r\n                        combat.map = JSON.parse(JSON.stringify(map));\r\n                    }\r\n                }\r\n            }\r\n\r\n            this.setState({\r\n                combats: ([] as Combat[]).concat(this.state.combats, [combat]),\r\n                selectedCombatID: combat.id,\r\n                modal: null\r\n            });\r\n        }\r\n    }\r\n\r\n    private openWaveModal() {\r\n        const combat = this.getCombat(this.state.selectedCombatID);\r\n        if (combat) {\r\n            const encounter = this.getEncounter(combat.encounterID);\r\n            if (encounter) {\r\n                const setup = Factory.createCombatSetup();\r\n                setup.encounterID = combat.encounterID;\r\n                setup.monsterNames = Utils.getMonsterNames(encounter);\r\n\r\n                this.setState({\r\n                    modal: {\r\n                        type: 'combat-wave',\r\n                        combatSetup: setup\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    private pauseCombat() {\r\n        const combat = this.getCombat(this.state.selectedCombatID);\r\n        if (combat) {\r\n            combat.timestamp = new Date().toLocaleString();\r\n            this.setState({\r\n                combats: this.state.combats,\r\n                selectedCombatID: null\r\n            });\r\n        }\r\n    }\r\n\r\n    private resumeCombat(combat: Combat) {\r\n        this.setState({\r\n            selectedCombatID: combat.id\r\n        });\r\n    }\r\n\r\n    private endCombat() {\r\n        const combat = this.getCombat(this.state.selectedCombatID);\r\n        if (combat) {\r\n            const index = this.state.combats.indexOf(combat);\r\n            this.state.combats.splice(index, 1);\r\n            this.setState({\r\n                combats: this.state.combats,\r\n                selectedCombatID: null\r\n            });\r\n        }\r\n    }\r\n\r\n    private makeCurrent(combatant: (Combatant & PC) | (Combatant & Monster) | null, newRound: boolean) {\r\n        const combat = this.getCombat(this.state.selectedCombatID);\r\n        if (combat) {\r\n            // Handle start-of-turn conditions\r\n            combat.combatants.filter(actor => actor.conditions).forEach(actor => {\r\n                actor.conditions.forEach(c => {\r\n                    if (c.duration) {\r\n                        switch (c.duration.type) {\r\n                            case 'saves':\r\n                                // If it's my condition, and point is START, notify the user\r\n                                if (combat && combatant && (actor.id === combatant.id) && (c.duration.point === 'start')) {\r\n                                    combat.notifications.push({\r\n                                        id: Utils.guid(),\r\n                                        type: 'condition-save',\r\n                                        data: c,\r\n                                        combatant: combatant as Combatant & Monster\r\n                                    });\r\n                                }\r\n                                break;\r\n                            case 'combatant':\r\n                                // If this refers to me, and point is START, remove it\r\n                                if (combat && combatant && (c.duration.combatantID === combatant.id) && (c.duration.point === 'start')) {\r\n                                    const index = actor.conditions.indexOf(c);\r\n                                    actor.conditions.splice(index, 1);\r\n                                    // Notify the user\r\n                                    combat.notifications.push({\r\n                                        id: Utils.guid(),\r\n                                        type: 'condition-end',\r\n                                        data: c,\r\n                                        combatant: combatant as Combatant & Monster\r\n                                    });\r\n                                }\r\n                                break;\r\n                            case 'rounds':\r\n                                // If it's my condition, decrement the condition\r\n                                if (combatant && (actor.id === combatant.id)) {\r\n                                    c.duration.count -= 1;\r\n                                }\r\n                                // If it's now at 0, remove it\r\n                                if (c.duration.count === 0) {\r\n                                    const n = actor.conditions.indexOf(c);\r\n                                    actor.conditions.splice(n, 1);\r\n                                    if (combat) {\r\n                                        // Notify the user\r\n                                        combat.notifications.push({\r\n                                            id: Utils.guid(),\r\n                                            type: 'condition-end',\r\n                                            data: c,\r\n                                            combatant: combatant as Combatant & Monster\r\n                                        });\r\n                                    }\r\n                                }\r\n                                break;\r\n                            default:\r\n                                // Do nothing\r\n                                break;\r\n                        }\r\n                    }\r\n                });\r\n            });\r\n\r\n            // Handle recharging traits\r\n            if (combatant && (combatant.type === 'monster')) {\r\n                (combatant as Monster).traits\r\n                    .filter(t => (t.uses > 1) && t.usage.toLowerCase().startsWith('recharge '))\r\n                    .forEach(t => {\r\n                        combat.notifications.push({\r\n                            id: Utils.guid(),\r\n                            type: 'trait-recharge',\r\n                            data: t,\r\n                            combatant: combatant as Combatant & Monster\r\n                        });\r\n                    });\r\n            }\r\n\r\n            combat.combatants.forEach(c => {\r\n                c.current = false;\r\n            });\r\n            if (combatant) {\r\n                combatant.current = true;\r\n            }\r\n\r\n            if (newRound) {\r\n                combat.round += 1;\r\n            }\r\n\r\n            this.setState({\r\n                combats: this.state.combats\r\n            });\r\n        }\r\n    }\r\n\r\n    private makeActive(combatant: (Combatant & PC) | (Combatant & Monster)) {\r\n        const combat = this.getCombat(this.state.selectedCombatID);\r\n        if (combat) {\r\n            combatant.pending = false;\r\n            combatant.active = true;\r\n            combatant.defeated = false;\r\n\r\n            this.sortCombatants(combat);\r\n\r\n            this.setState({\r\n                combats: this.state.combats\r\n            });\r\n        }\r\n    }\r\n\r\n    private makeDefeated(combatant: (Combatant & PC) | (Combatant & Monster)) {\r\n        combatant.pending = false;\r\n        combatant.active = false;\r\n        combatant.defeated = true;\r\n\r\n        if (combatant.current) {\r\n            this.endTurn(combatant);\r\n        } else {\r\n            this.setState({\r\n                combats: this.state.combats\r\n            });\r\n        }\r\n    }\r\n\r\n    private addWaveToCombat() {\r\n        const combatSetup: CombatSetup = this.state.modal.combatSetup;\r\n        const encounter = this.getEncounter(combatSetup.encounterID);\r\n        const combat = this.getCombat(this.state.selectedCombatID);\r\n        if (combatSetup && encounter && combat) {\r\n            const wave = encounter.waves.find(w => w.id === combatSetup.waveID);\r\n            if (wave) {\r\n                wave.slots.forEach(slot => {\r\n                    const monster = this.getMonster(slot.monsterName, slot.monsterGroupName);\r\n                    if (monster) {\r\n                        const init = parseInt(Utils.modifier(monster.abilityScores.dex), 10);\r\n                        const groupRoll = Utils.dieRoll();\r\n\r\n                        for (let n = 0; n !== slot.count; ++n) {\r\n                            const singleRoll = Utils.dieRoll();\r\n\r\n                            const combatant = JSON.parse(JSON.stringify(monster));\r\n                            combatant.id = Utils.guid();\r\n\r\n                            combatant.displayName = null;\r\n                            if (combatSetup.monsterNames) {\r\n                                const slotNames = combatSetup.monsterNames.find(names => names.id === slot.id);\r\n                                if (slotNames) {\r\n                                    combatant.displayName = slotNames.names[n];\r\n                                }\r\n                            }\r\n\r\n                            switch (combatSetup.encounterInitMode) {\r\n                                case 'manual':\r\n                                    combatant.initiative = 10;\r\n                                    break;\r\n                                case 'group':\r\n                                    combatant.initiative = init + groupRoll;\r\n                                    break;\r\n                                case 'individual':\r\n                                    combatant.initiative = init + singleRoll;\r\n                                    break;\r\n                                default:\r\n                                    // Do nothing\r\n                                    break;\r\n                            }\r\n\r\n                            combatant.current = false;\r\n                            combatant.pending = (this.state.modal.combatSetup.encounterInitMode === 'manual');\r\n                            combatant.active = (this.state.modal.combatSetup.encounterInitMode !== 'manual');\r\n                            combatant.defeated = false;\r\n\r\n                            combatant.hp = combatant.hpMax;\r\n                            combatant.conditions = [];\r\n\r\n                            if (combat) {\r\n                                combat.combatants.push(combatant);\r\n                            }\r\n                        }\r\n                    } else {\r\n                        if (combat) {\r\n                            const issue = 'unknown monster: ' + slot.monsterName + ' in group ' + slot.monsterGroupName;\r\n                            combat.issues.push(issue);\r\n                        }\r\n                    }\r\n                });\r\n\r\n                this.sortCombatants(combat);\r\n\r\n                this.setState({\r\n                    combats: this.state.combats,\r\n                    modal: null\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    private removeCombatant(combatant: (Combatant & PC) | (Combatant & Monster)) {\r\n        const combat = this.getCombat(this.state.selectedCombatID);\r\n        if (combat) {\r\n            const index = combat.combatants.indexOf(combatant);\r\n            combat.combatants.splice(index, 1);\r\n\r\n            this.setState({\r\n                combats: this.state.combats\r\n            });\r\n        }\r\n    }\r\n\r\n    private mapAdd(combatant: ((Combatant & PC) | (Combatant & Monster)), x: number, y: number) {\r\n        const item = Factory.createMapItem();\r\n        item.id = combatant.id;\r\n        item.type = combatant.type as 'pc' | 'monster';\r\n        item.x = x;\r\n        item.y = y;\r\n        let size = 1;\r\n        if (combatant.type === 'monster') {\r\n            size = Utils.miniSize((combatant as Monster).size);\r\n        }\r\n        item.height = size;\r\n        item.width = size;\r\n\r\n        const combat = this.getCombat(this.state.selectedCombatID);\r\n        if (combat && combat.map) {\r\n            combat.map.items.push(item);\r\n\r\n            this.setState({\r\n                combats: this.state.combats\r\n            });\r\n        }\r\n    }\r\n\r\n    private mapMove(combatant: (Combatant & PC) | (Combatant & Monster), dir: string) {\r\n        const combat = this.getCombat(this.state.selectedCombatID);\r\n        if (combat && combat.map) {\r\n            const item = combat.map.items.find(i => i.id === combatant.id);\r\n            if (item) {\r\n                switch (dir) {\r\n                    case 'N':\r\n                        item.y -= 1;\r\n                        break;\r\n                    case 'NE':\r\n                        item.x += 1;\r\n                        item.y -= 1;\r\n                        break;\r\n                    case 'E':\r\n                        item.x += 1;\r\n                        break;\r\n                    case 'SE':\r\n                        item.x += 1;\r\n                        item.y += 1;\r\n                        break;\r\n                    case 'S':\r\n                        item.y += 1;\r\n                        break;\r\n                    case 'SW':\r\n                        item.x -= 1;\r\n                        item.y += 1;\r\n                        break;\r\n                    case 'W':\r\n                        item.x -= 1;\r\n                        break;\r\n                    case 'NW':\r\n                        item.x -= 1;\r\n                        item.y -= 1;\r\n                        break;\r\n                    default:\r\n                        // Do nothing\r\n                        break;\r\n                }\r\n\r\n                this.setState({\r\n                    combats: this.state.combats\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    private mapRemove(combatant: (Combatant & PC) | (Combatant & Monster)) {\r\n        const combat = this.getCombat(this.state.selectedCombatID);\r\n        if (combat && combat.map) {\r\n            const item = combat.map.items.find(i => i.id === combatant.id);\r\n            if (item) {\r\n                const index = combat.map.items.indexOf(item);\r\n                combat.map.items.splice(index, 1);\r\n\r\n                this.setState({\r\n                    combats: this.state.combats\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    private endTurn(combatant: (Combatant & PC) | (Combatant & Monster)) {\r\n        const combat = this.getCombat(this.state.selectedCombatID);\r\n        if (combat) {\r\n            // Handle end-of-turn conditions\r\n            combat.combatants.filter(actor => actor.conditions).forEach(actor => {\r\n                actor.conditions.forEach(c => {\r\n                    if (c.duration) {\r\n                        switch (c.duration.type) {\r\n                            case 'saves':\r\n                                // If it's my condition, and point is END, notify the user\r\n                                if (combat && (actor.id === combatant.id) && (c.duration.point === 'end')) {\r\n                                    const saveNotification = Factory.createNotification();\r\n                                    saveNotification.type = 'condition-save';\r\n                                    saveNotification.data = c;\r\n                                    saveNotification.combatant = combatant as Combatant & Monster;\r\n                                    combat.notifications.push(saveNotification);\r\n                                }\r\n                                break;\r\n                            case 'combatant':\r\n                                // If this refers to me, and point is END, remove it\r\n                                if (combat && (c.duration.combatantID === combatant.id) && (c.duration.point === 'end')) {\r\n                                    const n = actor.conditions.indexOf(c);\r\n                                    actor.conditions.splice(n, 1);\r\n                                    // Notify the user\r\n                                    const endNotification = Factory.createNotification();\r\n                                    endNotification.type = 'condition-end';\r\n                                    endNotification.data = c;\r\n                                    endNotification.combatant = combatant as Combatant & Monster;\r\n                                    combat.notifications.push(endNotification);\r\n                                }\r\n                                break;\r\n                            case 'rounds':\r\n                                // We check this at the beginning of each turn, not at the end\r\n                                break;\r\n                            default:\r\n                                // Do nothing\r\n                                break;\r\n                        }\r\n                    }\r\n                });\r\n            });\r\n\r\n            const active = combat.combatants.filter(c => {\r\n                return c.current || (!c.pending && c.active && !c.defeated);\r\n            });\r\n            if (active.length === 0) {\r\n                // There's no-one left in the fight\r\n                this.makeCurrent(null, false);\r\n            } else if ((active.length === 1) && (active[0].defeated)) {\r\n                // The only person in the fight is me, and I'm defeated\r\n                this.makeCurrent(null, false);\r\n            } else {\r\n                let index = active.indexOf(combatant) + 1;\r\n                let newRound = false;\r\n                if (index >= active.length) {\r\n                    index = 0;\r\n                    newRound = true;\r\n                }\r\n                this.makeCurrent(active[index], newRound);\r\n            }\r\n        }\r\n    }\r\n\r\n    private changeHP(combatant: Combatant & Monster, hp: number, temp: number) {\r\n        combatant.hp = hp;\r\n        combatant.hpTemp = temp;\r\n\r\n        this.setState({\r\n            combats: this.state.combats\r\n        });\r\n    }\r\n\r\n    private addCondition(combatant: Combatant & Monster) {\r\n        const combat = this.getCombat(this.state.selectedCombatID);\r\n        if (combat) {\r\n            const condition = Factory.createCondition();\r\n            condition.name = 'blinded';\r\n\r\n            this.setState({\r\n                modal: {\r\n                    type: 'condition-add',\r\n                    condition: condition,\r\n                    combatant: combatant,\r\n                    combat: combat\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    private addConditionFromModal() {\r\n        this.state.modal.combatant.conditions.push(this.state.modal.condition);\r\n\r\n        this.setState({\r\n            combats: this.state.combats,\r\n            modal: null\r\n        });\r\n    }\r\n\r\n    private editCondition(combatant: Combatant & Monster, condition: Condition) {\r\n        const combat = this.getCombat(this.state.selectedCombatID);\r\n        if (combat) {\r\n            this.setState({\r\n                modal: {\r\n                    type: 'condition-edit',\r\n                    condition: condition,\r\n                    combatant: combatant,\r\n                    combat: combat\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    private editConditionFromModal() {\r\n        const conditions: Condition[] = this.state.modal.combatant.conditions;\r\n        const original = conditions.find(c => c.id === this.state.modal.condition.id);\r\n        if (original) {\r\n            const index = conditions.indexOf(original);\r\n            // eslint-disable-next-line\r\n            conditions[index] = this.state.modal.condition;\r\n\r\n            this.setState({\r\n                combats: this.state.combats,\r\n                modal: null\r\n            });\r\n        }\r\n    }\r\n\r\n    private removeCondition(combatant: Combatant & Monster, conditionID: string) {\r\n        const condition = combatant.conditions.find(c => c.id === conditionID);\r\n        if (condition) {\r\n            const index = combatant.conditions.indexOf(condition);\r\n            combatant.conditions.splice(index, 1);\r\n\r\n            this.setState({\r\n                combats: this.state.combats\r\n            });\r\n        }\r\n    }\r\n\r\n    private sortCombatants(combat: Combat) {\r\n        combat.combatants.sort((a, b) => {\r\n            // First sort by initiative, descending\r\n            if (a.initiative && b.initiative && (a.initiative < b.initiative)) { return 1; }\r\n            if (a.initiative && b.initiative && (a.initiative > b.initiative)) { return -1; }\r\n            // Then sort by name, ascending\r\n            if (a.name < b.name) { return -1; }\r\n            if (a.name > b.name) { return 1; }\r\n            return 0;\r\n        });\r\n    }\r\n\r\n    private closeNotification(notification: Notification, removeCondition: boolean) {\r\n        const combat = this.getCombat(this.state.selectedCombatID);\r\n        if (combat) {\r\n            const index = combat.notifications.indexOf(notification);\r\n            combat.notifications.splice(index, 1);\r\n\r\n            if (removeCondition && notification.combatant && notification.data) {\r\n                const conditionIndex = notification.combatant.conditions.indexOf(notification.data as Condition);\r\n                notification.combatant.conditions.splice(conditionIndex, 1);\r\n            }\r\n\r\n            this.setState({\r\n                combats: this.state.combats\r\n            });\r\n        }\r\n    }\r\n\r\n    /////////////////////////////////////////////////////////////////////////////\r\n\r\n    private setView(view: string) {\r\n        this.setState({\r\n            view: view\r\n        });\r\n    }\r\n\r\n    private openAbout() {\r\n        this.setState({\r\n            modal: {\r\n                type: 'about'\r\n            }\r\n        });\r\n    }\r\n\r\n    private closeModal() {\r\n        this.setState({\r\n            modal: null\r\n        });\r\n    }\r\n\r\n    private selectDMModule(module: DMModule | null) {\r\n        this.setState({\r\n            selectedDMModuleID: module ? module.id : null\r\n        });\r\n    }\r\n\r\n    private selectParty(party: Party | null) {\r\n        this.setState({\r\n            selectedPartyID: party ? party.id : null\r\n        });\r\n    }\r\n\r\n    private selectMonsterGroup(group: MonsterGroup | null) {\r\n        this.setState({\r\n            selectedMonsterGroupID: group ? group.id : null\r\n        });\r\n    }\r\n\r\n    private selectEncounter(encounter: Encounter | null) {\r\n        this.setState({\r\n            selectedEncounterID: encounter ? encounter.id : null\r\n        });\r\n    }\r\n\r\n    private selectMapFolio(mapFolio: MapFolio | null) {\r\n        this.setState({\r\n            selectedMapFolioID: mapFolio ? mapFolio.id : null\r\n        });\r\n    }\r\n\r\n    private getParty(id: string | null) {\r\n        return this.state.parties.find(p => p.id === id);\r\n    }\r\n\r\n    private getMonsterGroup(id: string | null) {\r\n        return this.state.library.find(g => g.id === id);\r\n    }\r\n\r\n    private getEncounter(id: string | null) {\r\n        return this.state.encounters.find(e => e.id === id);\r\n    }\r\n\r\n    private getMapFolio(id: string | null) {\r\n        return this.state.mapFolios.find(f => f.id === id);\r\n    }\r\n\r\n    private getCombat(id: string | null) {\r\n        return this.state.combats.find(c => c.id === id);\r\n    }\r\n\r\n    private getMonster(monsterName: string, groupName: string) {\r\n        const group = this.getMonsterGroupByName(groupName);\r\n        if (group) {\r\n            return group.monsters.find(monster => monster.name === monsterName);\r\n        }\r\n\r\n        return undefined;\r\n    }\r\n\r\n    private getMonsterGroupByName(groupName: string) {\r\n        return this.state.library.find(p => p.name === groupName);\r\n    }\r\n\r\n    private findMonster(monster: Monster) {\r\n        return this.state.library.find(group => group.monsters.includes(monster));\r\n    }\r\n\r\n    private resetAll() {\r\n        this.setState({\r\n            parties: [],\r\n            selectedPartyID: null,\r\n            library: [],\r\n            selectedMonsterGroupID: null,\r\n            encounters: [],\r\n            selectedEncounterID: null,\r\n            mapFolios: [],\r\n            selectedMapFolioID: null,\r\n            combats: [],\r\n            selectedCombatID: null\r\n        });\r\n    }\r\n\r\n    private changeValue(combatant: any, type: string, value: any) {\r\n        switch (type) {\r\n            case 'hp':\r\n                value = Math.min(value, combatant.hpMax);\r\n                value = Math.max(value, 0);\r\n                break;\r\n            case 'hpTemp':\r\n                value = Math.max(value, 0);\r\n                break;\r\n            case 'level':\r\n                value = Math.max(value, 1);\r\n                value = (combatant.player !== undefined) ? Math.min(value, 20) : Math.min(value, 6);\r\n                break;\r\n            case 'count':\r\n                value = Math.max(value, 1);\r\n                break;\r\n            case 'hitDice':\r\n                value = Math.max(value, 1);\r\n                break;\r\n            default:\r\n                // Do nothing\r\n                break;\r\n        }\r\n\r\n        const tokens = type.split('.');\r\n        let obj = combatant;\r\n        for (let n = 0; n !== tokens.length; ++n) {\r\n            const token = tokens[n];\r\n            if (n === tokens.length - 1) {\r\n                obj[token] = value;\r\n            } else {\r\n                obj = obj[token];\r\n            }\r\n        }\r\n\r\n        Utils.sort(this.state.parties);\r\n        Utils.sort(this.state.library);\r\n        Utils.sort(this.state.encounters);\r\n\r\n        if (type === 'initiative') {\r\n            if (!(combatant as Combatant).pending) {\r\n                const combat = this.getCombat(this.state.selectedCombatID);\r\n                this.sortCombatants(combat as Combat);\r\n            }\r\n        }\r\n\r\n        this.setState({\r\n            parties: this.state.parties,\r\n            library: this.state.library,\r\n            encounters: this.state.encounters,\r\n            combats: this.state.combats,\r\n            selectedPartyID: this.state.selectedPartyID,\r\n            selectedMonsterGroupID: this.state.selectedMonsterGroupID,\r\n            selectedEncounterID: this.state.selectedEncounterID,\r\n            selectedCombatID: this.state.selectedCombatID,\r\n            options: this.state.options,\r\n            modal: this.state.modal\r\n        });\r\n    }\r\n\r\n    private nudgeValue(combatant: any, type: string, delta: number) {\r\n        const tokens = type.split('.');\r\n        let obj = combatant;\r\n        for (let n = 0; n !== tokens.length; ++n) {\r\n            const token = tokens[n];\r\n            if (n === tokens.length - 1) {\r\n                let value = null;\r\n                value = (token === 'challenge') ? Utils.nudgeChallenge(obj.challenge, delta) : obj[token] + delta;\r\n                this.changeValue(combatant, type, value);\r\n            } else {\r\n                obj = obj[token];\r\n            }\r\n        }\r\n    }\r\n\r\n    /////////////////////////////////////////////////////////////////////////////\r\n\r\n    public render() {\r\n        try {\r\n            let content: JSX.Element | null = null;\r\n            let actions: JSX.Element | null = null;\r\n            switch (this.state.view) {\r\n                case 'home':\r\n                    content = (\r\n                        <HomeScreen\r\n                            library={this.state.library}\r\n                            addOpenGameContent={() => this.addOpenGameContent()}\r\n                        />\r\n                    );\r\n                    break;\r\n                case 'dm':\r\n                    content = (\r\n                        <DMScreen\r\n                            selectedModuleID={this.state.selectedDMModuleID}\r\n                            showHelp={this.state.options.showHelp}\r\n                            selectModule={module => this.selectDMModule(module)}\r\n                        />\r\n                    );\r\n                    break;\r\n                case 'parties':\r\n                    content = (\r\n                        <PartiesScreen\r\n                            parties={this.state.parties}\r\n                            selection={this.getParty(this.state.selectedPartyID) || null}\r\n                            showHelp={this.state.options.showHelp}\r\n                            selectParty={party => this.selectParty(party)}\r\n                            addParty={() => this.addParty()}\r\n                            removeParty={() => this.removeParty()}\r\n                            addPC={() => this.addPC()}\r\n                            removePC={pc => this.removePC(pc)}\r\n                            sortPCs={() => this.sortPCs()}\r\n                            changeValue={(combatant, type, value) => this.changeValue(combatant, type, value)}\r\n                            nudgeValue={(combatant, type, delta) => this.nudgeValue(combatant, type, delta)}\r\n                        />\r\n                    );\r\n                    break;\r\n                case 'library':\r\n                    content = (\r\n                        <MonsterLibraryScreen\r\n                            library={this.state.library}\r\n                            selection={this.getMonsterGroup(this.state.selectedMonsterGroupID) || null}\r\n                            filter={this.state.libraryFilter}\r\n                            showHelp={this.state.options.showHelp}\r\n                            selectMonsterGroup={group => this.selectMonsterGroup(group)}\r\n                            addMonsterGroup={() => this.addMonsterGroup()}\r\n                            removeMonsterGroup={() => this.removeMonsterGroup()}\r\n                            addMonster={() => this.addMonster()}\r\n                            removeMonster={monster => this.removeMonster(monster)}\r\n                            sortMonsters={() => this.sortMonsters()}\r\n                            changeValue={(combatant, type, value) => this.changeValue(combatant, type, value)}\r\n                            nudgeValue={(combatant, type, delta) => this.nudgeValue(combatant, type, delta)}\r\n                            editMonster={combatant => this.editMonster(combatant)}\r\n                            cloneMonster={(combatant, name) => this.cloneMonster(combatant, name)}\r\n                            moveToGroup={(combatant, groupID) => this.moveToGroup(combatant, groupID)}\r\n                        />\r\n                    );\r\n                    let count = 0;\r\n                    this.state.library.forEach(group => {\r\n                        count += group.monsters.length;\r\n                    });\r\n                    if (count > 0) {\r\n                        actions = (\r\n                            <div className='actions'>\r\n                                <div className='section'>\r\n                                    <input\r\n                                        type='text'\r\n                                        placeholder='filter'\r\n                                        value={this.state.libraryFilter}\r\n                                        onChange={event => this.changeValue(this.state, 'libraryFilter', event.target.value)}\r\n                                    />\r\n                                </div>\r\n                                <div className='section'>\r\n                                    <button onClick={() => this.openDemographics()}>demographics</button>\r\n                                </div>\r\n                            </div>\r\n                        );\r\n                    }\r\n                    break;\r\n                case 'encounter':\r\n                    content = (\r\n                        <EncounterBuilderScreen\r\n                            encounters={this.state.encounters}\r\n                            selection={this.getEncounter(this.state.selectedEncounterID) || null}\r\n                            parties={this.state.parties}\r\n                            library={this.state.library}\r\n                            showHelp={this.state.options.showHelp}\r\n                            selectEncounter={encounter => this.selectEncounter(encounter)}\r\n                            addEncounter={() => this.addEncounter()}\r\n                            removeEncounter={() => this.removeEncounter()}\r\n                            addWave={() => this.addWaveToEncounter()}\r\n                            removeWave={wave => this.removeWave(wave)}\r\n                            getMonster={(monsterName, groupName) => this.getMonster(monsterName, groupName) || null}\r\n                            addEncounterSlot={(monster, waveID) => this.addEncounterSlot(monster, waveID)}\r\n                            removeEncounterSlot={(slot, waveID) => this.removeEncounterSlot(slot, waveID)}\r\n                            nudgeValue={(slot, type, delta) => this.nudgeValue(slot, type, delta)}\r\n                            changeValue={(combatant, type, value) => this.changeValue(combatant, type, value)}\r\n                        />\r\n                    );\r\n                    break;\r\n                case 'maps':\r\n                    content = (\r\n                        <MapFoliosScreen\r\n                            mapFolios={this.state.mapFolios}\r\n                            selection={this.getMapFolio(this.state.selectedMapFolioID) || null}\r\n                            showHelp={this.state.options.showHelp}\r\n                            selectMapFolio={folio => this.selectMapFolio(folio)}\r\n                            addMapFolio={() => this.addMapFolio()}\r\n                            removeMapFolio={() => this.removeMapFolio()}\r\n                            addMap={() => this.addMap()}\r\n                            editMap={map => this.editMap(map)}\r\n                            removeMap={map => this.removeMap(map)}\r\n                            changeValue={(source, type, value) => this.changeValue(source, type, value)}\r\n                        />\r\n                    );\r\n                    break;\r\n                case 'combat':\r\n                    const combat = this.getCombat(this.state.selectedCombatID);\r\n                    content = (\r\n                        <CombatManagerScreen\r\n                            combats={this.state.combats}\r\n                            combat={combat || null}\r\n                            showHelp={this.state.options.showHelp}\r\n                            createCombat={() => this.createCombat()}\r\n                            resumeEncounter={pausedCombat => this.resumeCombat(pausedCombat)}\r\n                            nudgeValue={(combatant, type, delta) => this.nudgeValue(combatant, type, delta)}\r\n                            changeValue={(combatant, type, value) => this.changeValue(combatant, type, value)}\r\n                            makeCurrent={(combatant) => this.makeCurrent(combatant, false)}\r\n                            makeActive={(combatant) => this.makeActive(combatant)}\r\n                            makeDefeated={(combatant) => this.makeDefeated(combatant)}\r\n                            removeCombatant={(combatant) => this.removeCombatant(combatant)}\r\n                            addCondition={(combatant) => this.addCondition(combatant)}\r\n                            editCondition={(combatant, condition) => this.editCondition(combatant, condition)}\r\n                            removeCondition={(combatant, conditionID) => this.removeCondition(combatant, conditionID)}\r\n                            mapAdd={(combatant, x, y) => this.mapAdd(combatant, x, y)}\r\n                            mapMove={(combatant, dir) => this.mapMove(combatant, dir)}\r\n                            mapRemove={combatant => this.mapRemove(combatant)}\r\n                            endTurn={(combatant) => this.endTurn(combatant)}\r\n                            changeHP={(combatant, hp, temp) => this.changeHP(combatant, hp, temp)}\r\n                            close={(notification, removeCondition) => this.closeNotification(notification, removeCondition)}\r\n                        />\r\n                    );\r\n                    if (combat) {\r\n                        const encounter = this.getEncounter(combat.encounterID);\r\n                        if (encounter) {\r\n                            let xp = 0;\r\n                            combat.combatants.filter(c => c.type === 'monster')\r\n                                .forEach(combatant => {\r\n                                    xp += Utils.experience((combatant as Combatant & Monster).challenge);\r\n                                });\r\n\r\n                            actions = (\r\n                                <div className='actions'>\r\n                                    <div className='section'>\r\n                                        <div className='text'>round: {combat.round}</div>\r\n                                    </div>\r\n                                    <div className='section'>\r\n                                        <div className='text'>xp: {xp}</div>\r\n                                    </div>\r\n                                    <div className='section' style={{ display: encounter.waves.length === 0 ? 'none' : ''}}>\r\n                                        <button onClick={() => this.openWaveModal()}>add wave</button>\r\n                                    </div>\r\n                                    <div className='section'>\r\n                                        <button onClick={() => this.pauseCombat()}>pause encounter</button>\r\n                                    </div>\r\n                                    <div className='section'>\r\n                                        <button onClick={() => this.endCombat()}>end encounter</button>\r\n                                    </div>\r\n                                </div>\r\n                            );\r\n                        }\r\n                    }\r\n                    break;\r\n                default:\r\n                    // Do nothing\r\n                    break;\r\n            }\r\n\r\n            let modal = null;\r\n            if (this.state.modal) {\r\n                let modalTitle = null;\r\n                let modalContent = null;\r\n                let modalAllowClose = true;\r\n                let modalAllowScroll = true;\r\n                const modalButtons = {\r\n                    left: [] as JSX.Element[],\r\n                    right: [] as JSX.Element[]\r\n                };\r\n\r\n                switch (this.state.modal.type) {\r\n                    case 'about':\r\n                        modalContent = (\r\n                            <AboutModal\r\n                                options={this.state.options}\r\n                                resetAll={() => this.resetAll()}\r\n                                changeValue={(source, type, value) => this.changeValue(source, type, value)}\r\n                            />\r\n                        );\r\n                        break;\r\n                    case 'demographics':\r\n                        modalTitle = 'demographics';\r\n                        modalContent = (\r\n                            <DemographicsModal\r\n                                library={this.state.library}\r\n                            />\r\n                        );\r\n                        break;\r\n                    case 'monster':\r\n                        modalTitle = 'monster editor';\r\n                        modalContent = (\r\n                            <MonsterEditorModal\r\n                                monster={this.state.modal.monster}\r\n                                library={this.state.library}\r\n                                showMonsters={this.state.modal.showMonsters}\r\n                            />\r\n                        );\r\n                        modalAllowClose = false;\r\n                        modalAllowScroll = false;\r\n                        modalButtons.left = [\r\n                            (\r\n                                <Checkbox\r\n                                    key='similar'\r\n                                    label='similar monsters'\r\n                                    checked={this.state.modal.showMonsters}\r\n                                    changeValue={() => this.toggleShowSimilarMonsters()}\r\n                                />\r\n                            )\r\n                        ];\r\n                        modalButtons.right = [\r\n                            <button key='save' onClick={() => this.saveMonster()}>save</button>,\r\n                            <button key='cancel' onClick={() => this.closeModal()}>cancel</button>\r\n                        ];\r\n                        break;\r\n                    case 'map':\r\n                        modalTitle = 'map editor';\r\n                        modalContent = (\r\n                            <MapEditorModal\r\n                                map={this.state.modal.map}\r\n                            />\r\n                        );\r\n                        modalAllowClose = false;\r\n                        modalAllowScroll = false;\r\n                        modalButtons.right = [\r\n                            <button key='save' onClick={() => this.saveMap()}>save</button>,\r\n                            <button key='cancel' onClick={() => this.closeModal()}>cancel</button>\r\n                        ];\r\n                        break;\r\n                    case 'combat-start':\r\n                        modalTitle = 'start a new encounter';\r\n                        modalContent = (\r\n                            <CombatStartModal\r\n                                combatSetup={this.state.modal.combatSetup}\r\n                                parties={this.state.parties}\r\n                                encounters={this.state.encounters}\r\n                                mapFolios={this.state.mapFolios}\r\n                                getMonster={(monsterName, groupName) => this.getMonster(monsterName, groupName) || null}\r\n                                notify={() => this.setState({modal: this.state.modal})}\r\n                            />\r\n                        );\r\n                        modalAllowClose = false;\r\n                        modalAllowScroll = false;\r\n                        modalButtons.right = [\r\n                            (\r\n                                <button\r\n                                    key='start encounter'\r\n                                    className={this.state.modal.combatSetup.partyID && this.state.modal.combatSetup.encounterID ? '' : 'disabled'}\r\n                                    onClick={() => this.startCombat()}\r\n                                >\r\n                                    start encounter\r\n                                </button>\r\n                            ),\r\n                            <button key='cancel' onClick={() => this.closeModal()}>cancel</button>\r\n                        ];\r\n                        break;\r\n                    case 'combat-wave':\r\n                        modalTitle = 'encounter waves';\r\n                        modalContent = (\r\n                            <CombatStartModal\r\n                                combatSetup={this.state.modal.combatSetup}\r\n                                encounters={this.state.encounters}\r\n                                getMonster={(monsterName, groupName) => this.getMonster(monsterName, groupName) || null}\r\n                                notify={() => this.setState({modal: this.state.modal})}\r\n                            />\r\n                        );\r\n                        modalAllowClose = false;\r\n                        modalAllowScroll = false;\r\n                        modalButtons.right = [\r\n                            (\r\n                                <button\r\n                                    key='add wave'\r\n                                    className={this.state.modal.combatSetup.waveID !== null ? '' : 'disabled'}\r\n                                    onClick={() => this.addWaveToCombat()}\r\n                                >\r\n                                    add wave\r\n                                </button>\r\n                            ),\r\n                            <button key='cancel' onClick={() => this.closeModal()}>cancel</button>\r\n                        ];\r\n                        break;\r\n                    case 'condition-add':\r\n                        modalTitle = 'add a condition';\r\n                        modalContent = (\r\n                            <ConditionModal\r\n                                condition={this.state.modal.condition}\r\n                                combatant={this.state.modal.combatant}\r\n                                combat={this.state.modal.combat}\r\n                            />\r\n                        );\r\n                        modalAllowClose = false;\r\n                        modalAllowScroll = false;\r\n                        modalButtons.right = [\r\n                            <button key='add' onClick={() => this.addConditionFromModal()}>add</button>,\r\n                            <button key='cancel' onClick={() => this.closeModal()}>cancel</button>\r\n                        ];\r\n                        break;\r\n                    case 'condition-edit':\r\n                        modalTitle = 'edit condition';\r\n                        modalContent = (\r\n                            <ConditionModal\r\n                                condition={this.state.modal.condition}\r\n                                combatant={this.state.modal.combatant}\r\n                                combat={this.state.modal.combat}\r\n                            />\r\n                        );\r\n                        modalAllowClose = false;\r\n                        modalButtons.right = [\r\n                            <button key='save' onClick={() => this.editConditionFromModal()}>save</button>,\r\n                            <button key='cancel' onClick={() => this.closeModal()}>cancel</button>\r\n                        ];\r\n                        break;\r\n                    default:\r\n                        // Do nothing\r\n                        break;\r\n                }\r\n\r\n                modal = (\r\n                    <div className='overlay'>\r\n                        <div className='modal'>\r\n                            <div className='modal-header'>\r\n                                <div className='title'>{modalTitle}</div>\r\n                                {modalAllowClose ? <img className='image' src={close} alt='close' onClick={() => this.closeModal()} /> : null}\r\n                            </div>\r\n                            <div className={modalAllowScroll ? 'modal-content scrollable' : 'modal-content'}>\r\n                                {modalContent}\r\n                            </div>\r\n                            <div className='modal-footer'>\r\n                                <div className='left'>{modalButtons.left}</div>\r\n                                <div className='right'>{modalButtons.right}</div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                );\r\n            }\r\n\r\n            return (\r\n                <div className='dojo'>\r\n                    <Titlebar\r\n                        actions={actions}\r\n                        blur={modal !== null}\r\n                        openHome={() => this.setView('home')}\r\n                        openAbout={() => this.openAbout()}\r\n                    />\r\n                    <div className={(modal === null) ? 'page-content' : 'page-content blur'}>\r\n                        {content}\r\n                    </div>\r\n                    <Navbar\r\n                        view={this.state.view}\r\n                        parties={this.state.parties}\r\n                        library={this.state.library}\r\n                        encounters={this.state.encounters}\r\n                        blur={modal !== null}\r\n                        setView={view => this.setView(view)}\r\n                    />\r\n                    {modal}\r\n                </div>\r\n            );\r\n        } catch (e) {\r\n            console.error(e);\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\n\r\nimport './style/css/foundation.css';\r\nimport './style/scss/app.scss';\r\nimport './style/scss/controls.scss';\r\n\r\nimport Dojo from './components/dojo';\r\n\r\nReactDOM.render(<Dojo />, document.getElementById('root'));\r\n"],"sourceRoot":""}